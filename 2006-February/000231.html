<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Xoops4-svn] r239 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering: . Pyro.xofrm Pyro.xofrm/Smarty.xoobj Pyro.xofrm/Smarty.xoobj/plugins Pyro.xofrm/Theme.xoobj
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/xoops4-svn/2006-February/index.html" >
   <LINK REL="made" HREF="mailto:xoops4-svn%40lists.berlios.de?Subject=Re%3A%20%5BXoops4-svn%5D%20r239%20-%20in%20XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering%3A%20.%20Pyro.xofrm%20Pyro.xofrm/Smarty.xoobj%20Pyro.xofrm/Smarty.xoobj/plugins%20Pyro.xofrm/Theme.xoobj&In-Reply-To=%3C200602131535.k1DFZGUQ026611%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000230.html">
   <LINK REL="Next"  HREF="000232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Xoops4-svn] r239 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering: . Pyro.xofrm Pyro.xofrm/Smarty.xoobj Pyro.xofrm/Smarty.xoobj/plugins Pyro.xofrm/Theme.xoobj</H1>
    <B>skalpa at BerliOS</B> 
    <A HREF="mailto:xoops4-svn%40lists.berlios.de?Subject=Re%3A%20%5BXoops4-svn%5D%20r239%20-%20in%20XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering%3A%20.%20Pyro.xofrm%20Pyro.xofrm/Smarty.xoobj%20Pyro.xofrm/Smarty.xoobj/plugins%20Pyro.xofrm/Theme.xoobj&In-Reply-To=%3C200602131535.k1DFZGUQ026611%40sheep.berlios.de%3E"
       TITLE="[Xoops4-svn] r239 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering: . Pyro.xofrm Pyro.xofrm/Smarty.xoobj Pyro.xofrm/Smarty.xoobj/plugins Pyro.xofrm/Theme.xoobj">skalpa at berlios.de
       </A><BR>
    <I>Mon Feb 13 16:35:16 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000230.html">[Xoops4-svn] r238 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore
</A></li>
        <LI>Next message: <A HREF="000232.html">[Xoops4-svn] r240 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#231">[ date ]</a>
              <a href="thread.html#231">[ thread ]</a>
              <a href="subject.html#231">[ subject ]</a>
              <a href="author.html#231">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: skalpa
Date: 2006-02-13 16:34:59 +0100 (Mon, 13 Feb 2006)
New Revision: 239

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/compiler.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php
Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/TreeWidget.xoobj/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php
Log:
Moving the low-level rendering frameworks to a dedicated folder

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm (from rev 217, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm)

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/compiler.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/compiler.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,38 +0,0 @@
-&lt;?php
-/**
-* xoAppUrl Smarty compiler plug-in
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A>
-*
-* @copyright    The XOOPS project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
-* @license      <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
-* @author		Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
-* @package		xoops_template
-* @subpackage	xoops_template_Smarty
-* @since        2.3.0
-* @version		$Id$
-*/
-
-function smarty_compiler_xoAppUrl( $argStr, &amp;$smarty ) {
-	global $xoops;
-	
-	$argStr = trim( $argStr );
-
-	@list( $modId, $location ) = explode( '#', $argStr, 2 );
-	if ( isset( $location ) ) {
-		if ( $module = $xoops-&gt;loadModule( $modId ) ) {
-			$uri = $module-&gt;xoBundleRoot;
-			if ( isset( $location ) &amp;&amp; isset( $module-&gt;moduleLocations[$location] ) ) {
-				$uri .= $module-&gt;moduleLocations[$location]['scriptFile'];
-			}
-		}
-	} else {
-		$uri = $argStr;
-	}
-	
-	return &quot;\necho '&quot; . addslashes( $xoops-&gt;path( $uri, true ) ) . &quot;';&quot;;
-
-}
-
-?&gt;
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,67 +0,0 @@
-&lt;?php
-/**
-* xoWidget Smarty compiler plug-in
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A>
-*
-* @copyright    The XOOPS project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
-* @license      <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
-* @author		Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
-* @package		xoops_template
-* @subpackage	xoops_template_Smarty
-* @since        2.3.0
-* @version		$Id$
-*/
-
-function smarty_compiler_xoWidget( $argStr, &amp;$smarty ) {
-	global $xoops;
-	
-	$args = $smarty-&gt;_parse_attrs( trim( $argStr ) );
-	array_map( array( &amp;$smarty, '_expand_quoted_text' ), $args );
-	
-	if ( !isset( $args['bundleId'] ) ) {
-		trigger_error( &quot;Cannot insert widget: no bundleId specified&quot;, E_USER_WARNING );
-		return '';
-	}
-	$bundleId = $args['bundleId'];
-	unset( $args['bundleId'] );
-
-	$realBundleId = substr( $bundleId, 1, strlen( $bundleId ) - 2 );
-	
-	$code = &quot;\n&quot;;
-	// Get this widget stylesheet and javascript properties
-	if ( $css = XOS::classVar( $realBundleId, 'stylesheet' ) ) {
-		$css = $realBundleId . '#' . $css;
-		$attrs = array(
-			'type' =&gt; 'text/css',
-			'href' =&gt; $xoops-&gt;url( $smarty-&gt;template_engine-&gt;currentTheme-&gt;resourcePath( $css ) ),
-		);
-		$code .= '$this-&gt;currentTheme-&gt;setMeta( &quot;stylesheet&quot;, &quot;' . $css . '&quot;, ' . var_export( $attrs, true ) . &quot;);\n&quot;;
-	}
-	if ( $js = XOS::classVar( $realBundleId, 'javascript' ) ) {
-		$js = $realBundleId . '#' . $js;
-		$attrs = array(
-			'type' =&gt; 'text/javascript',
-			'src' =&gt; $xoops-&gt;url( $smarty-&gt;template_engine-&gt;currentTheme-&gt;resourcePath( $js ) ),
-		);
-		$code .= '$this-&gt;currentTheme-&gt;setMeta( &quot;script&quot;, &quot;' . $js . '&quot;, ' . var_export( $attrs, true ) . &quot;);\n&quot;;
-	}
-
-
-	$code .= '$widget = XOS::create( ' . $bundleId;
-	if ( !empty( $args ) ) {
-		$code .= &quot;, array(\n&quot;;
-		foreach ( $args as $prop =&gt; $value ) {
-			$code .= &quot;\t'$prop' =&gt; &quot; . $value . &quot;,\n&quot;;
-		}
-		$code .= ')';
-	}
-	$code .= &quot; );\n&quot;;
-	$code .= &quot;echo ( \$widget ? \$widget-&gt;render() : \&quot;Failed to instanciate $bundleId widget.\&quot; );\n&quot;;
-	
-	return $code;
-
-}
-
-?&gt;
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,111 +0,0 @@
-&lt;?php
-/**
- * xoops_template_Smarty component main file
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A>
- *
- * @copyright   The Xoops project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
- * @license     <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
- * @since       2.3.0
- * @package		xoops_template
- * @subpackage	xoops_template_Smarty
- * @version		$Id$
- * @author		Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
- */
-
-XOS::import( 'Smarty' );
-
-/**
- * XOOPS core default Smarty implementation
- * @since        2.3.0
- * @package		xoops_template
- * @subpackage	xoops_template_Smarty
- */
-class xoops_template_Smarty extends Smarty {
-	
-	var $left_delimiter =	'([';
-	var $right_delimiter =	'])';
-
-	var $template_dir		= XOOPS_THEME_PATH;
-	var $compile_dir		= 'var/Application Support/xoops_template_Smarty';
-	var $cache_dir			= 'var/Caches/xoops_template_Smarty';
-
-	var $use_sub_dirs		= false;
-	
-	
-	var $currentFile		= '';
-
-	/**
-	 * Theme to apply to this template (if any)
-	 * 
-	 * @var object
-	 */
-	var $currentTheme		= false;
-	
-
-	function xoops_template_Smarty( $options = null ) {
-		global $xoops;
-		
-		$this-&gt;compile_dir	= $xoops-&gt;path( $this-&gt;compile_dir );
-		$this-&gt;cache_dir	= $xoops-&gt;path( $this-&gt;cache_dir );
-
-		if ( $xoops-&gt;xoRunMode &amp; XO_MODE_DEV_MASK ) {
-			$this-&gt;compile_check = true;
-			$this-&gt;force_compile = true;
-			//$this-&gt;debugging = true;
-		}
-		$this-&gt;Smarty();
-
-		$path = str_replace( DIRECTORY_SEPARATOR, '/', dirname( __FILE__ ) );
-
-		array_unshift( $this-&gt;plugins_dir, &quot;$path/plugins&quot; );
-		array_unshift( $this-&gt;plugins_dir, &quot;$path/smarty/plugins&quot; );
-		
-		$this-&gt;register_prefilter( array( &amp;$this, 'filterOldTemplates' ) );
-		
-		$this-&gt;assign_by_ref( 'xoops', $xoops );
-	}
-
-	
-    function display( $resource_name = null, $cache_id = null, $compile_id = null) {
-        return $this-&gt;fetch( $resource_name, $cache_id, $compile_id, true );
-    }
-
-    function fetch( $resource_name = null, $cache_id = null, $compile_id = null, $display = false) {
-    	if ( !isset( $resource_name ) ) {
-    		$resource_name = $this-&gt;currentFile;
-    	} else {
-    		$this-&gt;currentFile = $resource_name;
-    	}
-    	return parent::fetch( $resource_name, $cache_id, $compile_id, $display );
-    }
-
-	/**
-	 * Render output from template data
-	 * 
-	 * @param   string  $data		The template to render
-	 * @param	bool	$display	If rendered text should be output or returned
-	 * @return  string  Rendered output if $display was false
-	 **/
-    function fetchFromData( $tplSource, $display = false ) {
-        if ( !function_exists('smarty_function_eval') ) {
-            require_once SMARTY_DIR . '/plugins/function.eval.php';
-        }
-        return smarty_function_eval( array('var' =&gt; $tplSource), $this );
-    }
-
-	/**
-	 * Compiler prefilter to change 2.0 style delimiters to new ones
-	 */
-    function filterOldTemplates( $data, &amp;$compiler ) {
-    	$file = ( substr( $compiler-&gt;_current_file, 0, 6 ) == 'xotpl:' ) ? $compiler-&gt;template_engine-&gt;realTemplatePath : $compiler-&gt;_current_file;
-		if ( substr( $file, -6 ) != '.xotpl' ) {
-			$data = str_replace( array( '&lt;{', '}&gt;' ), array( '([', '])' ), $data );
-		}
-    	return $data;
-    }
-
-}
-
-?&gt;
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,26 +0,0 @@
-&lt;?php
-/**
-* xoops_template_Smarty bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A>
-*
-* @copyright    The XOOPS project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
-* @license      <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
-*/
-
-return array(
-	'xoBundleDisplayName' =&gt; 'Smarty template engine (XOOPS version)',
-	'xoBundleIdentifier' =&gt; 'xoops_template_Smarty',
-	'xoClassPath' =&gt; '/smarty.php',
-	'xoServices' =&gt; array(
-		'Smarty' =&gt; array(
-			'xoClassPath' =&gt; '/smarty/Smarty.class.php',
-		),
-	),
-);
-
-?&gt;
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,420 +0,0 @@
-&lt;?php
-/**
-* xoops_pyro_Theme component class file
-*
-* @copyright	The Xoops project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
-* @license      <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_Theme
-* @author       Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
-* @since        2.3.0
-* @version		$Id$
-*/
-
-/**
-* xoops_pyro_ThemeFactory
-*
-* @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_ThemeFactory
-* @since        2.3.0
-*/
-class xoops_pyro_ThemeFactory {
-	/**
-	 * Currently enabled themes (if empty, all the themes in themes/ are allowed)
-	 * 
-	 * @var array
-	 */
-	var $allowedThemes = array();
-	/**
-	 * Default theme to instanciate if none specified
-	 * 
-	 * @var string
-	 */
-	var $defaultTheme = 'default';
-
-	/**
-	 * Instanciate the specified theme
-	 */
-	function &amp;createInstance( $options = array(), $initArgs = array() ) {
-		if ( @empty( $options['folderName'] ) ) {
-			//$options['folderName'] = $this-&gt;defaultTheme;
-			$options['folderName'] = $GLOBALS['xoopsConfig']['theme_set'];
-		} elseif ( !empty( $this-&gt;allowedThemes ) &amp;&amp; !in_array( $options['folderName'], $this-&gt;allowedThemes ) ) {
-			$options['folderName'] = $this-&gt;defaultTheme;
-		}
-		$inst =&amp; XOS::createInstanceOf( &quot;xoops_pyro_Theme&quot;, $options, $initArgs );
-		return $inst;
-	}
-
-	/**
-	 * List the available themes
-	 *
-	 * @param	boolean $allowed Whether to return the allowed themes, or all of them
-	 *  @return	array
-	 */
-	function enumerate( $allowed = true ) {
-		global $xoops;
-		$themes = array();
-		if ( $dh = opendir( $xoops2-&gt;path('/themes/') ) ) {
-			while ( $file = readdir($dh) ) {
-				if ( $file{0} != '.' &amp;&amp; $file != 'CVS' ) {
-					$themes[] = $file;
-				}
-			}
-			closedir( $dh );
-		}
-		if ( !empty($this-&gt;allowedThemes) &amp;&amp; $allowed ) {
-			return array_intersect( $themes, $this-&gt;allowedThemes );
-		}
-		return $themes;
-	}
-
-}
-
-class xoops_pyro_Theme {
-   /**
-    * The name of this theme
-    * @var string
-    */
-	var $folderName = '';
-   /**
-    * Physical path of this theme folder
-    * @var string
-    */
-	var $path = '';
-	var $url = '';
-   /**
-   * Whether or not the theme engine should include the output generated by php
-   * @var string
-   */
-	var $bufferOutput = true;
-	/**
-	* Default content-type of pages generated by this theme
-	* @var string
-	*/
-	var $contentType = 'text/html';
-	/**
-	* Canvas-level template to use
-	* @var string
-	*/
-	var $canvasTemplate = '';
-	/**
-	* Page-level template to use
-	* @var string
-	*/
-	var $pageTemplate = '';
-	/**
-	* Content-level template to use
-	* @var string
-	*/
-	var $contentTemplate = '';
-	/**
-	* Text content to display right after the contentTemplate output
-	* @var string
-	*/
-	var $content = '';
-	/**
-	* The API version supported by this theme (used to achieve BC)
-	* @var string
-	*/
-	var $themeAPI = '2.3';
-	/**
-	* Name of this theme parent (if any)
-	* @var string
-	*/
-	var $parentTheme = '';
-	/**
-	* Array containing all this theme ancestors (parent,grand-parent,etc...)
-	* @var array
-	* @access protected
-	*/
-	var $parentInfos = array();
-	/**
-	* Page construction plug-ins to use
-	* @var array
-	* @access public
-	*/
-	var $plugins = array( 'xoops_logos_PageBuilder' );
-	
-	var $renderCount = 0;
-	/**
-	 * Pointer to the theme template engine
-	 *
-	 * @var object
-	 */
-	var $template = false;
-   /**#@-*/
-
-	function xoInit( $options = array() ) {
-		global $xoops;
-
-		$this-&gt;path	= $xoops-&gt;path( '/themes/' . $this-&gt;folderName );
-
-		$this-&gt;template =&amp; XOS::create( 'xoops_template_Smarty' );
-		$this-&gt;template-&gt;currentTheme =&amp; $this;
-		$this-&gt;template-&gt;compile_id = $this-&gt;folderName;
-
-		if ( $info = @include &quot;$this-&gt;path/xo-info.php&quot; ) {
-			XOS::apply( $this, $info );
-			if ( isset( $_SESSION ) ) {
-				unset( $_SESSION[$xoops-&gt;services['http']-&gt;xoBundleIdentifier]['tmpDisallowRedirections'] );
-			}
-		} else {
-			$this-&gt;themeAPI = '2.0';
-			$this-&gt;parentTheme = ( $this-&gt;folderName == 'xoops20' ? '' : 'xoops20' );
-			$_SESSION[$xoops-&gt;services['http']-&gt;xoBundleIdentifier]['tmpDisallowRedirections'] = true;
-		}
-		if ( $this-&gt;bufferOutput ) {
-			ob_start();
-		}
-		// Instanciate and initialize all the theme plugins
-		foreach ( $this-&gt;plugins as $k =&gt; $bundleId ) {
-			$this-&gt;plugins[$k] =&amp; XOS::create( $bundleId, array( 'theme' =&gt; &amp;$this ) );
-		}
-		return true;
-	}
-
-	/**
-	 * Render the page
-	 *
-	 * The theme engine builds pages from 3 templates: canvas, page and content.
-	 * 
-	 * The canvas template is the outermost one. It is the one containing the html container
-	 * elements (html,head,body), the header, footer and the left and right columns.
-	 * 
-	 * Standard themes should be delivered with the following canvas templates:
-	 * - canvas-default.xotpl: The &quot;normal&quot; template, used by most pages on a site
-	 * - canvas-dialog.xotpl: A lightweight canvas, without left and right columns, used by popups
-	 * - canvas-email.xotpl: The canvas used by e-mails sent by the site
-	 * 
-	 * The page template is the container for center blocks and the content. Themes don't have to
-	 * include several page templates, but applications may have their own page template that is
-	 * used instead of the default one (i.e: the XOOPS Management module).
-	 * 
-	 * A module can call this method directly and specify what templates the theme engine must use.
-	 * If render() hasn't been called before, the theme defaults will be used for the canvas and
-	 * page template (and xoopsOption['template_main'] for the content).
-	 * 
-	 * @param string $canvasTpl		The canvas template, if different from the theme default
-	 * @param string $pageTpl		The page template, if different from the theme default
-	 * @param string $contentTpl	The content template
-	 * @param array	 $vars			Template variables to send to the template engine
-	 */
-	function render( $canvasTpl = null, $pageTpl = null, $contentTpl = null, $vars = array() ) {
-		global $xoops;
-
-		if ( !$this-&gt;renderCount &amp;&amp; $this-&gt;bufferOutput ) {
-			$this-&gt;content .= ob_get_contents();
-			ob_end_clean();
-		}
-		if ( $this-&gt;themeAPI != '2.3' ) {
-			include $xoops-&gt;path( $this-&gt;xoBundleRoot . '/render-' . $this-&gt;themeAPI . '.php' );
-		}
-		if ( !empty($canvasTpl) ) {
-			$this-&gt;canvasTemplate = $canvasTpl;
-		}
-		if ( !empty($pageTpl) ) {
-			$this-&gt;pageTemplate = $pageTpl;
-		}
-		if ( !empty($contentTpl) ) {
-			$this-&gt;contentTemplate = $contentTpl;
-		}
-		$vars['xoTheme']	=&amp; $this;
-		/* this will be changed */
-		$vars['xoops_dirname'] = @!empty( $GLOBALS['xoopsModule'] ) ? $GLOBALS['xoopsModule']-&gt;getVar('dirname') : 'system';
-		$this-&gt;template-&gt;assign( $vars );
-		$this-&gt;renderZone( 'canvas' );
-		$this-&gt;renderCount++;
-	}
-	
-	/**
-	 * Render the specified page part
-	 * 
-	 * @param string $zone
-	 */
-	function renderZone( $zone ) {
-		switch ( $zone ) {
-		case 'canvas':
-			$this-&gt;renderCanvas();
-			break;
-		case 'page':
-			$this-&gt;renderPage();
-			echo $this-&gt;pageContent;
-			break;
-		case 'content':
-			$this-&gt;renderContent();
-		}
-	}
-	
-	function renderCanvas() {
-		$this-&gt;renderPage();
-		$this-&gt;template-&gt;display( $this-&gt;getZoneTemplate( 'canvas' ) );
-	}
-
-	function renderPage() {
-		ob_start();
-		if ( $tpl = $this-&gt;getZoneTemplate( 'page' ) ) {
-			$this-&gt;template-&gt;display( $tpl );
-		} else {
-			$this-&gt;renderContent();
-		}
-		$this-&gt;pageContent = ob_get_contents();
-		ob_end_clean();
-	}
-
-	function renderContent() {
-		if ( $tpl = $this-&gt;getZoneTemplate( 'content' ) ) {
-			$this-&gt;template-&gt;display( $tpl );
-		}
-		if ( !empty($this-&gt;content) ) {
-			echo $this-&gt;content;
-		}
-	}
-	
-	function getZoneTemplate( $zone ) {
-		global $xoops;
-		$zones = array( 'canvas' =&gt; 0, 'page' =&gt; 1, 'content' =&gt; 2 );
-		$tpl = '';
-		if ( isset( $zones[$zone] ) ) {
-			$tpl = $zone . 'Template';
-			$tpl = $this-&gt;$tpl;
-			if ( !empty( $tpl ) ) {
-				if ( substr( $tpl, 0, 1 ) == '.' ) {
-					$tpl = $xoops-&gt;path( $this-&gt;resourcePath( substr( $tpl, 1 ) ) );
-				} elseif ( !strpos( $tpl, ':' ) ) {
-					$tpl = 'xotpl:' . $tpl;
-				}
-			}
-		}
-		return $tpl;
-	}
-	
-	
-
-	function renderAttributes( $coll ) {
-		$str = '';
-		foreach ( $coll as $name =&gt; $val ) {
-			if ( $name != '_' ) {
-				$str .= ' ' . $name . '=&quot;' . htmlspecialchars( $val, ENT_QUOTES ) . '&quot;';
-			}
-		}
-		return $str;
-	}
-	
-	
-	function resourcePath( $path, $fromDocRoot = true ) {
-		global $xoops;
-		
-		$parts = explode( '#', $path, 2 );
-		if ( count( $parts ) &gt; 1 ) {
-			list( $bundleId, $resPath ) = $parts;
-			// This is component resource: modules are in 'modules', and components in 'components'
-			$themedRoot = ( substr( $parts[0], 0, 4 ) == 'mod_' ) ? 'modules' : 'components';
-			if ( file_exists( &quot;$this-&gt;path/$themedRoot/$bundleId/$resPath&quot; ) ) {
-				return &quot;themes/$this-&gt;folderName/$themedRoot/$bundleId/$resPath&quot;;
-			} else {
-				return XOS::classVar( $bundleId, 'xoBundleRoot' ) . '/' . $resPath;
-			}
-		}		
-		if ( substr( $path, 0, 1 ) == '/' ) {
-			$path = substr( $path, 1 );
-			$fromDocRoot = false;
-		}
-		if ( file_exists( &quot;$this-&gt;path/$path&quot; ) ) {
-			return &quot;themes/$this-&gt;folderName/$path&quot;;
-		}
-		if ( !empty( $this-&gt;parentTheme ) ) {
-			if ( !is_object( $this-&gt;parentTheme ) ) {
-				$this-&gt;parentTheme =&amp; XOS::create( 'xoops_pyro_Theme', array( 'folderName' =&gt; $this-&gt;parentTheme ) );
-			}
-			if ( is_object( $this-&gt;parentTheme ) ) {
-				return $this-&gt;parentTheme-&gt;resourcePath( $path, $fromDocRoot );
-			}
-		}
-		return $fromDocRoot ? &quot;www/$path&quot; : &quot;themes/$this-&gt;folderName/$path&quot;;
-	}
-	
-    /**
-    * Add Javascript file or JS code to the document head
-    *
-    * @param string $src path to .js file
-    * @param array $attributes name =&gt; value paired array of attributes such as title
-    * @param string $content JavaScript code to output between the tags
-    *
-    * @return void
-    **/
-    function addScript( $src = '', $attributes = array(), $content = '' ) {
-    	global $xoops;
-		if ( !empty( $src ) ) {
-			$attributes['src'] = $xoops-&gt;url( $this-&gt;resourcePath( $src ) );
-		}
-		if ( !empty( $content ) ) {
-			$attributes['_'] = $content;
-		}
-		if ( !isset( $attributes['type'] ) ) {
-			$attributes['type'] = 'text/javascript';
-		}
-		$this-&gt;setMeta( 'script', $src, $attributes );
-    }
-
-    /**
-    * Add StyleSheet or CSS code to the document head
-    *
-    * @param string $src path to .css file
-    * @param array $attributes name =&gt; value paired array of attributes such as title
-    * @param string $content CSS code to output between the &lt;style&gt; tags (in case $src is empty)
-    *
-    * @return void
-    **/
-    function addStylesheet( $src = '', $attributes = array(), $content = '' ) {
-    	global $xoops;
-		if ( !empty( $src ) ) {
-			$attributes['href'] = $xoops-&gt;url( $this-&gt;resourcePath( $src ) );
-		}
-		if ( !isset($attributes['type']) ) {
-			$attributes['type'] = 'text/css';
-		}
-		if ( !empty( $content ) ) {
-			$attributes['_'] = $content;
-		}
-    	$this-&gt;setMeta( 'stylesheet', $src, $attributes );
-    }
-	/**
-	 * Add a &lt;link&gt; to the header
-	 * 
-	 * @param string	$rel		Relationship from the current doc to the anchored one
-	 * @param string	$href		URI of the anchored document
-	 * @param array		$attributes	Additional attributes to add to the &lt;link&gt; element
-	 */
-	function addLink( $rel, $href = '', $attributes = array() ) {
-		global $xoops;
-		if ( !empty( $href ) ) {
-			$attributes['href'] = $href;
-		}
-		$this-&gt;setMeta( 'link', $rel, $attributes );
-	}
-    
-	/**
-	 * Change output page meta-information
-	 */
-    function setMeta( $type = 'meta', $name = '', $value = '' ) {
-		if ( !isset( $this-&gt;metas[$type] ) ) {
-			$this-&gt;metas[$type] = array();
-		}
-    	if ( isset($name) ) {
-			$this-&gt;metas[$type][$name] = $value;
-		} else {
-			$this-&gt;metas[$type][] = 	$value;
-		}
-		return $value;
-    }
-	
-
-	
-	
-
-}
-
-
-?&gt;
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,27 +0,0 @@
-&lt;?php
-/**
-* xoops_pyro_Theme bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A>
-*
-* @copyright    The XOOPS project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
-* @license      <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
-*/
-
-return array(
-	'xoBundleDisplayName' =&gt; 'XOOPS Theme component',
-	'xoBundleIdentifier' =&gt; 'xoops_pyro_Theme',
-	'xoClassPath' =&gt; '/theme.php',
-	'xoFactory' =&gt; 'xoops_pyro_ThemeFactory',
-	'xoServices' =&gt; array(
-		'xoops_pyro_ThemeFactory' =&gt; array(
-			'xoClassPath' =&gt; '/theme.php',
-		),
-	),
-);
-
-?&gt;
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,82 +0,0 @@
-&lt;?php
-/**
-* xoops_pyro_Widget component class file
-*
-* @copyright	The Xoops project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
-* @license      <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_Widget
-* @author       Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
-* @since        2.3.0
-* @version		$Id$
-*/
-
-/**
-* xoops_pyro_Widget
-*
-* Widgets are user interface components that can be rendered to HTML
-* 
-* 
-* 
-* 
-* @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_Widget
-* @since        2.3.0
-*/
-class xoops_pyro_Widget {
-	/**
-	 * XMLID given to this widget main output element
-	 *
-	 * @var string
-	 */
-	var $elementId = '';
-	/**
-	 * Classes of this widget output element (when rendered to HTML)
-	 *
-	 * @var string[]
-	 */
-	var $elementClasses = array();
-	/**
-	 * Path to the stylesheet to add to the document when inserting this widget
-	 *
-	 * @var string
-	 */
-	var $stylesheet = '';
-	/**
-	 * Path to the javascript file to add to the document when inserting this widget
-	 *
-	 * @var string
-	 */
-	var $javascript = '';
-	/**
-	 * Template to use to render this widget (use hardcoded rendering if left empty)
-	 *
-	 * @var string
-	 */
-	var $template = '';
-	/**
-	 * Renders this widget
-	 */
-	function render() {
-		return '';
-	}
-	/**
-	 * Returns an XML opening tag with its 'id' and 'class' attributes set
-	 * @access protected
-	 */
-	function renderOpeningTag( $tagName ) {
-		$str = &quot;&lt;$tagName&quot;;
-		if ( $this-&gt;elementId ) {
-			$str .= ' id=&quot;' . $this-&gt;elementId . '&quot;';
-		}
-		if ( !empty( $this-&gt;elementClasses ) ) {
-			$str .= ' class=&quot;' . implode( ' ', $this-&gt;elementClasses ) . '&quot;';
-		}
-		return $str . '&gt;';
-	}
-
-	
-	
-}
-

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,34 +0,0 @@
-&lt;?php
-/**
-* xoops_pyro bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A>
-*
-* @copyright    The XOOPS project <A HREF="http://www.xoops.org/">http://www.xoops.org/</A>
-* @license      <A HREF="http://www.fsf.org/copyleft/gpl.html">http://www.fsf.org/copyleft/gpl.html</A> GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/xoops4-svn">skalpa at xoops.org</A>&gt;
-*/
-
-return array(
-	'xoBundleDisplayName' =&gt; '&quot;Pyro&quot; user interface framework',
-	'xoBundleIdentifier' =&gt; 'xoops_pyro',
-	'xoServices' =&gt; array(
-		'xoops_pyro_Theme'	=&gt; array (
-			'xoBundleRoot' =&gt; '/Theme.xoobj'
-		),
-		'xoops_pyro_Widget' =&gt; array(
-			'xoClassPath' =&gt; '/widget.php',
-		),
-		'xoops_pyro_TreeWidget'	=&gt; array (
-			'xoBundleRoot' =&gt; '/TreeWidget.xoobj'
-		),
-		'xoops_template_Smarty'	=&gt; array (
-			'xoBundleRoot' =&gt; '/Smarty.xoobj'
-		),
-	),
-);
-
-?&gt;
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000230.html">[Xoops4-svn] r238 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore
</A></li>
	<LI>Next message: <A HREF="000232.html">[Xoops4-svn] r240 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#231">[ date ]</a>
              <a href="thread.html#231">[ thread ]</a>
              <a href="subject.html#231">[ subject ]</a>
              <a href="author.html#231">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/xoops4-svn">More information about the Xoops4-svn
mailing list</a><br>
</body></html>
