From skalpa at berlios.de  Thu Feb  9 15:53:32 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Thu, 9 Feb 2006 15:53:32 +0100
Subject: [Xoops4-svn] r218 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore: . CoreServices
Message-ID: <200602091453.k19ErW9f028065@sheep.berlios.de>

Author: skalpa
Date: 2006-02-09 15:53:22 +0100 (Thu, 09 Feb 2006)
New Revision: 218

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/
Log:
Moving the authentication framework to coreservices/
(many new classes are going to be committed. I decided to re-organize the folders a bit to the FS folders correspond more to the real layers)

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom (from rev 217, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Authentication.xofrom)



From skalpa at berlios.de  Thu Feb  9 15:54:30 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Thu, 9 Feb 2006 15:54:30 +0100
Subject: [Xoops4-svn] r219 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation
Message-ID: <200602091454.k19EsUwC031120@sheep.berlios.de>

Author: skalpa
Date: 2006-02-09 15:54:25 +0100 (Thu, 09 Feb 2006)
New Revision: 219

Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Authentication.xofrom/
Log:
Auth framework moved to CoreServices/



From skalpa at berlios.de  Thu Feb  9 15:56:36 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Thu, 9 Feb 2006 15:56:36 +0100
Subject: [Xoops4-svn] r220 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom
Message-ID: <200602091456.k19Eua5i032400@sheep.berlios.de>

Author: skalpa
Date: 2006-02-09 15:56:32 +0100 (Thu, 09 Feb 2006)
New Revision: 220

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xoopsdb.php
Log:
Documentation corrections

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php	2006-02-09 14:54:25 UTC (rev 219)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php	2006-02-09 14:56:32 UTC (rev 220)
@@ -10,7 +10,7 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_auth
- * @package		xoops_auth_AuthenticationService
+ * @subpackage	xoops_auth_AuthenticationService
  * @version		$Id$
  */
 

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php	2006-02-09 14:54:25 UTC (rev 219)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php	2006-02-09 14:56:32 UTC (rev 220)
@@ -9,6 +9,7 @@
 * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
 * @author		Skalpa Keo <skalpa at xoops.org>
 * @since		2.3.0
+* @category		CoreServices
 * @package		xoops_auth
 * @version		$Id$
 */

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xoopsdb.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xoopsdb.php	2006-02-09 14:54:25 UTC (rev 219)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xoopsdb.php	2006-02-09 14:56:32 UTC (rev 220)
@@ -10,7 +10,7 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_auth
- * @package		xoops_auth_DatabaseDriver
+ * @subpackage	xoops_auth_DatabaseDriver
  * @version		$Id$
  */
 
@@ -25,6 +25,8 @@
  * xoops_auth_DatabaseDriver authentication driver
  * 
  * This driver checks if the specified user exists in the database
+ * @package		xoops_auth
+ * @subpackage	xoops_auth_DatabaseDriver
  */
 class xoops_auth_DatabaseDriver extends xoops_auth_AuthenticationDriver {
 



From skalpa at berlios.de  Mon Feb 13 04:01:28 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:01:28 +0100
Subject: [Xoops4-svn] r221 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm
Message-ID: <200602130301.k1D31SW6013780@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:00:44 +0100 (Mon, 13 Feb 2006)
New Revision: 221

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/database.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/legacy.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/mysql.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/xo-info.php
Log:
Fixed the statements preparation routine, and made serious enhancements to the documentation

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/database.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/database.php	2006-02-09 14:56:32 UTC (rev 220)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/database.php	2006-02-13 03:00:44 UTC (rev 221)
@@ -10,11 +10,64 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_db
+ * @subpackage	xoops_db_Database
  * @version		$Id$
  */
 
-
-
+/**
+ * xoops_db_Database objects factory
+ * 
+ * The xoops_db_DatabaseFactory is the factory class responsible for database connections instanciation.
+ * It is invocated when you request the creation of a <var>xoops_db_Database</var> instance, and will
+ * return an instance of a specicif driver according to the <var>dsn</var> parameter you'll have provided.
+ * 
+ * In general, a DSN consists of the driver name, followed by a colon, followed by the driver-specific 
+ * connection syntax. Further information is available from the driver-specific documentation.
+ * 
+ * The dsn parameter supports three different methods of specifying the arguments required to create a 
+ * database connection: 
+ * - <b>Driver invocation</b>: <var>dsn</var> contains the full DSN.
+ * - <b>Aliasing</b>: <var>dsn</var> dsn consists of a datastore name that maps to an entry defined in the {@link xoops_db_DatabaseFactory::$availableStores} collection.
+ *
+ * A special version of the <var>xoops.mysql</var> driver implementing the pre-2.3 database interface
+ * called <var>xoops.legacy</var> is provided with XOOPS. Applications developers can use it to switch
+ * progressively to the new interface (the old one will become entirely deprecrated in the future, to ensure
+ * XOOPS can entirely run on other RDBMS systems).
+ * 
+ * <b>Create a database connection using driver invocation</b>
+ * <code>
+ * // Connect to a xoops_db_Database_mysql database
+ * $mysqldb =& XOS::create( 'xoops_db_Database', array(
+ *     'dsn' => 'mysql:dbname=test;host=localhost;user=dbuser;password=dbpwd',
+ * ) );
+ * </code>
+ * 
+ * <b>Create a database instance using an alias</b>
+ * 
+ * The following example assumes that you have defined a datastore named <i>backupdb</i> in your system
+ * (whether by using the corresponding configuration module panel, or by entering it in the
+ * <var>xoops_db_DatabaseFactory</var> managed preferences file).
+ * 
+ * <code>
+ * // Connect to a database using an alias
+ * $db =& XOS::create( 'xoops_db_Database', array( 'dsn' => 'backupdb' ) );
+ * if ( !$db ) {
+ *     echo 'Failed to connect to the backupdb database';
+ * }
+ * </code>
+ * 
+ * <b>Create a database connection to the system database</b>
+ * <code>
+ * // Use the default invocation system
+ * $db =& XOS::create( 'xoops_db_Database', array( 'dsn' => 'system' ) );
+ * 
+ * // Specifically request an instance supporting the old db interface
+ * $olddb =& $xoops->loadService( 'xoopsdb' );
+ * </code>
+ *
+ * @package		xoops_db
+ * @subpackage	xoops_db_Database
+ */
 class xoops_db_DatabaseFactory {
 	/**
 	 * Available databases, indexed by name
@@ -90,6 +143,10 @@
 
 /**
  * Base class for database drivers
+ * 
+ * All xoops_db database drivers inherit from this class.
+ * @package		xoops_db
+ * @subpackage	xoops_db_Database
  */
 class xoops_db_Database {
 	/**

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/legacy.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/legacy.php	2006-02-09 14:56:32 UTC (rev 220)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/legacy.php	2006-02-13 03:00:44 UTC (rev 221)
@@ -11,19 +11,18 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_db
- * @subpackage	xoops_db_Database
+ * @subpackage	xoops_db_Database_legacy
  * @version		$Id$
  */
 
-/**
- * This file cannot be requested directly
- */
 if ( !defined( 'XOOPS_PATH' ) ) exit();
 
 XOS::import( 'xoops_db_Database_mysql' );
 
 /**
  * Legacy xoops_db_Database driver main class
+ * @package		xoops_db
+ * @subpackage	xoops_db_Database_legacy
  */
 class xoops_db_Database_legacy extends xoops_db_Database_mysql {
 	/**

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/mysql.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/mysql.php	2006-02-09 14:56:32 UTC (rev 220)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/mysql.php	2006-02-13 03:00:44 UTC (rev 221)
@@ -10,7 +10,7 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_db
- * @subpackage	xoops_db_Database
+ * @subpackage	xoops_db_Database_mysql
  * @version		$Id$
  */
 
@@ -54,7 +54,9 @@
 
 
 /**
- * Legacy xoops_db_Database driver main class
+ * PDO emulation driver for MySQL and PHP4
+ * @package		xoops_db
+ * @subpackage	xoops_db_Database_mysql
  */
 class xoops_db_Database_mysql extends xoops_db_Database {
 	/**
@@ -74,6 +76,10 @@
 		PDO_MYSQL_ATTR_USE_BUFFERED_QUERY => false,
 	);
 	
+	
+	var $fetchMode = PDO_FETCH_ASSOC;
+
+	/**#@+ @tasktype 10 Connection initialization*/
 	/**
 	 * connect to the database
 	 * 
@@ -96,7 +102,9 @@
 		}
 		return true;
 	}
-	// --------- PDO implementation ---------
+	/**#@-*/
+
+	/**#@+ @tasktype 20 Handling transactions*/
 	/**
 	 * Initiates a transaction
 	 *
@@ -107,6 +115,12 @@
 		return true;
 	}
 	/**
+	 * Rolls back a transaction
+	 */
+	function rollBack() {
+		return true;
+	}
+	/**
 	 * Commits a transaction
 	 *
 	 * NB: This driver doesn't support transactions and always stays in autocommit mode
@@ -115,6 +129,9 @@
 	function commit() {
 		return true;
 	}
+	/**#@-*/
+
+	/**#@+ @tasktype 30 Getting error information*/
 	/**
 	 * Fetch extended error information associated with the last operation on the database handle 
 	 * 
@@ -135,6 +152,9 @@
 	function errorCode() {
 		return 'HY000';
 	}
+	/**#@-*/
+
+	/**#@+ @tasktype 30 Performing queries*/
 	/**
 	 * Execute an SQL statement and return the number of affected rows
 	 * 
@@ -154,12 +174,6 @@
 		}
 	}
 	/**
-	 * Returns the ID of the last inserted row
-	 */
-	function lastInsertId( $name = '' ) {
-		return mysql_insert_id( $this->conn );
-	}
-	/**
 	 * Prepares a statement for execution and returns a statement object
 	 * 
 	 * <p>
@@ -207,7 +221,14 @@
 		}
 		return false;
 	}
+	/**#@-*/
 	/**
+	 * Returns the ID of the last inserted row
+	 */
+	function lastInsertId( $name = '' ) {
+		return mysql_insert_id( $this->conn );
+	}
+	/**
 	 * Quotes a string for use in a query.
 	 * 
 	 * PDO::quote() places quotes around the input string (if required) and escapes special 
@@ -216,17 +237,13 @@
 	function quote( $string ) {
 		return "'" . mysql_real_escape_string( $string, $this->conn ) . "'";
 	}
-	/**
-	 * Rolls back a transaction
-	 */
-	function rollBack() {
-		return true;
-	}
-
-	
 }
 
-
+/**
+ * Statement object for the xoops_db_Database_mysql driver
+ * @package		xoops_db
+ * @subpackage	xoops_db_Database_mysql
+ */
 class xoops_db_Statement_mysql {
 
 	var $query = '';
@@ -261,10 +278,15 @@
 	var $fetchTarget = false;
 	
 	function xoInit( $options = array() ) {
-		if ( strpos( $this->query, '?' ) !== false ) {
-			$this->preparedQuery = preg_replace( '/(\\?)/', '{__p$1}', $this->query );
+		if ( strpos( $this->query, '?' ) === false ) {
+			$this->preparedQuery = preg_replace( '/:([a-zA-Z_]*)/', '{$1}', $this->query );
 		} else {
-			$this->preparedQuery = preg_replace( '/:([a-zA-Z_]*)/', '{$1}', $this->query );
+			$this->preparedQuery = $this->query;
+			$n = 1;
+			while ( ( $pos = strpos( $this->preparedQuery, '?' ) ) !== false ) {
+				$this->preparedQuery = substr( $this->preparedQuery, 0, $pos ) . "{__p$n}" . substr( $this->preparedQuery, $pos+1 );
+				$n++;
+			}
 		}
 		return true;
 	}
@@ -297,7 +319,16 @@
 	 * @param mixed $value
 	 * @param int $type
 	 */
-	function bindValue( $param, $value, $type ) {
+	function bindValue( $param, $value, $type = null ) {
+		if ( !isset( $type ) ) {
+			if ( is_int( $value ) ) {
+				$type = PDO_PARAM_INT;
+			} elseif ( is_bool( $value ) ) {
+				$type = PDO_PARAM_BOOL;
+			} else {
+				$type = PDO_PARAM_STR;
+			}
+		}
 		$param = intval($param) ? "__p$param" : substr($param,1);
 		$this->paramBindings[$param] = array( $value, $type );
 	}
@@ -329,6 +360,7 @@
 			$replace[] = $this->castValue( $v[0], $v[1] );
 		}
 		$sql = str_replace( $search, $replace, $this->preparedQuery );
+		$this->db->logEvent( "SQL: $sql" );
 		$this->result = mysql_unbuffered_query( $sql, $this->db->conn );
 		return (bool)$this->result;
 	}
@@ -390,6 +422,16 @@
 		}
 	}
 
+	function fetchAll( $fetchMode = null, $column = 0 ) {
+		$fetchMode = isset( $fetchMode ) ?	$fetchMode : $this->fetchMode;
+		$rows = array();
+		while ( $row = $this->fetch( $fetchMode ) ) {
+			$rows[] = $row;
+		}
+		return $rows;
+	}
+	
+	
 	/**
 	 * Cast a variable according to a PDO_PARAM_* type
 	 *

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/xo-info.php	2006-02-09 14:56:32 UTC (rev 220)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/xo-info.php	2006-02-13 03:00:44 UTC (rev 221)
@@ -1,17 +1,17 @@
 <?php
 /**
-* xoops_db framework bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_db
-* @version		$Id$
-*/
+ * xoops_db framework bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_db
+ * @version		$Id$
+ */
 
 return array(
 	'xoBundleDisplayName' => 'XOOPS Database framework',



From skalpa at berlios.de  Mon Feb 13 04:02:39 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:02:39 +0100
Subject: [Xoops4-svn] r222 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom
Message-ID: <200602130302.k1D32d1S013934@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:02:20 +0100 (Mon, 13 Feb 2006)
New Revision: 222

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php
Log:
Documentation fixes

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php	2006-02-13 03:00:44 UTC (rev 221)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/auth.php	2006-02-13 03:02:20 UTC (rev 222)
@@ -84,9 +84,9 @@
 	/**
 	 * Checks user credentials validity
 	 *
-	 * @var string	login		User login
-	 * @var string	password	User password (optionally encrypted)
-	 * @var string	hash		Name of the function used to hash the password (if any)
+	 * @param string	login		User login
+	 * @param string	password	User password (optionally encrypted)
+	 * @param string	hash		Name of the function used to hash the password (if any)
 	 * @return mixed False if authentication failed, true if it worked, or the user login if different from the specified one
 	 */
 	function checkCredentials( $login, $password, $hash = '' ) {

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php	2006-02-13 03:00:44 UTC (rev 221)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Authentication.xofrom/xo-info.php	2006-02-13 03:02:20 UTC (rev 222)
@@ -1,18 +1,17 @@
 <?php
 /**
-* xoops_auth framework bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @category		CoreServices
-* @package		xoops_auth
-* @version		$Id$
-*/
+ * xoops_auth framework bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_auth
+ * @version		$Id$
+ */
 
 return array(
 	'xoBundleDisplayName'			=> 'XOOPS Authentication framework',



From skalpa at berlios.de  Mon Feb 13 04:10:25 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:10:25 +0100
Subject: [Xoops4-svn] r223 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices: . Database.xofrm
Message-ID: <200602130310.k1D3APpq017485@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:10:08 +0100 (Mon, 13 Feb 2006)
New Revision: 223

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/legacy.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php
Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/legacy.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php
Log:
Moving the db framework to CoreServices/


Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm (from rev 217, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/database.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php	2006-02-13 03:10:08 UTC (rev 223)
@@ -1,207 +0,0 @@
-<?php
-/**
- * xoops_db_DatabaseObject and xoops_db_DatabaseFactory classes definition
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
- *
- * @copyright	The XOOPS project http://www.xoops.org/
- * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
- * @author		Skalpa Keo <skalpa at xoops.org>
- * @since		2.3.0
- * @package		xoops_db
- * @version		$Id$
- */
-
-
-
-class xoops_db_DatabaseFactory {
-	/**
-	 * Available databases, indexed by name
-	 *
-	 * @var array
-	 */
-	var $availableStores = array(
-		'system' => array(
-			'driverName' => 'xoops.mysql',
-			'host' => XOOPS_DB_HOST,
-			'user' => XOOPS_DB_USER,
-			'password' => XOOPS_DB_PASS,
-			'dbname' => XOOPS_DB_NAME,
-			'prefix' => XOOPS_DB_PREFIX,
-			'persistent' => XOOPS_DB_PCONNECT,
-		),
-	);
-	/**
-	 * References to the already created instances (indexed by DSN)
-	 *
-	 * @var array
-	 * @access private
-	 */
-	var $instances = array();
-	
-	/**
-	 * Creates an instance to represent a connection to the requested database
-	 * 
-	 * mysql:host=localhost;dbname=mydb
-	 * to explicitely specify a xoops driver:
-	 * xoops.legacy:host=localhost;dbname=mydb
-	 */
-	function &createInstance( $options = array(), $initArgs = array() ) {
-		if ( !isset( $options['dsn'] ) ) {
-			$options['dsn'] = 'system';
-		}
-		if ( isset( $this->instances[ $options['dsn'] ] ) ) {
-			return $this->instances[ $options['dsn'] ];
-		}
-		$inst = false;
-		$parsed = explode( ':', $dsn = $options['dsn'], 2 );
-		if ( count( $parsed ) == 1 ) {
-			// An alias name was specified
-			if ( !isset( $this->availableStores[$parsed[0]] ) ) {
-				trigger_error( "The database alias {$parsed[0]} is invalid.", E_USER_WARNING );
-				return $inst;
-			}
-			$options = array_merge( $this->availableStores[$parsed[0]], $options );
-		} else {
-			// A real DSN was specified
-			if ( substr( $parsed[0], 0, 5 ) == 'xoops' ) {
-				// Convert the rest of the dsn string to properties
-				$parsed = explode( ';', $parsed[1] );
-				foreach ( $parsed as $prop ) {
-					list( $name, $value ) = explode( '=', $prop, 2 );
-					$options[$name] = $value;		
-				}
-				$options['driverName'] = $parsed[0];
-			}
-		}
-		if ( substr( $options['driverName'], 0, 5 ) != 'xoops' ) {
-			trigger_error( "Direct PDO drivers access is not implemented yet.", E_USER_WARNING );
-			return $inst;
-		} else {
-			$options['driverName'] = substr( $options['driverName'], 6 );
-			$inst =& XOS::create( "xoops_db_Database_{$options['driverName']}", $options );
-			$this->instances[$dsn] =& $inst;
-		}
-		return $inst;
-	}
-}
-
-
-/**
- * Base class for database drivers
- */
-class xoops_db_Database {
-	/**
-	 * Type of database driver
-	 * @var string
-	 */
-	var $driverName = '';
-	/**
-	 * Database hostname
-	 * @var string
-	 */
-	var $host = 'localhost';
-	/**
-	 * Username used to connect
-	 * @var string
-	 */
-  	var $user = '';
-  	/**
-  	 * Database name
-  	 *
-  	 * @var string
-  	 */
-	var $dbname = 'xoops';
-	/**
-	 * Prefix for tables in the database
-	 * @var string
-	 */
-	var $prefix = '';
-	/**
-	 * Whether to use persistent connection or not
-	 * @var boolean
-	 */
-	var $persistent = false;
-	/**
-	 * If true, attempt to connect to the database upon instanciation
-	 * @var boolean
-	 */
-	var $autoConnect = true;
-	/**
-	 * If statements that modify the database are selected (see forceExec() to override this)
-	 * @var boolean
-	 */
-	var $allowWebChanges = false;
-	
-	/**
-	 * reference to a {@link XoopsLogger} object
-     * @see XoopsLogger
-	 * @var object XoopsLogger
-	 */
-	var $logger = false;
-
-
-	function xoInit( $options = array() ) {
-		global $xoops;
-
-		$this->allowWebChanges = ( $_SERVER['REQUEST_METHOD'] != 'GET' );
-		if ( $xoops->services['logger'] ) {
-			$this->logger =& $xoops->services['logger'];
-		}
-		if ( $this->autoConnect ) {
-			return $this->connect();
-		}
-		return true;
-	}
-	
-	/**
-	 * connect to the database
-	 * 
-	 * @param bool $selectdb select the database now?
-	 * @return bool successful?
-	 */
-	function connect( $selectdb = true ) {
-		return false;
-	}
-	/**
-	 * Send information about an event to the attached logger
-	 */
-	function logEvent( $msg ) {
-		if ( $this->logger ) {
-			$this->logger->logEvent( $msg, $this->xoBundleIdentifier );
-		}
-	}
-	/**
-	 * Send information about an error to the attached logger
-	 */
-	function logError() {
-		if ( $this->logger ) {
-			$error = $this->errorInfo();
-			$this->logger->logEvent( "Error {$error[1]} ({$error[0]}): {$error[2]}", $this->xoBundleIdentifier );
-		}
-	}
-	
-	/**
-	 * Prefix a table name
-	 * 
-	 * if tablename is empty, only prefix will be returned
-	 * 
-	 * @param string $table tablename
-	 * @return string prefixed tablename, just prefix if tablename is empty
-	 */
-	function prefix( $table = '' ) {
-		if ( empty( $table ) ) {
-			return $this->prefix;
-		}
-		return empty($this->prefix) ? $table : ( $this->prefix . '_' . $table );
-	}
-	
-}
-
-
-
-
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php (from rev 221, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/database.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/legacy.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/legacy.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/legacy.php	2006-02-13 03:10:08 UTC (rev 223)
@@ -1,263 +0,0 @@
-<?php
-/**
- * Legacy (XOOPS 2.0.x) xoops_db_Database driver class definition
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
- *
- * @copyright	The XOOPS project http://www.xoops.org/
- * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
- * @author		Kazumi Ono <onokazu at xoops.org>
- * @author		Skalpa Keo <skalpa at xoops.org>
- * @since		2.3.0
- * @package		xoops_db
- * @subpackage	xoops_db_Database
- * @version		$Id$
- */
-
-/**
- * This file cannot be requested directly
- */
-if ( !defined( 'XOOPS_PATH' ) ) exit();
-
-XOS::import( 'xoops_db_Database_mysql' );
-
-/**
- * Legacy xoops_db_Database driver main class
- */
-class xoops_db_Database_legacy extends xoops_db_Database_mysql {
-	/**
-	 * assign a {@link XoopsLogger} object to the database
-	 * @deprecated (assign the logger public property)
-	 */
-	function setLogger(&$logger) {
-		$this->logger =& $logger;
-	}
-	/**
-	 * set the prefix for tables in the database
-	 * @deprecated (assign the prefix public property)
-	 */
-	function setPrefix($value) {
-		$this->prefix = $value;
-	}
-	/**
-	 * generate an ID for a new row
-     * 
-     * This is for compatibility only. Will always return 0, because MySQL supports
-     * autoincrement for primary keys.
-     * 
-     * @param string $sequence name of the sequence from which to get the next ID
-     * @return int always 0, because mysql has support for autoincrement
-	 */
-	function genId($sequence)
-	{
-		return 0; // will use auto_increment
-	}
-
-	/**
-	 * Get a result row as an enumerated array
-	 * 
-     * @param resource $result
-     * @return array
-	 */
-	function fetchRow($result)
-	{
-		return @mysql_fetch_row($result);
-	}
-
-	/**
-	 * Fetch a result row as an associative array
-	 *
-     * @return array
-	 */
-	function fetchArray($result)
-    {
-        return @mysql_fetch_assoc( $result );
-    }
-
-    /**
-     * Fetch a result row as an associative array
-     *
-     * @return array
-     */
-    function fetchBoth($result)
-    {
-        return @mysql_fetch_array( $result, MYSQL_BOTH );
-    }
-
-	/**
-	 * Get the ID generated from the previous INSERT operation
-	 * 
-     * @return int
-	 */
-	function getInsertId()
-	{
-		return mysql_insert_id($this->conn);
-	}
-
-	/**
-	 * Get number of rows in result
-	 * 
-     * @param resource query result
-     * @return int
-	 */
-	function getRowsNum($result)
-	{
-		return @mysql_num_rows($result);
-	}
-
-	/**
-	 * Get number of affected rows
-	 *
-     * @return int
-	 */
-	function getAffectedRows()
-	{
-		return mysql_affected_rows($this->conn);
-	}
-
-	/**
-	 * Close MySQL connection
-	 * 
-	 */
-	function close()
-	{
-		mysql_close($this->conn);
-	}
-
-	/**
-	 * will free all memory associated with the result identifier result.
-	 * 
-     * @param resource query result
-     * @return bool TRUE on success or FALSE on failure. 
-	 */
-	function freeRecordSet($result)
-	{
-		return mysql_free_result($result);
-	}
-
-	/**
-	 * Returns the text of the error message from previous MySQL operation
-	 * 
-     * @return bool Returns the error text from the last MySQL function, or '' (the empty string) if no error occurred. 
-	 */
-	function error()
-	{
-		return @mysql_error();
-	}
-
-	/**
-	 * Returns the numerical value of the error message from previous MySQL operation 
-	 * 
-     * @return int Returns the error number from the last MySQL function, or 0 (zero) if no error occurred. 
-	 */
-	function errno()
-	{
-		return @mysql_errno();
-	}
-
-    /**
-     * Returns escaped string text with single quotes around it to be safely stored in database
-     * 
-     * @param string $str unescaped string text
-     * @return string escaped string text with single quotes around
-     */
-    function quoteString($str)
-    {
-         //return "'".str_replace('\\"', '"', addslashes($str))."'";
-         return $this->quote( $str );
-    }
-
-    /**
-	 * Get field name
-	 *
-     * @param resource $result query result
-     * @param int numerical field index
-     * @return string
-	 */
-	function getFieldName($result, $offset)
-	{
-		return mysql_field_name($result, $offset);
-	}
-
-	/**
-	 * Get field type
-	 *
-     * @param resource $result query result
-     * @param int $offset numerical field index
-     * @return string
-	 */
-    function getFieldType($result, $offset)
-	{
-		return mysql_field_type($result, $offset);
-	}
-
-	/**
-	 * Get number of fields in result
-	 *
-     * @param resource $result query result
-     * @return int
-	 */
-	function getFieldsNum($result)
-	{
-		return mysql_num_fields($result);
-	}
-
-	/**
-     * perform a query on the database
-     * 
-     * @param string $sql a valid MySQL query
-     * @param int $limit number of records to return
-     * @param int $start offset of first record to return
-     * @return resource query result or FALSE if successful
-     * or TRUE if successful and no result
-     */
-    function query($sql, $limit=0, $start=0) {
-	    $sql = ltrim($sql);
-		if ( !$this->allowWebChanges && strtolower( substr($sql, 0, 6) ) != 'select' )  {
-			trigger_error( 'Database updates are not allowed during processing of a GET request', E_USER_WARNING );
-			return false;
-		}
-		return $this->queryF( $sql, $limit, $start );
-    }
-    
-    function queryF( $sql, $limit = 0, $start = 0 ) {
-    	if ( !empty($limit) ) {
-			$sql = $sql . ' LIMIT ' . (int)$start . ', ' . (int)$limit;
-		}
-		if ( $result = mysql_query($sql, $this->conn) ) {
-			$this->logEvent($sql);
-        } else {
-        	$this->logError();
-        }
-        return $result;
-    }
-
-    /**
-	 * perform queries from SQL dump file in a batch
-	 * 
-     * @param string $file file path to an SQL dump file
-     * 
-     * @return bool FALSE if failed reading SQL file or TRUE if the file has been read and queries executed
-	 */
-	function queryFromFile($file){
-        if (false !== ($fp = fopen($file, 'r'))) {
-			include_once XOOPS_ROOT_PATH.'/class/database/sqlutility.php';
-            $sql_queries = trim(fread($fp, filesize($file)));
-            SqlUtility::splitMySqlFile($pieces, $sql_queries);
-            foreach ($pieces as $query) {
-                // [0] contains the prefixed query
-                // [4] contains unprefixed table name
-                $prefixed_query = SqlUtility::prefixQuery(trim($query), $this->prefix());
-                if ($prefixed_query != false) {
-                    $this->query($prefixed_query[0]);
-                }
-            }
-            return true;
-        }
-        return false;
-    }
-    
-}
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/legacy.php (from rev 221, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/legacy.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/mysql.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php	2006-02-13 03:10:08 UTC (rev 223)
@@ -1,419 +0,0 @@
-<?php
-/**
- * Mysql xoops_db_Database driver class definition
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
- *
- * @copyright	The XOOPS project http://www.xoops.org/
- * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
- * @author		Skalpa Keo <skalpa at xoops.org>
- * @since		2.3.0
- * @package		xoops_db
- * @subpackage	xoops_db_Database
- * @version		$Id$
- */
-
-/**
- * This file cannot be requested directly
- */
-if ( !defined( 'XOOPS_PATH' ) ) exit();
-
-XOS::import( 'xoops_db_Database' );
-
-if ( !defined( 'PDO_PARAM_INT' ) ) {
-	define( 'PDO_PARAM_NULL', 0 );
-	define( 'PDO_PARAM_INT', 1 );
-	define( 'PDO_PARAM_STR', 2 );
-	define( 'PDO_PARAM_LOB', 3 );
-	define( 'PDO_PARAM_STMT', 4 );
-	define( 'PDO_PARAM_BOOL', 5 );
-
-	define( 'PDO_FETCH_LAZY', 1);
-	define( 'PDO_FETCH_ASSOC', 2);
-	define( 'PDO_FETCH_NUM', 3);
-	define( 'PDO_FETCH_BOTH', 4);
-	define( 'PDO_FETCH_OBJ', 5);
-	define( 'PDO_FETCH_BOUND', 6);
-	define( 'PDO_FETCH_COLUMN', 7);
-	define( 'PDO_FETCH_CLASS', 8);
-	define( 'PDO_FETCH_INTO', 9);
-	define( 'PDO_FETCH_FUNC', 10);
-	define( 'PDO_FETCH_NAMED', 11);
-	define( 'PDO_FETCH_GROUP', 0x10000 );
-	define( 'PDO_FETCH_UNIQUE', 0x30000 );
-	define( 'PDO_FETCH_CLASSTYPE', 0x40000 );
-	define( 'PDO_FETCH_SERIALIZE', 0x80000 );
-	
-	// PDO class attributes
-	define( 'PDO_ATTR_PERSISTENT', 12 );
-	define( 'PDO_ATTR_STATEMENT_CLASS', 13 );
-	define( 'PDO_MYSQL_ATTR_USE_BUFFERED_QUERY', 1000 );
-}
-
-
-
-/**
- * Legacy xoops_db_Database driver main class
- */
-class xoops_db_Database_mysql extends xoops_db_Database {
-	/**
-	 * Link identifier to the connected database
-	 * @var resource
-	 */
-	var $conn = false;
-
-	/**
-	 * This instance attributes
-	 * @var array
-	 * @access protected
-	 */
-	var $attributes = array(
-		PDO_ATTR_PERSISTENT => 0,
-		PDO_ATTR_STATEMENT_CLASS => array( 'xoops_db_Statement_mysql', array() ),
-		PDO_MYSQL_ATTR_USE_BUFFERED_QUERY => false,
-	);
-	
-	/**
-	 * connect to the database
-	 * 
-     * @param bool $selectdb select the database now ?
-     * @return bool successful?
-	 */
-	function connect( $selectdb = true ) {
-		if ( $this->persistent ) {
-			$this->conn = @mysql_pconnect( $this->host, $this->user, $this->password );
-		} else {
-			$this->conn = @mysql_connect( $this->host, $this->user, $this->password );
-		}
-		if ( !$this->conn ) {
-			$this->logError();
-			return false;
-		}
-		if( $selectdb && !mysql_select_db( $this->dbname ) ) {
-			$this->logError();
-			return false;
-		}
-		return true;
-	}
-	// --------- PDO implementation ---------
-	/**
-	 * Initiates a transaction
-	 *
-	 * NB: This driver doesn't support transactions and always stays in autocommit mode
-	 * @return boolean
-	 */	
-	function beginTransation() {
-		return true;
-	}
-	/**
-	 * Commits a transaction
-	 *
-	 * NB: This driver doesn't support transactions and always stays in autocommit mode
-	 * @return boolean
-	 */	
-	function commit() {
-		return true;
-	}
-	/**
-	 * Fetch extended error information associated with the last operation on the database handle 
-	 * 
-	 * <p>errorInfo() returns an array of error information about the last operation performed 
-	 * by this database handle. The array consists of the following fields:<br />
-	 * 0: SQLSTATE error code (a five-character alphanumeric identifier defined in the ANSI SQL standard).<br />
-	 * 1: Driver-specific error code
-	 * 2: Driver-specific error message</p>
-	 * 
-	 * <p class="note">This implementation doesn't support SQLSTATE (it will always be HY000)</p>
-	 */
-	function errorInfo() {
-		return array( 'HY000', @mysql_errno( $this->conn ), @mysql_error( $this->conn ) );
-	}	
-	/**
-	 * Fetch the SQLSTATE associated with the last operation on the database handle 
-	 */
-	function errorCode() {
-		return 'HY000';
-	}
-	/**
-	 * Execute an SQL statement and return the number of affected rows
-	 * 
-	 * PDO::exec() does not return results from a SELECT statement. For a SELECT statement that 
-	 * you only need to issue once during your program, consider issuing PDO::query().
-	 * For a statement that you need to issue multiple times, prepare a PDOStatement object 
-	 * with PDO::prepare() and issue the statement with PDOStatement::execute().
-	 * 
-	 * @param string $statement The SQL statement to prepare and execute
-	 */
-	function exec( $statement ) {
-		if ( $this->allowWebChanges ) {
-			return mysql_query( $statement, $this->conn ) ? mysql_affected_rows( $this->conn ) : false;
-		} else {
-			trigger_error( 'Database updates are not allowed during processing of a GET request', E_USER_WARNING );
-			return false;
-		}
-	}
-	/**
-	 * Returns the ID of the last inserted row
-	 */
-	function lastInsertId( $name = '' ) {
-		return mysql_insert_id( $this->conn );
-	}
-	/**
-	 * Prepares a statement for execution and returns a statement object
-	 * 
-	 * <p>
-	 * Prepares an SQL statement to be executed by the PDOStatement::execute() method.
-	 * The SQL statement can contain zero or more named (:name) or question mark (?) 
-	 * parameter markers for which real values will be substituted when the statement 
-	 * is executed. You cannot use both named and question mark parameter markers within 
-	 * the same SQL statement; pick one or the other parameter style.
-	 * </p>
-	 * @param string $statement This must be a valid SQL statement for the target database server.
-	 * @param array $driverOptions This array holds one or more key=>value pairs to set attribute values for the PDOStatement object that this method returns.
-	 * @return object A PDOStatement object, if the database server successfully prepares the statement.
-	 */
-	function prepare( $statement, $driverOptions = false ) {
-		return XOS::create( 'xoops_db_Statement_mysql', array(
-			'db' => &$this,
-			'query' => $statement,
-			'driverOptions' => $driverOptions
-		) );	
-	}
-	/**
-	 * Executes an SQL statement, returning a result set as a PDOStatement object
-	 * 
-	 *<p> PDO::query() executes an SQL statement in a single function call, returning 
-	 * the result set (if any) returned by the statement as a PDOStatement object.</p>
-	 * <p>For a query that you need to issue multiple times, you will realize better 
-	 * performance if you prepare a PDOStatement object using PDO::prepare() and issue 
-	 * the statement with multiple calls to PDOStatement::execute().</p>
-	 * <p>If you do not fetch all of the data in a result set before issuing your next call
-	 * to PDO::query(), your call may fail. Call PDOStatement::closeCursor() to release the 
-	 * database resources associated with the PDOStatement object before issuing your next 
-	 * call to PDO::query().</p>
-	 * @param string $statement The valid SQL statement to prepare and execute.
-	 * @return object
-	 */
-	function query( $statement ) {
-		$stmt = XOS::create( 'xoops_db_Statement_mysql', array(
-			'db' => &$this,
-			'query' => $statement,
-			'driverOptions' => $driverOptions
-		) );
-		if ( $stmt ) {
-			$stmt->execute();
-			return $stmt;
-		}
-		return false;
-	}
-	/**
-	 * Quotes a string for use in a query.
-	 * 
-	 * PDO::quote() places quotes around the input string (if required) and escapes special 
-	 * characters within the input string, using a quoting style appropriate to the underlying driver. 
-	 */
-	function quote( $string ) {
-		return "'" . mysql_real_escape_string( $string, $this->conn ) . "'";
-	}
-	/**
-	 * Rolls back a transaction
-	 */
-	function rollBack() {
-		return true;
-	}
-
-	
-}
-
-
-class xoops_db_Statement_mysql {
-
-	var $query = '';
-	var $preparedQuery = '';
-
-	var $db = false;
-	var $result = false;
-	
-	/**
-	 * Internal lookup table for parameters bindings
-	 * @var array
-	 * @access protected
-	 */
-	var $paramBindings = array();
-	/**
-	 * Internal lookup table for columns bindings
-	 * @var array
-	 * @access protected
-	 */
-	var $columnBindings = array();
-	/**
-	 * Current fetch mode
-	 *
-	 * @var int
-	 * @access protected
-	 */
-	var $fetchMode;
-	/**
-	 * Class / instance for PDO_FETCH_CLASS / PDO_FETCH_INTO
-	 * @access protected
-	 */
-	var $fetchTarget = false;
-	
-	function xoInit( $options = array() ) {
-		if ( strpos( $this->query, '?' ) !== false ) {
-			$this->preparedQuery = preg_replace( '/(\\?)/', '{__p$1}', $this->query );
-		} else {
-			$this->preparedQuery = preg_replace( '/:([a-zA-Z_]*)/', '{$1}', $this->query );
-		}
-		return true;
-	}
-	
-	/**
-	 * Bind a column to a PHP variable
-	 *
-	 * @param mixed $column
-	 * @param mixed $variable
-	 * @param int $type
-	 */
-	function bindColumn( $column, &$variable, $type ) {
-		$this->columnBindings[ intval($column) ? (int)$column : substr($column, 1) ] = array( &$variable, $type );
-	}
-	/**
-	 * Binds a parameter to the specified variable name
-	 * @param mixed $param
-	 * @param mixed $variable
-	 * @param int $type
-	 * @param int $length
-	 * @param mixed $options
-	 */
-	function bindParam( $param, &$variable, $type = 0, $length = 0, $options = array() ) {
-		$param = intval($param) ? "__p$param" : substr($param,1);
-		$this->paramBindings[$param] = array( &$variable, $type, $length, $options );
-	}
-	/**
-	 * Bind a value to a parameter
-	 * @param mixed $param
-	 * @param mixed $value
-	 * @param int $type
-	 */
-	function bindValue( $param, $value, $type ) {
-		$param = intval($param) ? "__p$param" : substr($param,1);
-		$this->paramBindings[$param] = array( $value, $type );
-	}
-	/**
-	 * Closes the cursor, enabling the statement to be executed again
-	 */	
-	function closeCursor() {
-		if ( $this->result ) {
-			mysql_free_result( $this->result );
-			$this->result = false;
-		}
-		return true;
-	}	
-	/**
-	 * Returns the number of columns in the result set
-	 * @return integer
-	 */
-	function columnCount() {
-		return $this->result ? mysql_num_fields( $this->result ) : 0;
-	}
-	/**
-	 * Executes a prepared statement
-	 */
-	function execute( $params = array() ) {
-		$search = array();
-		$replace = array();
-		foreach ( $this->paramBindings as $k => $v ) {
-			$search[] = '{' . $k . '}';
-			$replace[] = $this->castValue( $v[0], $v[1] );
-		}
-		$sql = str_replace( $search, $replace, $this->preparedQuery );
-		$this->result = mysql_unbuffered_query( $sql, $this->db->conn );
-		return (bool)$this->result;
-	}
-	
-	function fetch( $mode = null, $orientation = null, $offset = null ) {
-		if ( !$this->result ) {
-			return false;
-		}
-		if ( !$mode ) {
-			$mode = $this->fetchMode;
-		}
-		switch ( $mode ) {
-		case PDO_FETCH_ASSOC:
-			return mysql_fetch_array( $this->result, MYSQL_ASSOC );
-		case PDO_FETCH_BOTH:
-			return mysql_fetch_array( $this->result, MYSQL_BOTH );
-		case PDO_FETCH_NUM:
-			return mysql_fetch_array( $this->result, MYSQL_NUM );
-		case PDO_FETCH_LAZY:
-		case PDO_FETCH_OBJ:
-			if ( $props = mysql_fetch_array( $this->result, MYSQL_ASSOC ) ) {
-				$target = new stdClass();
-				XOS::apply( $target, $props );
-				return $target;
-			}
-			return false;
-		case PDO_FETCH_INTO:
-			if ( $props = mysql_fetch_array( $this->result, MYSQL_ASSOC ) ) {
-				XOS::apply( $this->fetchTarget, $props );
-				return $this->fetchTarget;
-			}
-			return false;
-		case PDO_FETCH_CLASS:
-			if ( $props = mysql_fetch_array( $this->result, MYSQL_ASSOC ) ) {
-				return XOS::create( $this->fetchTarget, $props );
-			}
-			return false;
-		case PDO_FETCH_CLASS | PDO_FETCH_CLASSTYPE:
-			if ( $props = mysql_fetch_array( $this->result, MYSQL_ASSOC ) ) {
-				$classType = array_shift( $props );
-				return XOS::create( $classType, $props );
-			}
-			return false;
-		case PDO_FETCH_BOUND:
-			if ( $row = mysql_fetch_array( $this->result, MYSQL_BOTH ) ) {
-				foreach ( $this->columnBindings as $k => $col ) {
-					$col[0] = $this->castValue(  is_int($k) ? $row[$k-1] : $row[$k], $col[1] );
-				}
-				return true;
-			}
-			return false;
-		}
-	}
-
-	function setFetchMode( $mode, $param = null ) {
-		$this->fetchMode = $mode;
-		if ( $mode == PDO_FETCH_CLASS || $mode == PDO_FETCH_INTO ) {
-			$this->fetchTarget = $param;
-		}
-	}
-
-	/**
-	 * Cast a variable according to a PDO_PARAM_* type
-	 *
-	 * @param mixed $val The variable whom type must be set
-	 * @param int $type A PDO_PARAM_* data type
-	 * @return mixed
-	 * @access protected
-	 */
-	function castValue( $val, $type = PDO_PARAM_INT ) {
-		switch ( $type ) {
-		case PDO_PARAM_BOOL:
-			return $val ? 1 : 0;
-		case PDO_PARAM_STR:
-			return $this->db->quote( $val );
-		case PDO_PARAM_INT:
-		default:
-			return intval( $val );
-		}
-	}
-
-	
-	
-	
-}
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php (from rev 221, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/mysql.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php	2006-02-13 03:10:08 UTC (rev 223)
@@ -1,44 +0,0 @@
-<?php
-/**
-* xoops_db framework bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_db
-* @version		$Id$
-*/
-
-return array(
-	'xoBundleDisplayName' => 'XOOPS Database framework',
-	'xoBundleIdentifier' => 'xoops_db',
-	'xoServices' => array(
-		'xoops_db_DatabaseFactory' => array(
-			'xoBundleDisplayName' => 'Local factory for xoops_db database instances',
-			'xoClassPath' => '/database.php',
-		),
-		'xoops_db_Database' => array(
-			'xoFactory' => 'xoops_db_DatabaseFactory',
-			'xoBundleDisplayName' => 'Connection to a database',
-			'xoClassPath' => '/database.php',
-		),
-		'xoops_db_Database_mysql' => array(
-			'xoBundleDisplayName' => 'XOOPS MySQL database driver (PDO compatible)',
-			'xoClassPath' => '/mysql.php',
-		),
-		'xoops_db_Statement_mysql' => array(
-			'xoBundleDisplayName' => 'XOOPS MySQL driver prepared statement',
-			'xoClassPath' => '/mysql.php',
-		),
-		'xoops_db_Database_legacy' => array(
-			'xoBundleDisplayName' => 'XOOPS Legacy (XOOPS 2.0) database driver',
-			'xoClassPath' => '/legacy.php',
-		),
-	),
-);
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php (from rev 221, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/xo-info.php)



From skalpa at berlios.de  Mon Feb 13 04:13:53 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:13:53 +0100
Subject: [Xoops4-svn] r224 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/scripts
Message-ID: <200602130313.k1D3Dr9r019290@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:13:43 +0100 (Mon, 13 Feb 2006)
New Revision: 224

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/scripts/rebuild_registry.php
Log:
Added the ConfigPanels folder to the list of scanned folder

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/scripts/rebuild_registry.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/scripts/rebuild_registry.php	2006-02-13 03:10:08 UTC (rev 223)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/scripts/rebuild_registry.php	2006-02-13 03:13:43 UTC (rev 224)
@@ -90,6 +90,7 @@
 
 $registry = array();
 $registry = xoScanComponentsFolder( $registry, '/XOOPS/Frameworks', true );
+$registry = xoScanComponentsFolder( $registry, '/XOOPS/ConfigPanels', true );
 $registry = xoScanComponentsFolder( $registry, '/www/modules', true );
 
 if ( $fp = fopen( $this->path( '/var/Application Support/xoops_kernel_Xoops2/registry.php' ), 'wt' ) ) {



From skalpa at berlios.de  Mon Feb 13 04:14:36 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:14:36 +0100
Subject: [Xoops4-svn] r225 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm
Message-ID: <200602130314.k1D3EafN019746@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:14:30 +0100 (Mon, 13 Feb 2006)
New Revision: 225

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/errorhandler.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/logger.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/module.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/user.php
Log:
Documentation fixes

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/errorhandler.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/errorhandler.php	2006-02-13 03:13:43 UTC (rev 224)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/errorhandler.php	2006-02-13 03:14:30 UTC (rev 225)
@@ -10,7 +10,7 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_kernel
- * @package		xoops_kernel_ErrorHandler
+ * @subpackage	xoops_kernel_ErrorHandler
  * @version		$Id$
  */
 
@@ -26,6 +26,8 @@
  * information about them to the logger service.
  * Physical paths that would be part of the error messages are converted to prevent
  * path disclosure on production servers.
+ * @package		xoops_kernel
+ * @subpackage	xoops_kernel_ErrorHandler
  */
 class xoops_kernel_ErrorHandler {
 	/**

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/logger.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/logger.php	2006-02-13 03:13:43 UTC (rev 224)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/logger.php	2006-02-13 03:14:30 UTC (rev 225)
@@ -10,7 +10,7 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_kernel
- * @package		xoops_kernel_Logger
+ * @subpackage	xoops_kernel_Logger
  * @version		$Id$
  */
 
@@ -29,6 +29,8 @@
  * <p>This logger only gets activated by default when the kernel runs in DEBUG or DEV mode on.
  * If it is the case, it'll start buffering output to be able toinsert its output inside the page once
  * the request has been processed.</p>
+ * @package		xoops_kernel
+ * @subpackage	xoops_kernel_Logger
  */
 class xoops_kernel_Logger {
 	/**

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/module.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/module.php	2006-02-13 03:13:43 UTC (rev 224)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/module.php	2006-02-13 03:14:30 UTC (rev 225)
@@ -10,7 +10,7 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_kernel
- * @package		xoops_kernel_Module
+ * @subpackage	xoops_kernel_Module
  * @version		$Id$
  */
 
@@ -21,13 +21,10 @@
 
 
 /**
-* xoops_kernel_ModuleFactory
-*
-* @author 		Skalpa Keo
-* @package		xoops_kernel
-* @subpackage	xoops_kernel_ModuleFactory
-* @since        2.3.0
-*/
+ * Local factory in charge of modules instanciation
+ * @package		xoops_kernel
+ * @subpackage	xoops_kernel_Module
+ */
 class xoops_kernel_ModuleFactory {
 	/**
 	 * Instanciate the specified module
@@ -71,7 +68,10 @@
 
 
 /**
- * xoops_kernel_Module base class
+ * Base class for XOOPS modules (applications)
+ * @category	XoopsOS
+ * @package		xoops_kernel
+ * @subpackage	xoops_kernel_Module
  */
 class xoops_kernel_Module {
 	
@@ -105,13 +105,13 @@
 	
 	function requestParameters( $source = 'R' ) {
 		$loc =& $this->moduleLocations[ $this->currentLocation ];
-		return isset( $loc['parameters'] ) ? $this->requestValues( $loc['parameters'], $source ) : array();
+		return isset( $loc['parameters'] ) ? xoops_kernel_Module::requestValues( $loc['parameters'], $source ) : array();
 	}
 	
 	function requestValues( $defs, $source = 'R' ) {
 		$vars = array();
 		foreach ( $defs as $varName => $varDef ) {
-			$vars[ $varName ] = $this->requestValue( $varName, $varDef[0], $varDef[1], $source );
+			$vars[ $varName ] = xoops_kernel_Module::requestValue( $varName, $varDef[0], $varDef[1], $source );
 		}
 		return $vars;
 	}
@@ -137,15 +137,19 @@
 					$value = array($value);
 				}
 				foreach ( $value as $k => $v ) {
-					$value[$k] = $this->sanitizeValue( $v, $type xor XO_TYPE_ARRAY );
+					$value[$k] = xoops_kernel_Module::sanitizeValue( $v, $type xor XO_TYPE_ARRAY );
 				}
 			} else {
-				$value = $this->sanitizeValue( $value, $type );
+				$value = xoops_kernel_Module::sanitizeValue( $value, $type );
 			}
 		}
 		return $value;
 	}
 
+
+	
+	
+	
 	function sanitizeValue( $value, $type = XO_TYPE_INT ) {
 		if ( ( $type & XO_TYPE_STRING ) && $this->isGpc ) {
 			$value = stripslashes( $value );

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/user.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/user.php	2006-02-13 03:13:43 UTC (rev 224)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm/user.php	2006-02-13 03:14:30 UTC (rev 225)
@@ -1,13 +1,32 @@
 <?php
+/**
+ * xoops_kernel_User main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_kernel
+ * @subpackage	xoops_kernel_User
+ * @version		$Id$
+ */
 
 
+/**This user account has been disabled*/
 define( 'XO_LEVEL_DISABLED', -1 );
 define( 'XO_LEVEL_ANONYMOUS', 0 );
 define( 'XO_LEVEL_INACTIVE', 1 );
 define( 'XO_LEVEL_REGISTERED', 2 );
 define( 'XO_LEVEL_ADMIN', 256 );
 
-
+/**
+ * Base class for system users
+ * @package		xoops_kernel
+ * @subpackage	xoops_kernel_User
+ */
 class xoops_kernel_User {
 	
 	var $userId = 0;
@@ -25,6 +44,4 @@
 }
 
 
-
-
 ?>
\ No newline at end of file



From skalpa at berlios.de  Mon Feb 13 04:18:58 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:18:58 +0100
Subject: [Xoops4-svn] r226 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm: . http.xoobj session.xoobj
Message-ID: <200602130318.k1D3IwWV020270@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:18:45 +0100 (Mon, 13 Feb 2006)
New Revision: 226

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.php
Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/http.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/responses.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/handler-db.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session-custom.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/xo-info.php
Log:
Several documentation fixes, as well as a little refactoring (output caching headers manipulation have been moved where they should be: in the HttpHandler component)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -0,0 +1,66 @@
+<?php
+/**
+ * xoops_http main class definition
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_http
+ * @version		$Id$
+ */
+
+/**
+ * This file cannot be requested directly
+ */
+if ( !defined( 'XOOPS_PATH' ) ) exit();
+
+/**
+ * xoops_http framework static class
+ * @package		xoops_http
+ */
+class xoops_http {
+	/**
+	 * Returns an RFC compliant (RFC822 or RFC850) date string from a timestamp
+	 * @param integer $time Timestamp to format (will default to now)
+	 * @return string
+	 */	
+	function date( $time = null ) {
+        return gmdate(
+        	( ini_get('y2k_compliance') ? 'D, d M Y' : 'l, d-M-y' ) .' H:i:s',
+        	isset($time) ? $time : time()
+        ) . ' GMT';
+    }
+	/**
+	 * Converts a relative URI to an absolute one
+	 * @param string $url URI to convert
+	 * @return string An absolute URI
+	 */
+	function absoluteUrl( $url ) {
+		global $xoops;
+
+		if ( strpos( $url, '://' ) === false ) {
+			$host = 'http' . ( $xoops->isSecure ? 's' : '' ) . '://' . $xoops->hostName;
+			if ( !strlen($url) ) {
+	            $url = $_SERVER['REQUEST_URI'];
+        	} elseif ( substr( $url, 0, 1 ) == '/' ) {
+	            return $host . $url;
+        	}
+        	// Check for PATH_INFO
+        	if (isset($_SERVER['PATH_INFO']) && $_SERVER['PHP_SELF'] != $_SERVER['PATH_INFO']) {
+            	$path = dirname(substr($_SERVER['PHP_SELF'], 0, -strlen($_SERVER['PATH_INFO'])));
+        	} else {
+            	$path = dirname($_SERVER['PHP_SELF']);
+        	}
+        	if (substr($path = strtr($path, '\\', '/'), -1) != '/') {
+            	$path .= '/';
+        	}
+			$url = $host . $path . $url;
+		}
+		return $url;
+	}
+}
+


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/http.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/http.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/http.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -1,37 +1,80 @@
 <?php
 /**
-* xoops_http_HttpHandler component main class definition
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @subpackage	xoops_http_HttpHandler
-* @version		$Id$
-*/
+ * xoops_http_HttpHandler component main class definition
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_http
+ * @subpackage	xoops_http_HttpHandler
+ * @version		$Id$
+ */
 
+/**
+ * This file cannot be requested directly
+ */
+if ( !defined( 'XOOPS_PATH' ) ) exit();
 
+XOS::import( 'xoops_http' );
+
 /**
- * xoops_http_HttpHandler component
+ * HTTP response customization component
  *
  * The HttpHandler component encapsulates the HTTP response manipulation functions
  * (redirection for now, and more later on)
+ * @package		xoops_http
+ * @subpackage	xoops_http_HttpHandler
  */
 class xoops_http_HttpHandler {
 	/**
-	* Whether HTTP redirections are enabled or not
-	* @var bool
-	*/
+	 * Whether HTTP redirections are enabled or not
+	 * @var bool
+	 */
 	var $enableRedirections	= true;
 	/**
+	 * Whether to use output compression or not, if the client supports it
+	 */
+	var $enableCompression = true;
+	/**
+	 * Whether to use output compression or not, if the client supports it
+	 */
+	var $compressionLevel = 6;
+	/**
+	 * Cache limiter sent by default to the client
+	 * @var string
+	 */
+	var $cacheLimiter = 'public';
+	/**
+	 * Default client caching lifetime (in seconds)
+	 * @var integer
+	 */
+	var $cacheLifetime = 3600;
+	/**
+	 * Entity mimetype
+	 */
+	var $contentType = 'text/html';
+	/**
+	 * Entity encoding charset
+	 */
+	var $contentEncoding = 'iso-8859-1';
+	/**
+	 * Response entity ETag value
+	 */
+	var $entityTag = '';
+	/**
+	 * Entity last modification date (defaults to now)
+	 */
+	var $lastModified = 0;
+	
+	/**
 	* How many seconds the fake redirection page should be shown
 	* @var integer
 	*/
-	var $fakeRedirectPageDelay = 3;
+	var $fakeRedirectDelay = 3;
 
 	/**
 	 * Fake redirection page content template
@@ -45,11 +88,12 @@
 	 *
 	 * @var string
 	 */
-	var $fakeRedirectTemplate = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
+	var $fakeRedirectTemplate = '
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml">	
 <head>{refresh}</head>
 <body>
-	<div style="text-align:center; background-color: #EBEBEB; border-top: 1px solid #FFFFFF; border-left: 1px solid #FFFFFF; border-right: 1px solid #AAAAAA; border-bottom: 1px solid #AAAAAA; font-weight : bold;">
+	<div style="text-align:center; background-color:#EBEBEB; border:1px solid #AAAAAA; font-weight:bold;">
 		<h4>{message}</h4><p>{ifnotreload}</p>
 	</div>
 	<!--{xo-logger-output}-->
@@ -67,49 +111,136 @@
 
 
 	function xoInit( $options = array() ) {
-		if ( !empty( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] ) ) {
-			foreach ( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] as $k => $v ) {
-				$_SERVER[ 'REDIRECT_' . $k ] = $v;
+		header( 'X-Powered-By: ' . $GLOBALS['xoops']->xoShortVersionString, false );
+		header( 'X-Powered-By: The noosphere', false );
+		
+		if ( $this->enableCompression && extension_loaded( 'zlib' ) ) {
+			if ( $this->compressionLevel ) {
+				ini_set( 'zlib.compression_level', $this->compressionLevel );
 			}
-			//var_export( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] );
-			unset( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] );
-			$this->redirectMessage = $_SERVER['REDIRECT_ERROR_NOTES'];
+			ob_start( 'ob_gzhandler' );
 		}
-		if ( @$_SESSION[$this->xoBundleIdentifier]['tmpDisallowRedirections'] ) {
-			$this->enableRedirections = false;
+		if ( !$this->lastModified ) {
+			$this->lastModified = time();
 		}
-		header( 'X-Powered-By: ' . $GLOBALS['xoops']->xoShortVersionString, false );
-		header( 'X-Powered-By: The noosphere', false );
+		$this->entityTag = $_SERVER['REQUEST_URI'];
+		
+		$this->setCachingPolicy();
+		$this->setEntityInfo();
 		return true;
 	}
 
 	/**
-	 * Convert a relative URI to an absolute one
+	 * Reload the redirection information from the session
 	 */
-	function absoluteUrl( $url ) {
-		global $xoops;
-
-		if ( strpos( $url, '://' ) === false ) {
-			$host = 'http' . ( $xoops->isSecure ? 's' : '' ) . '://' . $xoops->hostName;
-			if ( !strlen($url) ) {
-	            $url = $_SERVER['REQUEST_URI'];
-        	} elseif ( substr( $url, 0, 1 ) == '/' ) {
-	            return $host . $url;
-        	}
-        	// Check for PATH_INFO
-        	if (isset($_SERVER['PATH_INFO']) && $_SERVER['PHP_SELF'] != $_SERVER['PATH_INFO']) {
-            	$path = dirname(substr($_SERVER['PHP_SELF'], 0, -strlen($_SERVER['PATH_INFO'])));
-        	} else {
-            	$path = dirname($_SERVER['PHP_SELF']);
-        	}
-        	if (substr($path = strtr($path, '\\', '/'), -1) != '/') {
-            	$path .= '/';
-        	}
-			$url = $host . $path . $url;
+	function reloadSessionState() {
+		@$state =& $_SESSION[$this->xoBundleIdentifier];
+		if ( $state ) {
+			if ( @$state['tmpDisallowRedirections'] ) {
+				$this->enableRedirections = false;
+			}
+			if ( !empty( $state['redirect_info'] ) ) {
+				foreach ( $state['redirect_info'] as $k => $v ) {
+					$_SERVER[ 'REDIRECT_' . $k ] = $v;
+				}
+				unset( $state['redirect_info'] );
+				$this->redirectMessage = $_SERVER['REDIRECT_ERROR_NOTES'];
+			}
 		}
-		return $url;
 	}
 	/**
+	 * Set/sends the output caching headers
+	 */
+	function setCachingPolicy( $limiter = null, $lifetime = null ) {
+		if ( isset($limiter) ) {
+			$this->cacheLimiter = $limiter;
+		}
+		if ( isset($lifetime) ) {
+			$this->cacheLifetime = $lifetime;
+		}
+		switch ( $this->cacheLimiter ) {
+		case 'none':
+			break;
+		case 'no-cache':
+		case 'nocache':
+			header( 'Expires: ' . xoops_http::date( time() - 3600 ) );
+			header( 'Cache-control: no-store,no-cache,must-revalidate,post-check=0,pre-check=0' );
+			break;
+		case 'private':
+			header( 'Expires: ' . xoops_http::date( time() - 3600 ) );
+		case 'private_no_expire':
+			header( "Cache-control: private,max-age=$this->cacheLifetime,pre-check=$this->cacheLifetime" );
+			break;
+		case 'public':
+		default:
+			header( 'Expires: ' . xoops_http::date( time() + $this->cacheLifetime ) );
+			header( "Cache-control: public,max-age=$this->cacheLifetime" );
+			//header( "Last-Modified: " . xoops_http::date( $this->lastModified ) );
+			break;
+		}
+	}
+	/**
+	 * Set/sends the entity information headers (content-type,encoding and last-mod date)
+	 *
+	 * @param string $mime Mimetype of the entity
+	 * @param string $encoding Charset of the entity
+	 */
+	function setEntityInfo( $mime = null, $charset = null, $lastMod = null ) {
+		if ( isset($mime) ) {
+			$this->contentType = $mime;
+		}
+		if ( isset($charset) ) {
+			$this->contentEncoding = $charset;
+		}
+		if ( isset($lastMod) ) {
+			$this->lastModified = $lastMod;
+		}
+		header( "Content-Type: $this->contentType; charset=$this->contentEncoding" );
+		header( "Last-Modified: " . xoops_http::date( $this->lastModified ) );
+	}
+	
+	/**
+	 * Send the specified file content to the browser
+	 *
+	 * @param unknown_type $filename
+	 * @param unknown_type $disposition
+	 * @param unknown_type $data
+	 * @param unknown_type $size
+	 */
+	function sendFileEntity( $filename, $disposition = 'inline', $data = null, $size = 0 ) {
+		if ( !isset($data) ) {
+			$data = file_get_contents( $filename );
+		}
+		if ( !$size ) {
+			$size = strlen( $data );
+		}
+		if ( false !== ( $pos = strrpos( $filename, '/' ) ) ) {
+			$filename = substr( $filename, $pos + 1 );
+		}
+		header( "Content-disposition: $disposition; filename=\"$filename\"" );
+		header( "Content-length: $size" );
+		if ( $disposition != 'inline' ) {
+			// If the file is sent as an attachment, send caching headers so MSIE can correctly access the file
+			header( 'Cache-control: cache,must-revalidate' );
+		}
+		echo $data;
+	}
+	
+	
+	function addVariation( $key, $value ) {
+		header( 'Vary: ' . ( substr($key,0,3) == 'xo-' ? '*' : $key ), false );
+		$this->entityTag .= '-' . $key . '=' . $value;
+		header( 'ETag: "' . md5($this->entityTag) . '"' );
+	}
+	
+	
+	
+	
+	
+	
+	
+	
+	/**
 	 * Set/send the response status and redirection location
 	 * 
 	 * This set the status response headers, and optionally redirect the client to the 
@@ -143,7 +274,7 @@
         		$location = $xoops->url( '/www/' );
     		}
     		if ( !strpos( $location, '://' ) ) {
-				$location = $this->absoluteUrl( $location );
+				$location = xoops_http::absoluteUrl( $location );
     		}
 		}
 		if ( !$xoops->isVirtual ) {

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/responses.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/responses.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/responses.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -1,19 +1,21 @@
 <?php
 /**
-* xoops_http response codes definition file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @version		$Id$
-*/
+ * xoops_http response codes definition file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_http
+ * @subpackage	xoops_http_HttpHandler
+ * @version		$Id$
+ */
 
-define( 'HTTP_STATUS_OK',			200 );		// The client's request was successful, and the server's response contains the requested data.
+/**The client's request was successful, and the server's response contains the requested data.*/
+define( 'HTTP_STATUS_OK',			200 );
 define( 'HTTP_STATUS_CREATED',		201 );		// This status code is used whenever a new URL is created. With this result code, the Location header is given by the server to specify where the new data was placed.
 define( 'HTTP_STATUS_ACCEPTED',		202 );		// The request was accepted but not immediately acted upon. More information about the transaction may be given in the entity-body of the server's response. There is no guarantee that the server will actually honor the request, even though it may seem like a legitimate request at the time of acceptance.
 define( 'HTTP_STATUS_NONAUTH',		203 );		// The information in the entity header is from a local or third-party copy, not from the original server.
@@ -60,5 +62,4 @@
 
 
 
-
 ?>
\ No newline at end of file

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/xo-info.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/xo-info.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -1,17 +1,18 @@
 <?php
 /**
-* xoops_http framework bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @version		$Id$
-*/
+ * xoops_http_HttpHandler component bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_http
+ * @subpackage	xoops_http_HttpHandler
+ * @version		$Id$
+ */
 
 // xoBundleVersion: x.y.zRn  with R=release type (a:cvs snapshot, b:alpha, c:beta, d: RC, e: final)
 // We must be able to compare versions by comparing this string

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/handler-db.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/handler-db.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/handler-db.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -11,12 +11,14 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  * @since		2.3.0
  * @package		xoops_http
- * @package		xoops_http_Session
+ * @subpackage	xoops_http_Session
  * @version		$Id$
  */
 
 /**
- * Handler for a session
+ * Session handler saving data in the database
+ * @package		xoops_http
+ * @subpackage	xoops_http_Session
  */
 class xoops_http_DatabaseSessionHandler {
 

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session-custom.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session-custom.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session-custom.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -29,8 +29,7 @@
 define( 'XO_SID_USE_ANY', 3 );
 
 /**
- * xoops_http_CustomSessionService main class
- * @since		2.3
+ * Fully configurable session service
  * @package		xoops_http
  * @subpackage	xoops_http_Session
  */

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -19,21 +19,30 @@
  */
 if ( !defined( 'XOOPS_PATH' ) ) exit();
 
+XOS::import( 'xoops_http' );
+
 /**
- * xoops_http_SessionService main class
+ * Basic session service
  * 
  * The default session service provides basic session management functionality.
  * It uses the settings defined in the PHP configuration files, and thus is not really
- * user-configurable (you must use xoops_http_CustomSessionService for that).
+ * user-configurable (you must use {@link xoops_http_CustomSessionService} for that).
  * 
  * Only cache limiting has been enhanced: this component allows to configure this setting
  * on a user basis (if the 'cacheLimiter' variable is stored in the session, it will be used)
+ * @package		xoops_http
+ * @subpackage	xoops_http_Session
  */
 class xoops_http_SessionService {
 	/**
-	* Save handler to use for reading/writing session data
-	* @var mixed
-	*/
+	 * If sessions are created for unauthenticated users
+	 * @var boolean
+	 */
+	var $createGuestSessions = false;
+	/**
+	 * Save handler to use for reading/writing session data
+	 * @var object [xoops_http/xoops_http_Session/xoops_http_SessionHandler]
+	 */
 	var $saveHandler = 'xoops_http_DatabaseSessionHandler';
 	/**
 	 * Identifier of the current session
@@ -41,16 +50,29 @@
 	 */
 	var $sessionId = 0;
 	/**
+	 * Name of the cookie used to store the session identifier
+	 * @var string
+	 */
+	var $sessionName = '';
+
+	/**#@+
+	 * @vargroup 20 Client caching
+	 */
+	/**
 	 * Default cache limiting policy (if different from the one defined in php.ini
 	 * @var string
 	 */
-	var $cacheLimiter = '';
+	var $cacheLimiter = 'private_no_expire';
 	/**
-	* If sessions are created for unauthenticated visitors
-	* @var boolean
-	*/
-	var $createGuestSessions = false;
+	 * Default cache lifetime for content (in minutes)
+	 * @var integer
+	 */
+	var $cacheLifetime = 60;
+	/**#@-*/
 	
+	/**#@+
+	 * @tasktype 10 Initialization
+	 */
 	/**
 	* Initialize the session service
 	*/
@@ -58,7 +80,11 @@
 		if ( $this->saveHandler && !$this->attachHandler( $this->saveHandler ) ) {
 			return false;
 		}
-		if ( isset( $_COOKIE[ session_name() ] ) || $this->createGuestSessions ) {
+		if ( !$this->sessionName ) {
+			$this->sessionName = session_name();
+		}
+		// Create the session
+		if ( isset( $_COOKIE[$this->sessionName] ) || $this->createGuestSessions ) {
 			$this->start();
 		}
 	 	return true;
@@ -67,7 +93,7 @@
 	 * Initialize the specified object as a save handler
 	 *
 	 * @param mixed $handler Object to attach (or bundleIdentifier of the handler to instanciate)
-	 * @return boolean true on success, false otherwise
+	 * @return bool True on success, false otherwise
 	 */
 	function attachHandler( $handler ) {
 		if ( !is_object( $handler ) ) {
@@ -84,11 +110,16 @@
 		$this->saveHandler =& $handler;
 		return true;
 	}
+	/**#@-*/
 	
+	/**#@+
+	 * @tasktype 20 Creating and destroying the session
+	 */
 	/**
-	* Create a new session
-	*/
+	 * Creates a new session
+	 */
 	function start() {
+		global $xoops;
 		if ( isset($_SESSION) ) {
 		  	return true;
 		}
@@ -105,20 +136,29 @@
 		//if ( @$var = $this->getObjectVar( $this, 'cacheLimiter' ) ) {
 		//	$this->cacheLimiter = $var;
 		//}
-		$this->resetCacheLimiting( $this->cacheLimiter, 60 * session_cache_expire() );
+		$xoops->services['http']->setCachingPolicy( $this->cacheLimiter, $this->cacheLifetime );
 		return $this->sessionId;
 	}
 	/**
-	* Destroy the current session
+	* Destroys the current session
 	*/
 	function destroy() {
 		$_SESSION = array();
 		unset( $_COOKIE[ session_name() ] );
 		session_destroy();
 	}
+	/**#@-*/
+	
+	/**#@+
+	 * @tasktype 30 Getting and setting session variables
+	 */
 	/**
-	* Set a named session variable
-	*/
+	 * Adds, modifies or removes an object session variable
+	 * @param mixed $owner Instance or bundle identifier of the object whose variable you wish to set
+	 * @param string $key The key whose value you wish to modify or remove
+	 * @param mixed $value The value to set for the specified key and object. Pass NULL to remove the specified key from the session
+	 * @return mixed The just set value
+	 */
 	function setObjectVar( $owner, $key, $value ) {
 		if ( !isset($_SESSION) ) {
 			return null;
@@ -126,58 +166,34 @@
 		if ( is_object($owner) ) {
 			$owner = $owner->xoBundleIdentifier;
 		}
+		if ( !isset($value) ) {
+			unset($_SESSION[$owner][$key]);
+			return $value;
+		}			
 		return $_SESSION[$owner][$key] = $value;
 	}
 	/**
-	* Get the value of a named session variable
-	*/
+	 * Obtains the session variable value for the specified key and object
+	 * @param mixed $owner Instance or bundle identifier of the object whose variable you wish to get
+	 * @param string $key The key whose value you wish to obtain
+	 * @return mixed The session variable value
+	 */
 	function getObjectVar( $owner, $key ) {
 		if ( is_object($owner) ) {
 			$owner = $owner->xoBundleIdentifier;
 		}
 		return @$_SESSION[$owner][$key];
 	}
-	/**
-	 * Resend the cache limiting headers
-	 */
-	function resetCacheLimiting( $policy, $cacheLifetime = 0, $lastModified = null ) {
-		if ( !isset( $lastModified ) ) {
-			$lastModified = time();
-		}
-		switch ( $policy ) {
-		case 'none':
-			break;
-		case 'no-cache':
-		case 'nocache':
-			header( 'Expires: ' . $this->date( time() - 3600 ) );
-			header( 'Cache-Control: no-store,no-cache,must-revalidate,post-check=0,pre-check=0' );
-			break;
-		case 'private':
-			header( 'Expires: ' . $this->date( time() - 3600 ) );
-		case 'private_no_expire':
-			header( "Cache-Control: private,max-age=$cacheLifetime,pre-check=$cacheLifetime" );
-			break;
-		case 'public':
-		default:
-			header( 'Expires: ' . $this->date( time() + $cacheLifetime ) );
-			header( "Cache-Control: public,max-age=$cacheLifetime" );
-			header( "Last-Modified: " . $this->date( $lastModified ) );
-			break;
-		}
-	}
-	/**
-	 * Return an RFC compliant (RFC822 or RFC850) date string from a timestamp
-	 *
-	 * @param interger $time
-	 * @return string
-	 */	
-	function date( $time = null ) {
-        return gmdate(
-        	( ini_get('y2k_compliance') ? 'D, d M Y' : 'l, d-M-y' ) .' H:i:s',
-        	isset($time) ? $time : time()
-        ) . ' GMT';
-    }
+	/**#@-*/
+}
 
+/**
+ * Abstract base class for session persistance handlers
+ * @package		xoops_http
+ * @subpackage	xoops_http_Session
+ */
+class xoops_http_SessionHandler {
+	
 }
 
 

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/xo-info.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/xo-info.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -1,18 +1,18 @@
 <?php
 /**
-* xoops_http session component bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @package		xoops_http_Session
-* @version		$Id$
-*/
+ * xoops_http session component bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_http
+ * @subpackage	xoops_http_Session
+ * @version		$Id$
+ */
 
 return array(
 	'xoBundleDisplayName' => 'XOOPS Session management component',

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/xo-info.php	2006-02-13 03:14:30 UTC (rev 225)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/xo-info.php	2006-02-13 03:18:45 UTC (rev 226)
@@ -1,17 +1,17 @@
 <?php
 /**
-* xoops_http framework bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @version		$Id$
-*/
+ * xoops_http framework bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_http
+ * @version		$Id$
+ */
 
 // xoBundleVersion: x.y.zRn  with R=release type (a:cvs snapshot, b:alpha, c:beta, d: RC, e: final)
 // We must be able to compare versions by comparing this string
@@ -19,6 +19,7 @@
 return array(
 	'xoBundleDisplayName'			=> 'Xoops HTTP framework',
 	'xoBundleIdentifier'			=> 'xoops_http',
+	'xoClassPath' => '/http.php',
 
 	'xoServices' => array(
 		'xoops_http_HttpHandler'	=> array ( 'xoBundleRoot' => '/http.xoobj' ),



From skalpa at berlios.de  Mon Feb 13 04:21:03 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:21:03 +0100
Subject: [Xoops4-svn] r227 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation
Message-ID: <200602130321.k1D3L3xM020567@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:20:53 +0100 (Mon, 13 Feb 2006)
New Revision: 227

Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Database.xofrm/
Log:
Moving the db framework to CoreServices/




From skalpa at berlios.de  Mon Feb 13 04:23:08 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:23:08 +0100
Subject: [Xoops4-svn] r228 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices: . Http.xofrm Http.xofrm/http.xoobj Http.xofrm/session.xoobj
Message-ID: <200602130323.k1D3N8oH021086@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:23:01 +0100 (Mon, 13 Feb 2006)
New Revision: 228

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/responses.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/handler-db.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session-custom.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/xo-info.php
Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/responses.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/handler-db.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session-custom.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/xo-info.php
Log:
Moving the HTTP framework to CoreServices/

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm (from rev 217, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm)

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/http.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,196 +0,0 @@
-<?php
-/**
-* xoops_http_HttpHandler component main class definition
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @subpackage	xoops_http_HttpHandler
-* @version		$Id$
-*/
-
-
-/**
- * xoops_http_HttpHandler component
- *
- * The HttpHandler component encapsulates the HTTP response manipulation functions
- * (redirection for now, and more later on)
- */
-class xoops_http_HttpHandler {
-	/**
-	* Whether HTTP redirections are enabled or not
-	* @var bool
-	*/
-	var $enableRedirections	= true;
-	/**
-	* How many seconds the fake redirection page should be shown
-	* @var integer
-	*/
-	var $fakeRedirectPageDelay = 3;
-
-	/**
-	 * Fake redirection page content template
-	 * 
-	 * <p>When HTTP redirections are disabled, this string is returned to the client.</p>
-	 * <p>This page can contain any of the following, and they will be replaced before the page is sent:<br />
-	 * <ul>
-	 * <li>{message}: The redirection message</li>
-	 * <li>{refresh}: A &lt;meta http-equiv="refresh"&gt; tag that ensures client-side redirection is performed</li>
-	 * </ul>
-	 *
-	 * @var string
-	 */
-	var $fakeRedirectTemplate = '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
-<html xmlns="http://www.w3.org/1999/xhtml">	
-<head>{refresh}</head>
-<body>
-	<div style="text-align:center; background-color: #EBEBEB; border-top: 1px solid #FFFFFF; border-left: 1px solid #FFFFFF; border-right: 1px solid #AAAAAA; border-bottom: 1px solid #AAAAAA; font-weight : bold;">
-		<h4>{message}</h4><p>{ifnotreload}</p>
-	</div>
-	<!--{xo-logger-output}-->
-</body></html>';
-	/**
-	* Location of the default error pages (unimplemented)
-	* @var string
-	*/
-	var $defaultErrorPages = false;
-	/**
-	* Redirection message sent by the last page
-	* @var string
-	*/
-	var $redirectMessage = '';
-
-
-	function xoInit( $options = array() ) {
-		if ( !empty( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] ) ) {
-			foreach ( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] as $k => $v ) {
-				$_SERVER[ 'REDIRECT_' . $k ] = $v;
-			}
-			//var_export( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] );
-			unset( $_SESSION[$this->xoBundleIdentifier]['redirect_info'] );
-			$this->redirectMessage = $_SERVER['REDIRECT_ERROR_NOTES'];
-		}
-		if ( @$_SESSION[$this->xoBundleIdentifier]['tmpDisallowRedirections'] ) {
-			$this->enableRedirections = false;
-		}
-		header( 'X-Powered-By: ' . $GLOBALS['xoops']->xoShortVersionString, false );
-		header( 'X-Powered-By: The noosphere', false );
-		return true;
-	}
-
-	/**
-	 * Convert a relative URI to an absolute one
-	 */
-	function absoluteUrl( $url ) {
-		global $xoops;
-
-		if ( strpos( $url, '://' ) === false ) {
-			$host = 'http' . ( $xoops->isSecure ? 's' : '' ) . '://' . $xoops->hostName;
-			if ( !strlen($url) ) {
-	            $url = $_SERVER['REQUEST_URI'];
-        	} elseif ( substr( $url, 0, 1 ) == '/' ) {
-	            return $host . $url;
-        	}
-        	// Check for PATH_INFO
-        	if (isset($_SERVER['PATH_INFO']) && $_SERVER['PHP_SELF'] != $_SERVER['PATH_INFO']) {
-            	$path = dirname(substr($_SERVER['PHP_SELF'], 0, -strlen($_SERVER['PATH_INFO'])));
-        	} else {
-            	$path = dirname($_SERVER['PHP_SELF']);
-        	}
-        	if (substr($path = strtr($path, '\\', '/'), -1) != '/') {
-            	$path .= '/';
-        	}
-			$url = $host . $path . $url;
-		}
-		return $url;
-	}
-	/**
-	 * Set/send the response status and redirection location
-	 * 
-	 * This set the status response headers, and optionally redirect the client to the 
-	 * specified location.
-	 * The way the redirection is performed depends on the value of the $enableRedirections property:
-	 * if true, a Location: header is sent
-	 * if false, a custom html page containing a refresh &lt;meta&gt; tag will be displayed to perform client-side
-	 * redirection
-	 * 
-	 * @param int $status The HTTP status code to send to the client
-	 * @param string $message The HTTP status message to send to the client
-	 * @param string $location Location to redirect the client to
-	 */
-	function sendResponse( $status = null, $message = '', $location = '' ) {
-		global $xoops;
-
- 	 	if ( is_array($status) ) {
-	 		list( $status, $message, $location ) = $status;
-		}
-		if ( empty($status) ) {
-			$status = 200;			// HTTP_STATUS_OK
-		}
-		/* if ( empty($location) && isset($this->errorPages[$status]) ) {
-			$location = $this->errorPages[$status];
-		} */
-		if ( $location == -1 ) {
-			$location = !@empty( $_SERVER['HTTP_REFERER'] ) ? $_SERVER['HTTP_REFERER'] : $xoops->url( '/www/' );
-		}
-		if ( !empty($location) ) {
-		    if ( preg_match( "/[\\0-\\31]|about:|script:/i", $location ) ) {
-        		$location = $xoops->url( '/www/' );
-    		}
-    		if ( !strpos( $location, '://' ) ) {
-				$location = $this->absoluteUrl( $location );
-    		}
-		}
-		if ( !$xoops->isVirtual ) {
-			$this->sendResponseCode( $status, $message );
-			if ( !empty( $location ) ) {
-				if ( $this->enableRedirections ) {
-					$_SESSION[$this->xoBundleIdentifier]['redirect_info'] = array(
-						'STATUS' => $status,
-						'URL' => $_SERVER['REQUEST_URI'],
-						'REQUEST_METHOD' => $_SERVER['REQUEST_METHOD'],
-						'ERROR_NOTES' => $message,
-					);
-					header( "Location: $location" );
-					echo "<body><a href='$location'>Page redirected. Status: $status, $message.</a></body>";
-				} else {
-					//$this->sendResponseCode( 200, $message );
-					$vars = array(
-						'{refresh}' => '<meta http-equiv="refresh" content="' . $this->fakeRedirectPageDelay . '; url=' . htmlspecialchars( $location, ENT_QUOTES ) . '" />',
-						'{message}' => $message,
-						'{ifnotreload}' => sprintf( _IFNOTRELOAD, $location )
-					);
-					echo str_replace( array_keys( $vars ), array_values( $vars ), $this->fakeRedirectTemplate );
-				}
-			}
-		}
-		return array( $status, $message, $location );
-	}
-	/**
-	 * Send the specified response code header to the response
-	 * @param int $status The HTTP status code to send to the client
-	 * @param string $message The HTTP status message to send to the client
-	 * @access protected
-	 */
-	function sendResponseCode( $status = 200, $message = 'OK' ) {
-		if ( !headers_sent() ) {
-			$message = str_replace( array( "\r", "\n" ), '', $message );
-			if ( $pos = strpos( $message, '<' ) ) {
-				$message = substr( $message, 0, $pos );
-			}
-			//header( "Status: $status $message" );
-			header( "HTTP/1.1 $status $message" );
-		}
-	}
-	
-	
-}
-
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/http.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/responses.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/responses.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/responses.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,64 +0,0 @@
-<?php
-/**
-* xoops_http response codes definition file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @version		$Id$
-*/
-
-define( 'HTTP_STATUS_OK',			200 );		// The client's request was successful, and the server's response contains the requested data.
-define( 'HTTP_STATUS_CREATED',		201 );		// This status code is used whenever a new URL is created. With this result code, the Location header is given by the server to specify where the new data was placed.
-define( 'HTTP_STATUS_ACCEPTED',		202 );		// The request was accepted but not immediately acted upon. More information about the transaction may be given in the entity-body of the server's response. There is no guarantee that the server will actually honor the request, even though it may seem like a legitimate request at the time of acceptance.
-define( 'HTTP_STATUS_NONAUTH',		203 );		// The information in the entity header is from a local or third-party copy, not from the original server.
-define( 'HTTP_STATUS_NOCONTENT',	204 );		// A status code and header are given in the response, but there is no entity-body in the reply. Browsers should not update their document view upon receiving this response. This is a useful code for CGI programs to use when they accept data from a form but want the browser view to stay at the form.
-define( 'HTTP_STATUS_RESETCONTENT',	205 );		// The browser should clear the form used for this transaction for additional input. For data-entry CGI applications.
-define( 'HTTP_STATUS_PARTCONTENT',	206 );		// The server is returning partial data of the size requested. Used in response to a request specifying a Range header. The server must specify the range included in the response with the Content-Range header.
-
-define( 'HTTP_STATUS_MOVED',		301 );		// The requested URL is no longer used by the server, and the operation specified in the request was not performed. The new location for the requested document is specified in the Location header. All future requests for the document should use the new URL.
-define( 'HTTP_STATUS_SEEOTHER',		303 );		// The requested URL can be found at a different URL (specified in the Location header) and should be retrieved by a GET on that resource.
-define( 'HTTP_STATUS_NOTMODIFIED',	304 );		// This is the response code to an If-Modified-Since or If-None-Match header, where the URL has not been modified since the specified date. The entity-body is not sent, and the client should use its own local copy.
-define( 'HTTP_STATUS_USEPROXY',		305 );		// The requested URL must be accessed through the proxy in the Location header.
-define( 'HTTP_STATUS_MOVEDTEMP',	307 );		// The requested URL has moved, but only temporarily. The Location header specifies the new location, but no information is given about the validity of the redirect in the future. The client should revisit the original URL in the future.
-
-define( 'HTTP_STATUS_BADREQUEST',	400 );		//This response code indicates that the server detected a syntax error in the client's request.
-define( 'HTTP_STATUS_UNAUTHORIZED',	401 );		// Given along with the WWW-Authenticate header to indicate that the request lacked proper authorization, and the client should supply proper authorization when requesting this URL again. See the description of the Authorization header for more information on how authorization works in HTTP.
-define( 'HTTP_STATUS_NEEDPAYMENT',	402 );		// This code is not yet implemented in HTTP.
-define( 'HTTP_STATUS_FORBIDDEN',	403 );		// The request was denied for a reason the server does not want to (or has no means to) indicate to the client.
-define( 'HTTP_STATUS_NOTFOUND',		404 );		// The document at the specified URL does not exist.
-define( 'HTTP_STATUS_BADMETHOD',	405 );		// This code is given with the Allow header and indicates that the method used by the client is not supported for this URL.
-define( 'HTTP_STATUS_NOTACCEPTABLE',406 );		// The URL specified by the client exists, but not in a format preferred by the client. Along with this code, the server provides the Content-Language, Content-Encoding, and Content-type headers.
-define( 'HTTP_STATUS_TIMEOUT',		408 );		// This response code means the client did not produce a full request within some predetermined time (usually specified in the server's configuration), and the server is disconnecting the network connection.
-define( 'HTTP_STATUS_CONFLICT',		409 );		// This code indicates that the request conflicts with another request or with the server's configuration. Information about the conflict should be returned in the data portion of the reply. For example, this response code could be given when a client's request would cause integrity problems in a database.
-define( 'HTTP_STATUS_GONE',			410 );		// This code indicates that the requested URL no longer exists and has been permanently removed from the server.
-
-define( 'HTTP_STATUS_SERVERERROR',		500 );		// A part of the server (for example, a CGI program) has crashed or encountered a configuration error.
-define( 'HTTP_STATUS_NOTIMPLEMENTED',	501 );		// The client requested an action that cannot be performed by the server.
-define( 'HTTP_STATUS_SERVICEUNAVAIL',	503 );		// The service is temporarily unavailable, but should be restored in the future. If the server knows when it will be available again, a Retry-After header may also be supplied.
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/responses.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/responses.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/xo-info.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,25 +0,0 @@
-<?php
-/**
-* xoops_http framework bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @version		$Id$
-*/
-
-// xoBundleVersion: x.y.zRn  with R=release type (a:cvs snapshot, b:alpha, c:beta, d: RC, e: final)
-// We must be able to compare versions by comparing this string
-
-return array(
-	'xoBundleDisplayName' => 'XOOPS HTTP handler',
-	'xoBundleIdentifier' => 'xoops_http_HttpHandler',
-	'xoClassPath' => '/http.php',
-);
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/xo-info.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/http.xoobj/xo-info.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/handler-db.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/handler-db.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/handler-db.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,119 +0,0 @@
-<?php
-/**
- * xoops_http_DatabaseSessionHandler main class file
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
- *
- * @copyright	The XOOPS project http://www.xoops.org/
- * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
- * @author		Kazumi Ono	<onokazu at xoops.org>
- * @author		Skalpa Keo <skalpa at xoops.org>
- * @since		2.3.0
- * @package		xoops_http
- * @package		xoops_http_Session
- * @version		$Id$
- */
-
-/**
- * Handler for a session
- */
-class xoops_http_DatabaseSessionHandler {
-
-	var $tableName = 'session';
-
-     /**
-      * Database connection object
-      *
-      * @var	object
-      * @access	protected
-      */
-    var $db;
-
-    function xoInit( $options = array() ) {
-    	global $xoops;
-    	//( 'xoops_db_LegacyDatabase' );
-    	if ( !$this->db =& $xoops->loadService( 'legacydb' ) ) {
-    		return false;
-    	}
-    	$this->tableName =& $this->db->prefix( $this->tableName );
-    	return true;
-    }
-    
-    /**
-     * Open a session
-     * @return	bool
-     */
-    function open($save_path, $session_name) {
-        return true;
-    }
-    /**
-     * Close a session
-     * 
-     * @return	bool
-     */
-    function close() {
-        return true;
-    }
-    /**
-     * Read a session from the database
-     *
-     * @param	string  &sess_id    ID of the session
-     *
-     * @return	array   Session data
-     */
-    function read( $sessionId ) {
-    	$sessionId = $this->db->quote( $sessionId );
-    	$res = $this->db->query(  "SELECT `sess_data` FROM `$this->tableName` WHERE `sess_id`=$sessionId" );
-    	if ( $res ) {
-            list( $data ) = $this->db->fetchRow( $res );
-            return $data;
-        }
-        return '';
-    }
-    /**
-     * Write a session to the database
-     *
-     * @param   string  $sess_id
-     * @param   string  $sess_data
-     *
-     * @return  bool
-     **/
-    function write( $sessionId, $data ) {
-    	$sessionId = $this->db->quote( $sessionId );
-		$data = $this->db->quote( $data );
-		$time = time();
-    	
-    	list( $count ) = $this->db->fetchRow( $this->db->query( "SELECT COUNT(*) FROM `$this->tableName` WHERE sess_id=$sessionId" ) );
- 	
-    	if ( $count > 0 ) {
-			$sql = "UPDATE `$this->tableName` SET sess_updated=$time,sess_data=$data WHERE sess_id=$sessionId";
-    	} else {
-    		$ip = $this->db->quote( $_SERVER['REMOTE_ADDR'] );
-    		$sql = "INSERT INTO `$this->tableName` (sess_id,sess_updated,sess_ip,sess_data) VALUES ($sessionId,$time,$ip,$data)";
-    	}
-		return $this->db->queryF( $sql );
-    }
-    /**
-     * Destroy a session
-     *
-     * @param   string  $sess_id
-     *
-     * @return  bool
-     **/
-    function destroy( $sessionId ) {
-    	$sessionId = $this->db->quote( $sessionId );
-    	return $this->db->queryF( "DELETE FROM `$this->tableName` WHERE sess_id=$sessionId" );
-    }
-    /**
-     * Garbage Collector
-     *
-     * @param   int $expire Time in seconds until a session expires
-	 * @return  bool
-     **/
-    function gc( $expire ) {
-        $time = time() - intval($expire);
-        return $this->db->queryF( "DELETE FROM `$this->tableName` WHERE sess_updated < $time" );
-    }
-}
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/handler-db.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/handler-db.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session-custom.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session-custom.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session-custom.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,206 +0,0 @@
-<?php
-/**
- * xoops_http_CustomSessionService main class file
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
- *
- * @copyright	The Xoops project http://www.xoops.org/
- * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
- * @author		Skalpa Keo <skalpa at xoops.org>
- * @since		2.3
- * @package		xoops_http
- * @subpackage	xoops_http_Session
- * @version		$Id$
- */
-
-/**
- * This file cannot be requested directly
- */
-if ( !defined( 'XOOPS_PATH' ) ) exit();
-
-XOS::import( 'xoops_http_SessionService' );
-
-/**Only use cookies to propagate session ID*/
-define( 'XO_SID_USE_COOKIE', 1 );
-/**Only use URI to propagate session ID*/
-define( 'XO_SID_USE_URI', 2 );
-/**Try cookie and fall back to query string if not supported by the user agent*/
-define( 'XO_SID_USE_ANY', 3 );
-
-/**
- * xoops_http_CustomSessionService main class
- * @since		2.3
- * @package		xoops_http
- * @subpackage	xoops_http_Session
- */
-class xoops_http_CustomSessionService extends xoops_http_SessionService {
-
-	// ---------- Session ID options ----------
-	/**
-	 * Server variables used to compute the session id (comma separated)  i.e: USER_AGENT,REMOTE_ADDR
-	 * @var string
-	 */
-	var $hashVars		= '';
-	/**
-	 * Hash algorithm used to generate the session IDs. '0' means MD5 (128 bits) and '1' means SHA-1 (160 bits)
-	 * @var integer
-	 */
-	var $hashFunction	= 0;
-	/**
-	 * Define how many bits are stored in each character when converting the binary hash data to something readable.
-	 *
-	 * The possible values are '4' (0-9, a-f), '5' (0-9, a-v), and '6' (0-9, a-z, A-Z, "-", ",")
-	 * @var integer
-	 */
-	var $hashBitsPerCharacter = 4;
-	/**
-	 * Policy for session ID propagation
-	 * @var integer
-	 */
-	var $sidPolicy = XO_SID_USE_COOKIE;
-
-	// ---------- Session cookie options (for cookie SID propagation) ----------
-	/**
-	 * Name of the cookie used to store the session identifier
-	 * @var string
-	 */
-	var $cookieName		= 'XOSESSIONID';
-	/**
-	 * Maximum allowed duration of a session (if set to 0: until the user closes its browser)
-	 *
-	 * Setting the cookie lifetime allows you to specify a maximum duration for your users sessions. This will make
-	 * a session automatically expire after a specific time, even if its owner is still active (to remove sessions
-	 * after inactivity, see garbage collection properties).
-	 * @var integer
-	 */
-	var $cookieLifetime	= 0;
-	/**
-	 * Domain of the cookie
-	 * @var string
-	 */
-	var $cookieDomain	= '';
-	/**
-	 * Path of the cookie
-	 * @var string
-	 */
-	var $cookiePath		= '/';
-
-	// ---------- Transparent SID options (for URI SID propagation) ----------
-	/**
-	 * Whether to enable transparent session id management if necessary (only applicable if sidPolicy allows the use of URI for SID propagation)
-	 * @var string
-	 */
-	var $useTransparentSid = true;
-	/**
-	 * Tags that need rewriting by transparent sid
-	 * @var string
-	 */
-	var $urlRewriterTags	= 'a=href,area=href,frame=src,iframe=src,input=src,form=,fieldset=';
-	/**
-	 * String used as parameters separator in rewritting tags
-	 * @var string
-	 */
-	var $outputArgSeparator = '&amp;';
-
-	// ---------- Garbage collection option ----------
-	/**
-	 * Numbers of seconds of inactivity after which the session is considered invalid
-	 * 
-	 * Defaults to 15 minutes
-	 * @var integer
-	 */
-	var $gcMaxlifetime	= 900;
-	/**
-	 * Probability of execution of the garbage collection routine
-	 * @var integer
-	 */
-	var $gcProbability	= 1;
-	/**
-	 * Divisor used to calculate the probability of execution of the garbage collection routine
-	 * @var integer
-	 */
-	var $gcDivisor		= 100;
-
-	// ---------- Content caching ----------
-	/**
-	 * Default cache lifetime for content (in minutes)
-	 * @var integer
-	 */
-	var $cacheLimiter = 'private_no_expire';
-	/**
-	 * Default cache lifetime for content (in minutes)
-	 * @var integer
-	 */
-	var $cacheLifetime = 1;
-	
-	/**
-	 * Property => php.ini setting lookup table
-	 * @var array
-	 * @access private
-	 */
-	var $propertyToPhp = array(
-		'gcMaxlifetime'		=> 'session.gc_maxlifetime',
-		'gcProbability'		=> 'session.gc_probability',
-		'gcDivisor'			=> 'session.gc_divisor',
-		'useTransparentSid'	=> 'session.use_trans_sid',
-		'urlRewriterTags'	=> 'url_rewriter.tags',
-		'outputArgSeparator'=> 'arg_separator.output',
-	);
-	/**
-	* Initialize the session service
-	*/
-	function init( $options = array() ) {
-
-		switch ($this->sidPolicy) {
-		case XO_SID_USE_URI:
-			ini_set( 'session.use_cookies', false );
-			ini_set( 'session.use_only_cookies', false );
-			break;
-		case XO_SID_USE_ANY:
-			ini_set( 'session.use_cookies', true );
-			ini_set( 'session.use_only_cookies', false );
-			break;
-		case XO_SID_USE_COOKIE:
-		default:
-			ini_set( 'session.use_cookies', true );
-			ini_set( 'session.use_only_cookies', true );
-			break;
-		}
-	 	foreach ( $this->propertyToPhp as $prop => $php ) {
-	 		if ( isset($this->$prop ) ) {
-	 			ini_set( $php, $this->$prop );
-	 		}
-	 	}
-
-		if ( $this->sidPolicy & XO_SID_USE_COOKIE ) {
-			if ( isset( $_COOKIE[$this->cookieName] ) ) {
-				$this->sessionId = $_COOKIE[$this->cookieName];
-			}
-			session_set_cookie_params( $this->cookieLifetime, $this->cookiePath, $this->cookieDomain );
-		}
-		session_name( $this->cookieName );
-		session_cache_expire( $this->cacheLifetime );
-
-		return parent::xoInit( $options );
-	}
-	function start() {
-		if ( $id = parent::start() ) {
-			$expire = $this->cookieLifetime ? ( $this->cookieLifetime + time() ) : 0;
-			setcookie( $this->cookieName, $id, $expire, $this->cookiePath, $this->cookieDomain );
-		}
-	}
-	
-	/**
-	 * Destroy the current session
-	 */
-	function destroy() {
-		parent::destroy();
-		if ( $this->sidPolicy & XO_SID_USE_COOKIE ) {
-			setcookie( $this->cookieName, '', time() - 3600, $this->cookiePath, $this->cookieDomain );
-		}
-	}
-}
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session-custom.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session-custom.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,184 +0,0 @@
-<?php
-/**
- * xoops_http_SessionService main class file
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
- *
- * @copyright	The XOOPS project http://www.xoops.org/
- * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
- * @author		Skalpa Keo <skalpa at xoops.org>
- * @since		2.3.0
- * @package		xoops_http
- * @subpackage	xoops_http_Session
- * @version		$Id$
- */
-
-/**
- * This file cannot be requested directly
- */
-if ( !defined( 'XOOPS_PATH' ) ) exit();
-
-/**
- * xoops_http_SessionService main class
- * 
- * The default session service provides basic session management functionality.
- * It uses the settings defined in the PHP configuration files, and thus is not really
- * user-configurable (you must use xoops_http_CustomSessionService for that).
- * 
- * Only cache limiting has been enhanced: this component allows to configure this setting
- * on a user basis (if the 'cacheLimiter' variable is stored in the session, it will be used)
- */
-class xoops_http_SessionService {
-	/**
-	* Save handler to use for reading/writing session data
-	* @var mixed
-	*/
-	var $saveHandler = 'xoops_http_DatabaseSessionHandler';
-	/**
-	 * Identifier of the current session
-	 * @var string
-	 */
-	var $sessionId = 0;
-	/**
-	 * Default cache limiting policy (if different from the one defined in php.ini
-	 * @var string
-	 */
-	var $cacheLimiter = '';
-	/**
-	* If sessions are created for unauthenticated visitors
-	* @var boolean
-	*/
-	var $createGuestSessions = false;
-	
-	/**
-	* Initialize the session service
-	*/
-	function xoInit( $options = array() ) {
-		if ( $this->saveHandler && !$this->attachHandler( $this->saveHandler ) ) {
-			return false;
-		}
-		if ( isset( $_COOKIE[ session_name() ] ) || $this->createGuestSessions ) {
-			$this->start();
-		}
-	 	return true;
-	}
-	/**
-	 * Initialize the specified object as a save handler
-	 *
-	 * @param mixed $handler Object to attach (or bundleIdentifier of the handler to instanciate)
-	 * @return boolean true on success, false otherwise
-	 */
-	function attachHandler( $handler ) {
-		if ( !is_object( $handler ) ) {
-			if ( ! ( $handler = XOS::create( $handler ) ) ) {
-				trigger_error( "Failed to initialize the session save handler.", E_USER_WARNING );
-				return false;
-			}
-		}
-    	session_set_save_handler(
-    		array( &$handler, 'open' ), array( &$handler, 'close'),
-    		array( &$handler, 'read'), array( &$handler, 'write'),
-    		array( &$handler, 'destroy'), array( &$handler, 'gc')
-    	);
-		$this->saveHandler =& $handler;
-		return true;
-	}
-	
-	/**
-	* Create a new session
-	*/
-	function start() {
-		if ( isset($_SESSION) ) {
-		  	return true;
-		}
-		if ( !empty($this->sessionId) ) {
-			session_id( $this->sessionId );
-		}
-		if ( !$this->cacheLimiter ) {
-			$this->cacheLimiter = session_cache_limiter();
-		}
-		session_cache_limiter( 'none' );
-		@session_start();
-		$this->sessionId = session_id();
-		// Do this here to allow user-dependent cacheLimiter setting
-		//if ( @$var = $this->getObjectVar( $this, 'cacheLimiter' ) ) {
-		//	$this->cacheLimiter = $var;
-		//}
-		$this->resetCacheLimiting( $this->cacheLimiter, 60 * session_cache_expire() );
-		return $this->sessionId;
-	}
-	/**
-	* Destroy the current session
-	*/
-	function destroy() {
-		$_SESSION = array();
-		unset( $_COOKIE[ session_name() ] );
-		session_destroy();
-	}
-	/**
-	* Set a named session variable
-	*/
-	function setObjectVar( $owner, $key, $value ) {
-		if ( !isset($_SESSION) ) {
-			return null;
-		}
-		if ( is_object($owner) ) {
-			$owner = $owner->xoBundleIdentifier;
-		}
-		return $_SESSION[$owner][$key] = $value;
-	}
-	/**
-	* Get the value of a named session variable
-	*/
-	function getObjectVar( $owner, $key ) {
-		if ( is_object($owner) ) {
-			$owner = $owner->xoBundleIdentifier;
-		}
-		return @$_SESSION[$owner][$key];
-	}
-	/**
-	 * Resend the cache limiting headers
-	 */
-	function resetCacheLimiting( $policy, $cacheLifetime = 0, $lastModified = null ) {
-		if ( !isset( $lastModified ) ) {
-			$lastModified = time();
-		}
-		switch ( $policy ) {
-		case 'none':
-			break;
-		case 'no-cache':
-		case 'nocache':
-			header( 'Expires: ' . $this->date( time() - 3600 ) );
-			header( 'Cache-Control: no-store,no-cache,must-revalidate,post-check=0,pre-check=0' );
-			break;
-		case 'private':
-			header( 'Expires: ' . $this->date( time() - 3600 ) );
-		case 'private_no_expire':
-			header( "Cache-Control: private,max-age=$cacheLifetime,pre-check=$cacheLifetime" );
-			break;
-		case 'public':
-		default:
-			header( 'Expires: ' . $this->date( time() + $cacheLifetime ) );
-			header( "Cache-Control: public,max-age=$cacheLifetime" );
-			header( "Last-Modified: " . $this->date( $lastModified ) );
-			break;
-		}
-	}
-	/**
-	 * Return an RFC compliant (RFC822 or RFC850) date string from a timestamp
-	 *
-	 * @param interger $time
-	 * @return string
-	 */	
-	function date( $time = null ) {
-        return gmdate(
-        	( ini_get('y2k_compliance') ? 'D, d M Y' : 'l, d-M-y' ) .' H:i:s',
-        	isset($time) ? $time : time()
-        ) . ' GMT';
-    }
-
-}
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/session.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/session.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/xo-info.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,41 +0,0 @@
-<?php
-/**
-* xoops_http session component bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @package		xoops_http_Session
-* @version		$Id$
-*/
-
-return array(
-	'xoBundleDisplayName' => 'XOOPS Session management component',
-	'xoBundleIdentifier' => 'xoops_http_Session',
-	'xoClassPath' => '/session.php',
-	'xoFactory' => 'xoops_http_SessionFactory',
-	'xoServices' => array(
-		'xoops_http_SessionService' => array(
-			'xoBundleDisplayName' => 'XOOPS default session service (using php.ini settings)',
-			'xoClassPath' => '/session.php',
-		),
-		'xoops_http_CustomSessionService' => array(
-			'xoBundleDisplayName' => 'XOOPS custom session service (using custom settings)',
-			'xoClassPath' => '/session-custom.php',
-		),
-		'xoops_http_DatabaseSessionHandler' => array(
-			'xoBundleDisplayName' => 'XOOPS database session handler',
-			'xoClassPath' => '/handler-db.php',
-		),
-	),
-	
-	
-	
-);
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/session.xoobj/xo-info.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/session.xoobj/xo-info.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/xo-info.php	2006-02-13 03:23:01 UTC (rev 228)
@@ -1,29 +0,0 @@
-<?php
-/**
-* xoops_http framework bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright	The XOOPS project http://www.xoops.org/
-* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @since		2.3.0
-* @package		xoops_http
-* @version		$Id$
-*/
-
-// xoBundleVersion: x.y.zRn  with R=release type (a:cvs snapshot, b:alpha, c:beta, d: RC, e: final)
-// We must be able to compare versions by comparing this string
-
-return array(
-	'xoBundleDisplayName'			=> 'Xoops HTTP framework',
-	'xoBundleIdentifier'			=> 'xoops_http',
-
-	'xoServices' => array(
-		'xoops_http_HttpHandler'	=> array ( 'xoBundleRoot' => '/http.xoobj' ),
-		'xoops_http_SessionService'	=> array ( 'xoBundleRoot' => '/session.xoobj' ),
-	),
-);
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/xo-info.php (from rev 226, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/xo-info.php)



From skalpa at berlios.de  Mon Feb 13 04:24:02 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 04:24:02 +0100
Subject: [Xoops4-svn] r229 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation
Message-ID: <200602130324.k1D3O2s6021390@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 04:23:58 +0100 (Mon, 13 Feb 2006)
New Revision: 229

Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/Http.xofrm/
Log:
Moving the HTTP framework to CoreServices/



From skalpa at berlios.de  Mon Feb 13 05:14:54 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 05:14:54 +0100
Subject: [Xoops4-svn] r230 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj: . plugins
Message-ID: <200602130414.k1D4Es5S006570@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 05:14:46 +0100 (Mon, 13 Feb 2006)
New Revision: 230

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/compiler.php
Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php
Log:
Added a custom Smarty compiler class to be used by XOOPS, and started to rename the low-level rendering framework to 'opal'.

Shortly: templates MAY (that means: not "MUST") now be provided as XML files that will be parsed before compilation.
The XML templates format looks like this (I've used it for the first config panels templates, so there will be examples soon):
<XoopsTemplate>
    <LanguageFiles>... list of strings files to be included when this tpl is used (will be implemented in alpha3 only) ...</LanguageFiles>
    <TemplateObjects>... list of widgets to instanciate before rendering ...</TemplateObjects>
    <TemplateData contentType='text/html'>
         data used when rendering as HTML
    </TemplateData>
    <TemplateData contentType='application/xhtml+xml'>
         data used when rendering as pure XHTML
    </TemplateData>
    <TemplateData contentType='application/pdf'>
         data used when rendering as PDF (will be post-processed by the PDF generator after rendering, as in phpdoc)
    </TemplateData>
</XoopsTemplate>

NB: the fact all this is integrated in the compilation mechanism means there will be no penalty during runtime :-)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/compiler.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/compiler.php	2006-02-13 03:23:58 UTC (rev 229)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/compiler.php	2006-02-13 04:14:46 UTC (rev 230)
@@ -0,0 +1,214 @@
+<?php
+/**
+ * xoops_opal_SmartyCompiler main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
+ * @version		$Id$
+ */
+
+/**
+ * This file cannot be requested directly
+ */
+if ( !defined( 'XOOPS_PATH' ) ) exit();
+
+require_once SMARTY_DIR . '/Smarty_Compiler.class.php';
+
+/**
+ * Opal Smarty compiler
+ *
+ * This compiler is used by the xoops_opal framework smarty implementation instead of the default one.
+ * If the template is recognized as an XML XoopsTemplate file, it will be parsed before compilation,
+ * the template data extracted from the correct TemplateData tag.
+ */
+class xoops_opal_SmartyCompiler extends Smarty_Compiler {
+	/**
+	 * Name of the currently compiled template
+	 * @var string
+	 * @access protected
+	 */
+	var $resourceName = '';	
+	/**
+	 * Language files included before the current template is rendered
+	 * @var array
+	 */
+	var $tplLangFiles = array();
+	/**
+	 * Widgets to instanciate when the current template is rendered
+	 * @var array
+	 */
+	var $tplWidgets = array();
+
+    function _compile_file($resource_name, $source_content, &$compiled_content) {
+		$this->resourceName = $resource_name;
+    	if ( substr( $resource_name, 0, 6 ) == 'xotpl:' ) {
+			if ( strpos( substr( $source_content, 0, 256 ), '<XoopsTemplate' ) !== false ) {
+				$this->tplLangFiles = $this->tplWidgets = array();
+				
+				$parser = xml_parser_create();
+				xml_parser_set_option($parser, XML_OPTION_CASE_FOLDING, 0);
+				xml_parser_set_option($parser, XML_OPTION_SKIP_WHITE, 1);
+				xml_parse_into_struct($parser, $source_content, $values, $tags );
+				xml_parser_free($parser);
+
+				if ( isset( $tags['Object'] ) ) {
+					$objects =& $tags['Object'];
+					for ( $n = 0; $n != count($objects); $n+=2 ) {
+						$start = $objects[$n] + 1;
+						$this->parseObject( $values[ $objects[$n] ], array_slice( $values, $start, $objects[$n+1] - $start ) );
+					}
+				}
+				$tplData = null;
+				foreach ( $tags['TemplateData'] as $tag ) {
+					$tagInfo =& $values[ $tag ];
+					if ( $tagInfo['attributes']['contentType'] == $this->template_engine->currentTheme->contentType ) {
+						$tplData = $tagInfo['value'];
+						break;
+					} elseif ( isset( $tagInfo['attributes']['default'] ) ) {
+						$tplData = $tagInfo['value'];
+					}
+				}
+				
+				parent::_compile_file( $resource_name, $tplData, $compiled_content );
+				$prelude = '';
+				if ( !empty($this->tplWidgets) ) {
+					$prelude = "<?php\n";
+					foreach ( $this->tplWidgets as $widgetDef ) {
+						$prelude .= $this->insertWidget( $widgetDef );
+					}
+					$prelude .= "\n?>";
+				}
+				$compiled_content = $prelude . $compiled_content;
+				return true;
+			}
+		}
+    	return parent::_compile_file( $resource_name, $source_content, $compiled_content );
+    }
+    
+	/**
+	 * Extract widget information from an XML template <object> tag
+	 * @access private
+	 */
+    function parseObject( $objectTag, $children ) {
+    	$object = array();
+    	if ( !isset( $objectTag['attributes']['bundleId'] ) ) {
+    		trigger_error( "Error parsing $this->resourceName: invalid template object definition (missing bundleId)", E_USER_WARNING );
+    		return;
+    	}
+    	$object['bundleId'] = "'" . $objectTag['attributes']['bundleId'] . "'";
+    	if ( isset( $objectTag['attributes']['tplVar'] ) ) {
+    		$object['assign'] = "'" . $objectTag['attributes']['tplVar'] . "'";
+    	}
+    	foreach ( $children as $k => $prop ) {
+    		$propName = $prop['attributes']['name'];
+    		if ( $prop['tag'] == 'Property' ) {
+    			if ( $prop['type'] == 'complete' ) {
+    				$object[ $propName ] = $this->parsePropertyValue( $prop['value'] );
+    			} elseif ( $prop['type'] == 'open' ) {
+    				$arrayStart = $k;
+    				$arrayName = $propName;
+    			} elseif ( $prop['type'] == 'close' ) {
+    				$object[ $arrayName ]  = $this->parseArrayProperty( array_slice( $children, $arrayStart+1, $k - $arrayStart - 1 ) );
+    			}
+    		}
+    	}
+    	$this->tplWidgets[] = $object;
+    }
+	/**
+	 * Parses an array property content
+	 * @access private
+	 */
+    function parseArrayProperty( $tags ) {
+    	$items = array();
+    	$n = 0;
+    	foreach ( $tags as $k => $tag ) {
+    		if ( isset( $tag['attributes']['key'] ) ) {
+    			$items[] = "'$k' => " . $this->parsePropertyValue( $tag['value'] );
+    		} else {
+    			$items[] = "$n => " . $this->parsePropertyValue(  $tag['value'] );
+    		}
+    	}
+    	return 'array( ' . implode( ',', $items ) . ')';
+    }
+	/**
+	 * Parses an object property value
+	 * @access private
+	 */
+	function parsePropertyValue( $val ) {
+		if ( substr( $val, 0, 1 ) != '$' ) {
+			return $this->_expand_quoted_text( "'" . addslashes($val) . "'" );
+		}
+		return $this->_parse_var_props( $val );
+	}
+    
+    /**
+     * Generates widget insertion code
+     *
+     * This method generates the widget instanciation code to be inserted in the compiled template.
+     * It is called for each <object> tag encountered during compilation of XML templates, or by the xoWidget
+     * compiler plug-in.
+     * 
+     * @param array $args
+     * @return string PHP code to be inserted in the compiled template
+     */
+    function insertWidget( $args ) {
+    	global $xoops;
+    	if ( isset( $args['assign'] ) ) {
+			$targetVar = $args['assign'];
+			unset( $args['assign'] );
+		} else {
+			$targetVar = '';
+		}
+		$bundleId = $args['bundleId'];
+		unset( $args['bundleId'] );
+		$realBundleId = substr( $bundleId, 1, strlen( $bundleId ) - 2 );
+	
+		$code = "\n";
+		// Get this widget stylesheet and javascript properties
+		if ( $css = XOS::classVar( $realBundleId, 'stylesheet' ) ) {
+			$css = $realBundleId . '#' . $css;
+			$attrs = array(
+				'type' => 'text/css',
+				'href' => $xoops->url( $this->template_engine->currentTheme->resourcePath( $css ) ),
+			);
+			$code .= '$this->currentTheme->setMeta( "stylesheet", "' . $css . '", ' . var_export( $attrs, true ) . ");\n";
+		}
+		if ( $js = XOS::classVar( $realBundleId, 'javascript' ) ) {
+			$js = $realBundleId . '#' . $js;
+			$attrs = array(
+				'type' => 'text/javascript',
+				'src' => $xoops->url( $this->template_engine->currentTheme->resourcePath( $js ) ),
+			);
+			$code .= '$this->currentTheme->setMeta( "script", "' . $js . '", ' . var_export( $attrs, true ) . ");\n";
+		}
+		$create = 'XOS::create( ' . $bundleId;
+		if ( !empty( $args ) ) {
+			$create .= ", array(\n";
+			foreach ( $args as $prop => $value ) {
+				$create .= "\t'$prop' => " . $value . ",\n";
+			}
+			$create .= ')';
+		}
+		$create .= " )";
+	
+		if ( !$targetVar ) {
+			$code .= "\$widget = $create;\n";
+			$code .= "echo ( \$widget ? \$widget->render() : \"Failed to instanciate $bundleId widget.\" );\n";
+		} else {
+			$code .= "\$this->_tpl_vars[$targetVar] = $create;\n";
+		}
+		return $code;
+    }
+    
+    
+    
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/compiler.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-02-13 03:23:58 UTC (rev 229)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-02-13 04:14:46 UTC (rev 230)
@@ -18,7 +18,7 @@
 	global $xoops;
 	
 	$argStr = trim( $argStr );
-
+/*
 	@list( $modId, $location ) = explode( '#', $argStr, 2 );
 	if ( isset( $location ) ) {
 		if ( $module = $xoops->loadModule( $modId ) ) {
@@ -30,7 +30,8 @@
 	} else {
 		$uri = $argStr;
 	}
-	
+*/
+	$uri = $argStr;
 	return "\necho '" . addslashes( $xoops->path( $uri, true ) ) . "';";
 
 }

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-02-13 03:23:58 UTC (rev 229)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-02-13 04:14:46 UTC (rev 230)
@@ -14,54 +14,52 @@
 * @version		$Id$
 */
 
-function smarty_compiler_xoWidget( $argStr, &$smarty ) {
+function smarty_compiler_xoWidget( $argStr, &$compiler ) {
 	global $xoops;
 	
-	$args = $smarty->_parse_attrs( trim( $argStr ) );
-	array_map( array( &$smarty, '_expand_quoted_text' ), $args );
+	$args = $compiler->_parse_attrs( trim( $argStr ) );
+	array_map( array( &$compiler, '_expand_quoted_text' ), $args );
 	
+	if ( isset( $args['tplVar'] ) ) {
+		$code = '';
+		foreach ( $args as $prop => $value ) {
+			if ( $prop != 'tplVar' ) {
+				$code .= $args['tplVar'] . "->$prop = $value;\n";
+			}
+		}
+		return $code . "echo " . $args['tplVar'] . "->render();";
+	}
+	
+	
 	if ( !isset( $args['bundleId'] ) ) {
 		trigger_error( "Cannot insert widget: no bundleId specified", E_USER_WARNING );
 		return '';
 	}
-	$bundleId = $args['bundleId'];
-	unset( $args['bundleId'] );
-
-	$realBundleId = substr( $bundleId, 1, strlen( $bundleId ) - 2 );
-	
-	$code = "\n";
-	// Get this widget stylesheet and javascript properties
-	if ( $css = XOS::classVar( $realBundleId, 'stylesheet' ) ) {
-		$css = $realBundleId . '#' . $css;
-		$attrs = array(
-			'type' => 'text/css',
-			'href' => $xoops->url( $smarty->template_engine->currentTheme->resourcePath( $css ) ),
-		);
-		$code .= '$this->currentTheme->setMeta( "stylesheet", "' . $css . '", ' . var_export( $attrs, true ) . ");\n";
+	// Transform __property__key settings to an arrays
+	$arrays = array();
+	foreach ( $args as $k => $v ) {
+		if ( substr( $k, 0, 2 ) == '__' ) {
+			$prop = explode( '__', substr( $k, 2 ), 2 );
+			if ( isset( $prop[1] ) ) {
+				$arrays[ $prop[0] ][ $prop[1] ] = $v;
+			} else {
+				$arrays[ $prop[0] ][] = $v;
+			}
+			unset( $args[$k] );
+		}
 	}
-	if ( $js = XOS::classVar( $realBundleId, 'javascript' ) ) {
-		$js = $realBundleId . '#' . $js;
-		$attrs = array(
-			'type' => 'text/javascript',
-			'src' => $xoops->url( $smarty->template_engine->currentTheme->resourcePath( $js ) ),
-		);
-		$code .= '$this->currentTheme->setMeta( "script", "' . $js . '", ' . var_export( $attrs, true ) . ");\n";
-	}
-
-
-	$code .= '$widget = XOS::create( ' . $bundleId;
-	if ( !empty( $args ) ) {
-		$code .= ", array(\n";
-		foreach ( $args as $prop => $value ) {
-			$code .= "\t'$prop' => " . $value . ",\n";
+	if ( !empty( $arrays ) ) {
+		foreach ( $arrays as $aname => $array ) {
+			$args[$aname] = 'array(';
+			foreach ( $array as $k => $v ) {
+				$args[$aname] .= var_export($k,true) . ' => ' . $v . ', ';
+			}
+			$args[$aname] .= ')';
 		}
-		$code .= ')';
 	}
-	$code .= " );\n";
-	$code .= "echo ( \$widget ? \$widget->render() : \"Failed to instanciate $bundleId widget.\" );\n";
 	
-	return $code;
-
+	return $compiler->insertWidget( $args );
+	
 }
 
 ?>
\ No newline at end of file

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php	2006-02-13 03:23:58 UTC (rev 229)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php	2006-02-13 04:14:46 UTC (rev 230)
@@ -8,8 +8,8 @@
  * @copyright   The Xoops project http://www.xoops.org/
  * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
  * @since       2.3.0
- * @package		xoops_template
- * @subpackage	xoops_template_Smarty
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
  * @version		$Id$
  * @author		Skalpa Keo <skalpa at xoops.org>
  */
@@ -22,17 +22,20 @@
  * @package		xoops_template
  * @subpackage	xoops_template_Smarty
  */
-class xoops_template_Smarty extends Smarty {
+class xoops_opal_Smarty extends Smarty {
 	
 	var $left_delimiter =	'([';
 	var $right_delimiter =	'])';
 
 	var $template_dir		= XOOPS_THEME_PATH;
 	var $compile_dir		= 'var/Application Support/xoops_template_Smarty';
-	var $cache_dir			= 'var/Caches/xoops_template_Smarty';
+	var $cache_dir			= 'var/Caches/xoops_opal_Smarty';
 
 	var $use_sub_dirs		= false;
 	
+
+	var $compiler_class		= 'xoops_opal_SmartyCompiler';
+	var $compiler_file		= '/compiler.php';
 	
 	var $currentFile		= '';
 
@@ -44,12 +47,14 @@
 	var $currentTheme		= false;
 	
 
-	function xoops_template_Smarty( $options = null ) {
+	function xoops_opal_Smarty( $options = null ) {
 		global $xoops;
 		
 		$this->compile_dir	= $xoops->path( $this->compile_dir );
 		$this->cache_dir	= $xoops->path( $this->cache_dir );
 
+		$this->compiler_file = str_replace( '\\', '/', dirname( __FILE__ ) ) . $this->compiler_file;
+		
 		if ( $xoops->xoRunMode & XO_MODE_DEV_MASK ) {
 			$this->compile_check = true;
 			$this->force_compile = true;

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php	2006-02-13 03:23:58 UTC (rev 229)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php	2006-02-13 04:14:46 UTC (rev 230)
@@ -1,20 +1,22 @@
 <?php
 /**
-* xoops_template_Smarty bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo <skalpa at xoops.org>
-*/
+ * xoops_template_Smarty bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since       2.3.0
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
+ * @version		$Id$
+ */
 
 return array(
 	'xoBundleDisplayName' => 'Smarty template engine (XOOPS version)',
-	'xoBundleIdentifier' => 'xoops_template_Smarty',
+	'xoBundleIdentifier' => 'xoops_opal_Smarty',
 	'xoClassPath' => '/smarty.php',
 	'xoServices' => array(
 		'Smarty' => array(



From skalpa at berlios.de  Mon Feb 13 16:03:15 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:03:15 +0100
Subject: [Xoops4-svn] r231 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj: . www
Message-ID: <200602131503.k1DF3Fjp022550@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:03:14 +0100 (Mon, 13 Feb 2006)
New Revision: 231

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/treewidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js
Log:
Minor fixes

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/treewidget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/treewidget.php	2006-02-13 04:14:46 UTC (rev 230)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/treewidget.php	2006-02-13 15:03:14 UTC (rev 231)
@@ -1,56 +1,56 @@
 <?php
 /**
-* xoops_pyro_TreeWidget component class file
-*
-* @copyright	The Xoops project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_TreeWidget
-* @author       Skalpa Keo <skalpa at xoops.org>
-* @since        2.3.0
-* @version		$Id$
-*/
+ * xoops_pyro_TreeWidget component class file
+ *
+ * @copyright	The Xoops project http://www.xoops.org/
+ * @license      http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author       Skalpa Keo <skalpa at xoops.org>
+ * @since        2.3.0
+ * @version		$Id$
+ * @package      xoops_pyro
+ * @subpackage   xoops_pyro_TreeWidget
+ */
 
 XOS::import( 'xoops_pyro_Widget' );
 
 /**
-* xoops_pyro_TreeWidget
-*
-* The tree widget renders hierarchical data.
-* The default HTML output will show an expandable/collapsable tree made of UL/LI elements.
-* Its dynamic behavior makes strong use of CSS, and only requires minimal scripting (mainly to
-* assign appropriate CSS classes to elements during initialization).
-* 
-* The data is provided to the tree as an array:
-* <code>
-* $data = array(
-* 	'item1' => array(
-* 		'name' => 'Item 1',
-* 	),
-* 	'item2' => array(
-* 		'name' => 'Item 2 with sub',
-* 		'link' => 'item2.html',
-* 		'children' => array(
-* 			'i2sub1' => array(
-* 				'name' => 'SubItem 1',
-* 				'link' => 'subitem1.html',
-* 			),
-* 			'i2sub2' => array(
-* 				'name' => 'SubItem 2',
-* 				'link' => 'subitem2.html',
-* 			),
-* 		),
-* 	),
-* );
-* $widget->treeData = $data;
-* echo $widget->render();
-* </code>
-* 
-* @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_TreeWidget
-* @since        2.3.0
-*/
+ * Widget rendering hierarchical data as a tree
+ *
+ * The tree widget renders hierarchical data.
+ * The default HTML output will show an expandable/collapsable tree made of UL/LI elements.
+ * Its dynamic behavior makes strong use of CSS, and only requires minimal scripting (mainly to
+ * assign appropriate CSS classes to elements during initialization).
+ * 
+ * The data is provided to the tree as an array:
+ * <code>
+ * $data = array(
+ * 	'item1' => array(
+ * 		'name' => 'Item 1',
+ * 	),
+ * 	'item2' => array(
+ * 		'name' => 'Item 2 with sub',
+ * 		'link' => 'item2.html',
+ * 		'children' => array(
+ * 			'i2sub1' => array(
+ * 				'name' => 'SubItem 1',
+ * 				'link' => 'subitem1.html',
+ * 			),
+ * 			'i2sub2' => array(
+ * 				'name' => 'SubItem 2',
+ * 				'link' => 'subitem2.html',
+ * 			),
+ * 		),
+ * 	),
+ * );
+ * $widget->treeData = $data;
+ * echo $widget->render();
+ * </code>
+ * 
+ * @author 		Skalpa Keo
+ * @package		xoops_pyro
+ * @subpackage	xoops_pyro_TreeWidget
+ * @since        2.3.0
+ */
 class xoops_pyro_TreeWidget extends xoops_pyro_Widget {
 	
 	var $stylesheet = 'www/default.css';
@@ -73,7 +73,7 @@
 	}
 	
 	function render() {
-		$str = $this->renderOpeningTag( 'ul' );
+		$str = $this->renderTag( 'ul' );
 		foreach ( $this->treeData as $node ) {
 			$str .= $this->renderNode( $node );
 		}

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js	2006-02-13 04:14:46 UTC (rev 230)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js	2006-02-13 15:03:14 UTC (rev 231)
@@ -65,9 +65,9 @@
 			return true;
 		} else {
 			if ( this.className.indexOf( me.openClass ) != -1 ) {
-				xoReplaceClass( this, me.openClass, me.closedClass );
+				xoops.replaceElementClass( this, me.openClass, me.closedClass );
 			} else {
-				xoReplaceClass( this, me.closedClass, me.openClass );
+				xoops.replaceElementClass( this, me.closedClass, me.openClass );
 			}
 			evt.cancelBubble = true;
 			if ( evt.stopPropagation )	evt.stopPropagation();



From skalpa at berlios.de  Mon Feb 13 16:06:25 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:06:25 +0100
Subject: [Xoops4-svn] r232 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm
Message-ID: <200602131506.k1DF6Pu1022853@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:06:25 +0100 (Mon, 13 Feb 2006)
New Revision: 232

Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/
Log:
Separating the low and high level interface building frameworks



From skalpa at berlios.de  Mon Feb 13 16:10:08 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:10:08 +0100
Subject: [Xoops4-svn] r233 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore: . UserExperience
Message-ID: <200602131510.k1DFA8Oq023529@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:10:07 +0100 (Mon, 13 Feb 2006)
New Revision: 233

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/
Log:
Separating the low and high level interface building frameworks



From skalpa at berlios.de  Mon Feb 13 16:10:36 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:10:36 +0100
Subject: [Xoops4-svn] r234 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm: . TreeWidget.xoobj TreeWidget.xoobj/www
Message-ID: <200602131510.k1DFAanS023606@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:10:36 +0100 (Mon, 13 Feb 2006)
New Revision: 234

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/xo-info.php
Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js
Log:
Separating the low and high level interface building frameworks

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj (from rev 216, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/treewidget.php	2006-01-31 05:24:57 UTC (rev 216)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php	2006-02-13 15:10:36 UTC (rev 234)
@@ -1,112 +0,0 @@
-<?php
-/**
-* xoops_pyro_TreeWidget component class file
-*
-* @copyright	The Xoops project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_TreeWidget
-* @author       Skalpa Keo <skalpa at xoops.org>
-* @since        2.3.0
-* @version		$Id$
-*/
-
-XOS::import( 'xoops_pyro_Widget' );
-
-/**
-* xoops_pyro_TreeWidget
-*
-* The tree widget renders hierarchical data.
-* The default HTML output will show an expandable/collapsable tree made of UL/LI elements.
-* Its dynamic behavior makes strong use of CSS, and only requires minimal scripting (mainly to
-* assign appropriate CSS classes to elements during initialization).
-* 
-* The data is provided to the tree as an array:
-* <code>
-* $data = array(
-* 	'item1' => array(
-* 		'name' => 'Item 1',
-* 	),
-* 	'item2' => array(
-* 		'name' => 'Item 2 with sub',
-* 		'link' => 'item2.html',
-* 		'children' => array(
-* 			'i2sub1' => array(
-* 				'name' => 'SubItem 1',
-* 				'link' => 'subitem1.html',
-* 			),
-* 			'i2sub2' => array(
-* 				'name' => 'SubItem 2',
-* 				'link' => 'subitem2.html',
-* 			),
-* 		),
-* 	),
-* );
-* $widget->treeData = $data;
-* echo $widget->render();
-* </code>
-* 
-* @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_TreeWidget
-* @since        2.3.0
-*/
-class xoops_pyro_TreeWidget extends xoops_pyro_Widget {
-	
-	var $stylesheet = 'www/default.css';
-	var $javascript = 'www/treewidget.js';
-	
-	/**
-	 * The tree nodes data
-	 *
-	 * The tree data is an array of nodes. Each node must be an hash containing a 'name' element, and optionally
-	 * a 'link' element (if it links to another location) or a 'children' element containing this node
-	 * subnodes.
-	 * 
-	 * @var array
-	 */	
-	var $treeData = array();
-	
-	function xoInit( $options = array() ) {
-		array_unshift( $this->elementClasses, 'pyro_TreeWidget' );
-		return true;	
-	}
-	
-	function render() {
-		$str = $this->renderOpeningTag( 'ul' );
-		foreach ( $this->treeData as $node ) {
-			$str .= $this->renderNode( $node );
-		}
-		$str .= '</ul>';
-		$str .= "\n<script type='text/javascript'>\n";
-		$str .= 'var ' . str_replace( '-', '', $this->elementId ) . ' = new xoops_pyro_TreeWidget("' . $this->elementId . '");';
-		$str .= "\n</script>\n";
-		return $str;
-	}
-	
-	/**
-	 * Internal method used to render a single node
-	 * @param array $node
-	 * @return string
-	 */
-	function renderNode( $node ) {
-		if ( !isset( $node['link'] ) ) {
-			$str = '<li>' . htmlspecialchars( $node['name'] );
-		} else {
-			$str = '<li><a href="' . htmlspecialchars( $node['link'] ) . '">' . htmlspecialchars( $node['name'] ) . '</a>';
-		}
-		if ( !@empty( $node['children'] ) ) {
-			$str .= "\n<ul>\n";
-			foreach ( $node['children'] as $child ) {
-				$str .= $this->renderNode( $child );
-			}
-			$str .= "\n</ul>\n";
-		}
-		$str .= "</li>\n";
-		return $str;
-	}
-	
-}
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php (from rev 231, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/treewidget.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js	2006-01-31 05:24:57 UTC (rev 216)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js	2006-02-13 15:10:36 UTC (rev 234)
@@ -1,108 +0,0 @@
-
-function xoops_pyro_TreeWidget( elementId, openClass, closedClass ) {
-	var me=this;
-	
-	this.elementId = elementId;
-	this.targetElement = document.getElementById( elementId );
-	this.openClass = openClass ? openClass : "openNode";
-	this.closedClass = closedClass ? closedClass : "closedNode";
-	this.enabled = ( this.targetElement && document.createElement ) ? true : false;
-	/**
-	* Expand all the nodes of this tree
-	*/
-	this.expandAll = function () {
-		if ( !this.enabled )	return;
-		return this.switchNode( this.targetElement, true );
-	}
-	/**
-	* Collapse all the nodes of this tree
-	*/
-	this.collapseAll = function () {
-		if ( !this.enabled )	return;
-		return this.switchNode( this.targetElement, false );
-	}
-	/**
-	* Expand nodes ensuring the specified item is visible
-	*/
-	this.revealItem = function ( targetId ) {
-		if ( !this.enabled )	return;
-		var target;
-		if ( this.switchNode( this.targetElement, true, targetId ) )
-			if ( target = document.getElementById( targetId ) )
-				target.scrollIntoView( false );
-	}
-	
-	this.switchNode = function ( elt, state, targetId ) {
-		if ( !elt.childNodes || !elt.childNodes.length )	return false;
-		var nItem, nSub, hasSub = false;
-		for ( nItem = 0; nItem < elt.childNodes.length; nItem++ ) {
-			var item = elt.childNodes[nItem];
-			if ( targetId && item.id == targetId )	return true;
-			if ( item.nodeName && item.nodeName.toLowerCase() == 'li' ) {
-				for ( nSub = 0; nSub < item.childNodes.length; nSub++ ) {
-					var subItem = item.childNodes[nSub];
-					if ( subItem.nodeName && subItem.nodeName.toLowerCase() == 'ul' ) {
-						hasSub = true;
-						if ( targetId && this.switchNode( elt, state, targetId ) ) {
-							item.className = this[ state ? 'openClass' : 'closeClass' ];
-							return true;
-						}
-					}
-				}
-				if ( hasSub && targetId ) {
-					item.className = this[ state ? 'openClass' : 'closeClass' ];
-				}
-			}
-		}
-	}
-	
-	this.handleClick = function ( evt ) {
-		if ( !evt ) evt=window.event;
-		var tgt = evt.target ? evt.target : evt.srcElement;
-		if ( tgt.nodeType == 3 ) tgt.nodeType = tgt.parentNode;
-		
-		if ( tgt != this ) {
-			return true;
-		} else {
-			if ( this.className.indexOf( me.openClass ) != -1 ) {
-				xoReplaceClass( this, me.openClass, me.closedClass );
-			} else {
-				xoReplaceClass( this, me.closedClass, me.openClass );
-			}
-			evt.cancelBubble = true;
-			if ( evt.stopPropagation )	evt.stopPropagation();
-			return false;
-		}
-	}
-	
-	this.initializeTree = function ( elt ) {
-		if ( !this.enabled )	return;
-		if ( !elt.childNodes || !elt.childNodes.length )	return false;
-		var nItem, nSub, hasSub = false;
-		for ( nItem = 0; nItem < elt.childNodes.length; nItem++ ) {
-			var item = elt.childNodes[nItem];
-			if ( item.nodeName && item.nodeName.toLowerCase() == 'li' ) {
-				hasSub = false;
-				for ( nSub = 0; nSub < item.childNodes.length; nSub++ ) {
-					var subItem = item.childNodes[nSub];
-					if ( subItem.nodeName && subItem.nodeName.toLowerCase() == 'ul' ) {
-						hasSub = true;
-						this.initializeTree( subItem );
-					}
-				}
-				if ( !hasSub ) {
-					item.className = 'treeItem';
-					item.onclick = function () { return true; }
-				} else {
-					if ( !item.className ) {
-						item.className = this.openClass;
-					}
-					item.className += ' treeNode';
-					item.onclick = this.handleClick;
-				}
-			}
-		}
-	}
-	this.targetElement.className = 'pyro_TreeWidget';
-	this.initializeTree( this.targetElement );
-}

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js (from rev 231, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/TreeWidget.xoobj/www/treewidget.js)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/xo-info.php	2006-02-13 15:10:07 UTC (rev 233)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/xo-info.php	2006-02-13 15:10:36 UTC (rev 234)
@@ -0,0 +1,36 @@
+<?php
+/**
+ * xoops_pyro bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_pyro
+ */
+
+return array(
+	'xoBundleDisplayName' => '"Pyro" user interface wigets set',
+	'xoBundleIdentifier' => 'xoops_pyro',
+	'xoServices' => array(
+		'xoops_pyro_TreeWidget'	=> array (
+			'xoBundleRoot' => '/TreeWidget.xoobj'
+		),
+		// Form widgets
+		'xoops_pyro_Form'			=> array( 'xoClassPath' => '/Forms/form.php' ),
+		'xoops_pyro_FormElement'	=> array( 'xoClassPath' => '/Forms/element.php' ),
+		'xoops_pyro_FormText'		=> array( 'xoClassPath' => '/Forms/text.php' ),
+		'xoops_pyro_FormSecret'		=> array( 'xoClassPath' => '/Forms/text.php' ),
+		'xoops_pyro_FormTextarea'	=> array( 'xoClassPath' => '/Forms/textarea.php' ),
+		'xoops_pyro_FormSelect'		=> array( 'xoClassPath' => '/Forms/select.php' ),
+		'xoops_pyro_FormSelect1'	=> array( 'xoClassPath' => '/Forms/select.php' ),
+		'xoops_pyro_FormSubmit'		=> array( 'xoClassPath' => '/Forms/submit.php' ),
+		'xoops_pyro_FormRange'		=> array( 'xoClassPath' => '/Forms/range.php' ),
+	),
+);
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/xo-info.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Mon Feb 13 16:30:58 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:30:58 +0100
Subject: [Xoops4-svn] r235 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm: . Theme.xoobj
Message-ID: <200602131530.k1DFUwX9025941@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:30:56 +0100 (Mon, 13 Feb 2006)
New Revision: 235

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php
Log:
Separating the low and high level interface building frameworks

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php	2006-02-13 15:10:36 UTC (rev 234)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php	2006-02-13 15:30:56 UTC (rev 235)
@@ -1,25 +1,25 @@
 <?php
 /**
-* xoops_pyro_Theme component class file
+* xoops_opal_Theme component class file
 *
 * @copyright	The Xoops project http://www.xoops.org/
 * @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_Theme
 * @author       Skalpa Keo <skalpa at xoops.org>
 * @since        2.3.0
 * @version		$Id$
+* @package 		xoops_opal
+* @subpackage 	xoops_opal_Theme
 */
 
 /**
-* xoops_pyro_ThemeFactory
+* xoops_opal_ThemeFactory
 *
 * @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_ThemeFactory
+* @package		xoops_opal
+* @subpackage	xoops_opal_Theme
 * @since        2.3.0
 */
-class xoops_pyro_ThemeFactory {
+class xoops_opal_ThemeFactory {
 	/**
 	 * Currently enabled themes (if empty, all the themes in themes/ are allowed)
 	 * 
@@ -43,7 +43,7 @@
 		} elseif ( !empty( $this->allowedThemes ) && !in_array( $options['folderName'], $this->allowedThemes ) ) {
 			$options['folderName'] = $this->defaultTheme;
 		}
-		$inst =& XOS::createInstanceOf( "xoops_pyro_Theme", $options, $initArgs );
+		$inst =& XOS::createInstanceOf( "xoops_opal_Theme", $options, $initArgs );
 		return $inst;
 	}
 
@@ -56,7 +56,7 @@
 	function enumerate( $allowed = true ) {
 		global $xoops;
 		$themes = array();
-		if ( $dh = opendir( $xoops2->path('/themes/') ) ) {
+		if ( $dh = opendir( $xoops->path('/themes/') ) ) {
 			while ( $file = readdir($dh) ) {
 				if ( $file{0} != '.' && $file != 'CVS' ) {
 					$themes[] = $file;
@@ -72,7 +72,7 @@
 
 }
 
-class xoops_pyro_Theme {
+class xoops_opal_Theme {
    /**
     * The name of this theme
     * @var string
@@ -84,17 +84,29 @@
     */
 	var $path = '';
 	var $url = '';
-   /**
-   * Whether or not the theme engine should include the output generated by php
-   * @var string
-   */
-	var $bufferOutput = true;
+
 	/**
 	* Default content-type of pages generated by this theme
 	* @var string
 	*/
 	var $contentType = 'text/html';
 	/**
+	* Output format doctype
+	* @var string
+	*/
+	var $doctype = 'html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"';
+	/**
+	* Document namespaces
+	* @var string
+	*/
+	var $namespaces = array();
+
+   /**
+    * Whether or not the theme engine should include the output generated by php
+    * @var string
+    */
+	var $bufferOutput = true;
+	/**
 	* Canvas-level template to use
 	* @var string
 	*/
@@ -150,11 +162,6 @@
 		global $xoops;
 
 		$this->path	= $xoops->path( '/themes/' . $this->folderName );
-
-		$this->template =& XOS::create( 'xoops_template_Smarty' );
-		$this->template->currentTheme =& $this;
-		$this->template->compile_id = $this->folderName;
-
 		if ( $info = @include "$this->path/xo-info.php" ) {
 			XOS::apply( $this, $info );
 			if ( isset( $_SESSION ) ) {
@@ -165,6 +172,16 @@
 			$this->parentTheme = ( $this->folderName == 'xoops20' ? '' : 'xoops20' );
 			$_SESSION[$xoops->services['http']->xoBundleIdentifier]['tmpDisallowRedirections'] = true;
 		}
+
+		
+		if ( $this->namespaces && !is_array( $this->namespaces ) ) {
+			$this->namespaces = array( '' => $this->namespaces );
+		}
+
+		$this->template =& XOS::create( 'xoops_opal_Smarty' );
+		$this->template->currentTheme =& $this;
+		$this->template->compile_id = $this->folderName;
+		
 		if ( $this->bufferOutput ) {
 			ob_start();
 		}
@@ -176,6 +193,20 @@
 	}
 
 	/**
+	 * Returns the document namespaces as an xmlns string that can be inserted in the main tag
+	 */	
+	function namespacesString() {
+		$str = array();
+		foreach ( $this->namespaces as $ns => $uri ) {
+			if ( !empty( $ns ) ) {
+				$ns = ':' . $ns;
+			}
+			$str[] = 'xmlns' . $ns . '="' . $uri . '"';
+		}
+		return implode( ' ', $str );
+	}
+	
+	/**
 	 * Render the page
 	 *
 	 * The theme engine builds pages from 3 templates: canvas, page and content.
@@ -224,6 +255,11 @@
 		/* this will be changed */
 		$vars['xoops_dirname'] = @!empty( $GLOBALS['xoopsModule'] ) ? $GLOBALS['xoopsModule']->getVar('dirname') : 'system';
 		$this->template->assign( $vars );
+		
+		if ( $xoops->services['http'] ) {
+			$xoops->services['http']->setEntityInfo( $this->contentType, 'iso-8859-1' );
+			$xoops->services['http']->addVariation( 'xo-theme', $this->xoBundleIdentifier );
+		}
 		$this->renderZone( 'canvas' );
 		$this->renderCount++;
 	}
@@ -326,7 +362,7 @@
 		}
 		if ( !empty( $this->parentTheme ) ) {
 			if ( !is_object( $this->parentTheme ) ) {
-				$this->parentTheme =& XOS::create( 'xoops_pyro_Theme', array( 'folderName' => $this->parentTheme ) );
+				$this->parentTheme =& XOS::create( 'xoops_opal_Theme', array( 'folderName' => $this->parentTheme ) );
 			}
 			if ( is_object( $this->parentTheme ) ) {
 				return $this->parentTheme->resourcePath( $path, $fromDocRoot );

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php	2006-02-13 15:10:36 UTC (rev 234)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php	2006-02-13 15:30:56 UTC (rev 235)
@@ -1,6 +1,6 @@
 <?php
 /**
-* xoops_pyro_Theme bundle information file
+* xoops_opal_Theme bundle information file
 *
 * See the enclosed file LICENSE for licensing information.
 * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
@@ -10,15 +10,17 @@
 * @since        2.3.0
 * @version		$Id$
 * @author		Skalpa Keo <skalpa at xoops.org>
+* @package 		xoops_opal
+* @subpackage 	xoops_opal_Theme
 */
 
 return array(
 	'xoBundleDisplayName' => 'XOOPS Theme component',
-	'xoBundleIdentifier' => 'xoops_pyro_Theme',
+	'xoBundleIdentifier' => 'xoops_opal_Theme',
 	'xoClassPath' => '/theme.php',
-	'xoFactory' => 'xoops_pyro_ThemeFactory',
+	'xoFactory' => 'xoops_opal_ThemeFactory',
 	'xoServices' => array(
-		'xoops_pyro_ThemeFactory' => array(
+		'xoops_opal_ThemeFactory' => array(
 			'xoClassPath' => '/theme.php',
 		),
 	),

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php	2006-02-13 15:10:36 UTC (rev 234)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php	2006-02-13 15:30:56 UTC (rev 235)
@@ -1,71 +1,104 @@
 <?php
 /**
-* xoops_pyro_Widget component class file
-*
-* @copyright	The Xoops project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_Widget
-* @author       Skalpa Keo <skalpa at xoops.org>
-* @since        2.3.0
-* @version		$Id$
-*/
+ * xoops_opal_Widget component class file
+ *
+ * @copyright	The Xoops project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author      Skalpa Keo <skalpa at xoops.org>
+ * @since       2.3.0
+ * @version		$Id$
+ * @package     xoops_opal
+ * @subpackage  xoops_opal_Widget
+ */
 
 /**
-* xoops_pyro_Widget
-*
-* Widgets are user interface components that can be rendered to HTML
-* 
-* 
-* 
-* 
-* @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_Widget
-* @since        2.3.0
-*/
-class xoops_pyro_Widget {
+ * Base class for User Interface widgets
+ *
+ * Widgets are configurable objects intended to be inserted inside the output.
+ * They provide a default rendering mechanism that can be overridden using templates
+ * for more flexibility if you want to.
+ * 
+ * You ensure widgets are instanciated by declaring them in the <TemplateObjects> section
+ * of XML templates, or by inserting them directly in your templates body using the
+ * ([xoWidget]) plug-in.
+ * 
+ * @author		Skalpa Keo
+ * @since       2.3.0
+ * @package     xoops_opal
+ * @subpackage  xoops_opal_Widget
+ */
+class xoops_opal_Widget {
 	/**
+	 * Main tag to use when rendering this widget
+	 */
+	var $tagName = '';
+	/**
 	 * XMLID given to this widget main output element
-	 *
 	 * @var string
 	 */
 	var $elementId = '';
 	/**
 	 * Classes of this widget output element (when rendered to HTML)
-	 *
 	 * @var string[]
 	 */
 	var $elementClasses = array();
 	/**
+	 * Attributes to add to this widget main tag
+	 */
+	var $attributes = array();
+	/**
 	 * Path to the stylesheet to add to the document when inserting this widget
-	 *
 	 * @var string
 	 */
 	var $stylesheet = '';
 	/**
 	 * Path to the javascript file to add to the document when inserting this widget
-	 *
 	 * @var string
 	 */
 	var $javascript = '';
 	/**
-	 * Template to use to render this widget (use hardcoded rendering if left empty)
+	 * Template file to use to render this widget (use hardcoded rendering if left empty)
 	 *
 	 * @var string
 	 */
 	var $template = '';
+	
+	var $templateString = '';
+	
+	function xoInit( $options = array(), $attributes = array() ) {
+		if ( !empty( $attributes ) ) {
+			$this->attributes = array_merge( $this->attributes, $attributes );
+		}
+		return true;
+	}
+	
 	/**
 	 * Renders this widget
 	 */
 	function render() {
+		if ( !empty( $this->template ) ) {
+			trigger_error( "Template rendering of widgets is not implemented yet (but you're welcome)", E_USER_WARNING );
+		} elseif ( !empty( $this->templateString ) ) {
+			return preg_replace_callback( '/{([0-9a-zA-Z_]*)}/', array( &$this, 'renderStringProperty' ), $this->templateString );
+		}
 		return '';
 	}
+
+	function renderStringProperty( $matches ) {
+		return $matches[1];
+	}
+	
 	/**
 	 * Returns an XML opening tag with its 'id' and 'class' attributes set
 	 * @access protected
 	 */
-	function renderOpeningTag( $tagName ) {
+	function renderTag( $tagName = null, $attributes = null, $empty = false ) {
+		if ( !isset($tagName) ) {
+			$tagName = $this->tagName;
+		}
+		if ( !isset( $attributes ) ) {
+			$attributes = $this->attributes;
+		}
 		$str = "<$tagName";
 		if ( $this->elementId ) {
 			$str .= ' id="' . $this->elementId . '"';
@@ -73,10 +106,26 @@
 		if ( !empty( $this->elementClasses ) ) {
 			$str .= ' class="' . implode( ' ', $this->elementClasses ) . '"';
 		}
-		return $str . '>';
+		if ( $attrs = $this->attributesString( $attributes ) ) {
+			$str .= ' ' . $attrs;
+		}
+		$str .= $empty ? ' />' : '>';
+		return $str;
 	}
+	/**
+	 * Renders a collection of attributes for HTML
+	 * @param array $attributes
+	 * @return string
+	 */
+	function attributesString( $attributes ) {
+		$rendered = array();
+		foreach ( $attributes as $name => $val ) {
+			if ( isset( $val ) ) {
+				$rendered[] = $name . '="' . htmlspecialchars( $val, ENT_QUOTES ) . '"';
+			}
+		}
+		return implode( ' ', $rendered );
+	}
 
-	
-	
 }
 

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php	2006-02-13 15:10:36 UTC (rev 234)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php	2006-02-13 15:30:56 UTC (rev 235)
@@ -1,33 +1,31 @@
 <?php
 /**
-* xoops_pyro bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo <skalpa at xoops.org>
-*/
+ * xoops_opal bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package 	xoops_opal
+ */
 
 return array(
-	'xoBundleDisplayName' => '"Pyro" user interface framework',
-	'xoBundleIdentifier' => 'xoops_pyro',
+	'xoBundleDisplayName' => 'Opal output rendering framework',
+	'xoBundleIdentifier' => 'xoops_opal',
 	'xoServices' => array(
-		'xoops_pyro_Theme'	=> array (
+		'xoops_opal_Smarty'	=> array (
+			'xoBundleRoot' => '/Smarty.xoobj'
+		),
+		'xoops_opal_Theme'	=> array (
 			'xoBundleRoot' => '/Theme.xoobj'
 		),
-		'xoops_pyro_Widget' => array(
+		'xoops_opal_Widget' => array(
 			'xoClassPath' => '/widget.php',
 		),
-		'xoops_pyro_TreeWidget'	=> array (
-			'xoBundleRoot' => '/TreeWidget.xoobj'
-		),
-		'xoops_template_Smarty'	=> array (
-			'xoBundleRoot' => '/Smarty.xoobj'
-		),
 	),
 );
 



From skalpa at berlios.de  Mon Feb 13 16:31:54 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:31:54 +0100
Subject: [Xoops4-svn] r236 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj
Message-ID: <200602131531.k1DFVsjW026108@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:31:51 +0100 (Mon, 13 Feb 2006)
New Revision: 236

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php
Log:
Separating the low and high level interface building frameworks

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php	2006-02-13 15:30:56 UTC (rev 235)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/TreeWidget.xoobj/treewidget.php	2006-02-13 15:31:51 UTC (rev 236)
@@ -11,7 +11,7 @@
  * @subpackage   xoops_pyro_TreeWidget
  */
 
-XOS::import( 'xoops_pyro_Widget' );
+XOS::import( 'xoops_opal_Widget' );
 
 /**
  * Widget rendering hierarchical data as a tree
@@ -51,7 +51,7 @@
  * @subpackage	xoops_pyro_TreeWidget
  * @since        2.3.0
  */
-class xoops_pyro_TreeWidget extends xoops_pyro_Widget {
+class xoops_pyro_TreeWidget extends xoops_opal_Widget {
 	
 	var $stylesheet = 'www/default.css';
 	var $javascript = 'www/treewidget.js';



From skalpa at berlios.de  Mon Feb 13 16:33:07 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:33:07 +0100
Subject: [Xoops4-svn] r237 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore
Message-ID: <200602131533.k1DFX7W1026246@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:33:04 +0100 (Mon, 13 Feb 2006)
New Revision: 237

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/
Log:
Moving the low-level rendering frameworks to a dedicated folder



From skalpa at berlios.de  Mon Feb 13 16:34:39 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:34:39 +0100
Subject: [Xoops4-svn] r238 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore
Message-ID: <200602131534.k1DFYd01026488@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:34:37 +0100 (Mon, 13 Feb 2006)
New Revision: 238

Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/
Log:
Moving the low-level rendering frameworks to a dedicated folder



From skalpa at berlios.de  Mon Feb 13 16:35:16 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:35:16 +0100
Subject: [Xoops4-svn] r239 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering: . Pyro.xofrm Pyro.xofrm/Smarty.xoobj Pyro.xofrm/Smarty.xoobj/plugins Pyro.xofrm/Theme.xoobj
Message-ID: <200602131535.k1DFZGUQ026611@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:34:59 +0100 (Mon, 13 Feb 2006)
New Revision: 239

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/compiler.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php
Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/TreeWidget.xoobj/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php
Log:
Moving the low-level rendering frameworks to a dedicated folder

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm (from rev 217, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm)

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/compiler.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/compiler.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,38 +0,0 @@
-<?php
-/**
-* xoAppUrl Smarty compiler plug-in
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @package		xoops_template
-* @subpackage	xoops_template_Smarty
-* @since        2.3.0
-* @version		$Id$
-*/
-
-function smarty_compiler_xoAppUrl( $argStr, &$smarty ) {
-	global $xoops;
-	
-	$argStr = trim( $argStr );
-
-	@list( $modId, $location ) = explode( '#', $argStr, 2 );
-	if ( isset( $location ) ) {
-		if ( $module = $xoops->loadModule( $modId ) ) {
-			$uri = $module->xoBundleRoot;
-			if ( isset( $location ) && isset( $module->moduleLocations[$location] ) ) {
-				$uri .= $module->moduleLocations[$location]['scriptFile'];
-			}
-		}
-	} else {
-		$uri = $argStr;
-	}
-	
-	return "\necho '" . addslashes( $xoops->path( $uri, true ) ) . "';";
-
-}
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,67 +0,0 @@
-<?php
-/**
-* xoWidget Smarty compiler plug-in
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @package		xoops_template
-* @subpackage	xoops_template_Smarty
-* @since        2.3.0
-* @version		$Id$
-*/
-
-function smarty_compiler_xoWidget( $argStr, &$smarty ) {
-	global $xoops;
-	
-	$args = $smarty->_parse_attrs( trim( $argStr ) );
-	array_map( array( &$smarty, '_expand_quoted_text' ), $args );
-	
-	if ( !isset( $args['bundleId'] ) ) {
-		trigger_error( "Cannot insert widget: no bundleId specified", E_USER_WARNING );
-		return '';
-	}
-	$bundleId = $args['bundleId'];
-	unset( $args['bundleId'] );
-
-	$realBundleId = substr( $bundleId, 1, strlen( $bundleId ) - 2 );
-	
-	$code = "\n";
-	// Get this widget stylesheet and javascript properties
-	if ( $css = XOS::classVar( $realBundleId, 'stylesheet' ) ) {
-		$css = $realBundleId . '#' . $css;
-		$attrs = array(
-			'type' => 'text/css',
-			'href' => $xoops->url( $smarty->template_engine->currentTheme->resourcePath( $css ) ),
-		);
-		$code .= '$this->currentTheme->setMeta( "stylesheet", "' . $css . '", ' . var_export( $attrs, true ) . ");\n";
-	}
-	if ( $js = XOS::classVar( $realBundleId, 'javascript' ) ) {
-		$js = $realBundleId . '#' . $js;
-		$attrs = array(
-			'type' => 'text/javascript',
-			'src' => $xoops->url( $smarty->template_engine->currentTheme->resourcePath( $js ) ),
-		);
-		$code .= '$this->currentTheme->setMeta( "script", "' . $js . '", ' . var_export( $attrs, true ) . ");\n";
-	}
-
-
-	$code .= '$widget = XOS::create( ' . $bundleId;
-	if ( !empty( $args ) ) {
-		$code .= ", array(\n";
-		foreach ( $args as $prop => $value ) {
-			$code .= "\t'$prop' => " . $value . ",\n";
-		}
-		$code .= ')';
-	}
-	$code .= " );\n";
-	$code .= "echo ( \$widget ? \$widget->render() : \"Failed to instanciate $bundleId widget.\" );\n";
-	
-	return $code;
-
-}
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,111 +0,0 @@
-<?php
-/**
- * xoops_template_Smarty component main file
- *
- * See the enclosed file LICENSE for licensing information.
- * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
- *
- * @copyright   The Xoops project http://www.xoops.org/
- * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
- * @since       2.3.0
- * @package		xoops_template
- * @subpackage	xoops_template_Smarty
- * @version		$Id$
- * @author		Skalpa Keo <skalpa at xoops.org>
- */
-
-XOS::import( 'Smarty' );
-
-/**
- * XOOPS core default Smarty implementation
- * @since        2.3.0
- * @package		xoops_template
- * @subpackage	xoops_template_Smarty
- */
-class xoops_template_Smarty extends Smarty {
-	
-	var $left_delimiter =	'([';
-	var $right_delimiter =	'])';
-
-	var $template_dir		= XOOPS_THEME_PATH;
-	var $compile_dir		= 'var/Application Support/xoops_template_Smarty';
-	var $cache_dir			= 'var/Caches/xoops_template_Smarty';
-
-	var $use_sub_dirs		= false;
-	
-	
-	var $currentFile		= '';
-
-	/**
-	 * Theme to apply to this template (if any)
-	 * 
-	 * @var object
-	 */
-	var $currentTheme		= false;
-	
-
-	function xoops_template_Smarty( $options = null ) {
-		global $xoops;
-		
-		$this->compile_dir	= $xoops->path( $this->compile_dir );
-		$this->cache_dir	= $xoops->path( $this->cache_dir );
-
-		if ( $xoops->xoRunMode & XO_MODE_DEV_MASK ) {
-			$this->compile_check = true;
-			$this->force_compile = true;
-			//$this->debugging = true;
-		}
-		$this->Smarty();
-
-		$path = str_replace( DIRECTORY_SEPARATOR, '/', dirname( __FILE__ ) );
-
-		array_unshift( $this->plugins_dir, "$path/plugins" );
-		array_unshift( $this->plugins_dir, "$path/smarty/plugins" );
-		
-		$this->register_prefilter( array( &$this, 'filterOldTemplates' ) );
-		
-		$this->assign_by_ref( 'xoops', $xoops );
-	}
-
-	
-    function display( $resource_name = null, $cache_id = null, $compile_id = null) {
-        return $this->fetch( $resource_name, $cache_id, $compile_id, true );
-    }
-
-    function fetch( $resource_name = null, $cache_id = null, $compile_id = null, $display = false) {
-    	if ( !isset( $resource_name ) ) {
-    		$resource_name = $this->currentFile;
-    	} else {
-    		$this->currentFile = $resource_name;
-    	}
-    	return parent::fetch( $resource_name, $cache_id, $compile_id, $display );
-    }
-
-	/**
-	 * Render output from template data
-	 * 
-	 * @param   string  $data		The template to render
-	 * @param	bool	$display	If rendered text should be output or returned
-	 * @return  string  Rendered output if $display was false
-	 **/
-    function fetchFromData( $tplSource, $display = false ) {
-        if ( !function_exists('smarty_function_eval') ) {
-            require_once SMARTY_DIR . '/plugins/function.eval.php';
-        }
-        return smarty_function_eval( array('var' => $tplSource), $this );
-    }
-
-	/**
-	 * Compiler prefilter to change 2.0 style delimiters to new ones
-	 */
-    function filterOldTemplates( $data, &$compiler ) {
-    	$file = ( substr( $compiler->_current_file, 0, 6 ) == 'xotpl:' ) ? $compiler->template_engine->realTemplatePath : $compiler->_current_file;
-		if ( substr( $file, -6 ) != '.xotpl' ) {
-			$data = str_replace( array( '<{', '}>' ), array( '([', '])' ), $data );
-		}
-    	return $data;
-    }
-
-}
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/smarty.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/smarty.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,26 +0,0 @@
-<?php
-/**
-* xoops_template_Smarty bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo <skalpa at xoops.org>
-*/
-
-return array(
-	'xoBundleDisplayName' => 'Smarty template engine (XOOPS version)',
-	'xoBundleIdentifier' => 'xoops_template_Smarty',
-	'xoClassPath' => '/smarty.php',
-	'xoServices' => array(
-		'Smarty' => array(
-			'xoClassPath' => '/smarty/Smarty.class.php',
-		),
-	),
-);
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Smarty.xoobj/xo-info.php (from rev 230, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Smarty.xoobj/xo-info.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,420 +0,0 @@
-<?php
-/**
-* xoops_pyro_Theme component class file
-*
-* @copyright	The Xoops project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_Theme
-* @author       Skalpa Keo <skalpa at xoops.org>
-* @since        2.3.0
-* @version		$Id$
-*/
-
-/**
-* xoops_pyro_ThemeFactory
-*
-* @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_ThemeFactory
-* @since        2.3.0
-*/
-class xoops_pyro_ThemeFactory {
-	/**
-	 * Currently enabled themes (if empty, all the themes in themes/ are allowed)
-	 * 
-	 * @var array
-	 */
-	var $allowedThemes = array();
-	/**
-	 * Default theme to instanciate if none specified
-	 * 
-	 * @var string
-	 */
-	var $defaultTheme = 'default';
-
-	/**
-	 * Instanciate the specified theme
-	 */
-	function &createInstance( $options = array(), $initArgs = array() ) {
-		if ( @empty( $options['folderName'] ) ) {
-			//$options['folderName'] = $this->defaultTheme;
-			$options['folderName'] = $GLOBALS['xoopsConfig']['theme_set'];
-		} elseif ( !empty( $this->allowedThemes ) && !in_array( $options['folderName'], $this->allowedThemes ) ) {
-			$options['folderName'] = $this->defaultTheme;
-		}
-		$inst =& XOS::createInstanceOf( "xoops_pyro_Theme", $options, $initArgs );
-		return $inst;
-	}
-
-	/**
-	 * List the available themes
-	 *
-	 * @param	boolean $allowed Whether to return the allowed themes, or all of them
-	 *  @return	array
-	 */
-	function enumerate( $allowed = true ) {
-		global $xoops;
-		$themes = array();
-		if ( $dh = opendir( $xoops2->path('/themes/') ) ) {
-			while ( $file = readdir($dh) ) {
-				if ( $file{0} != '.' && $file != 'CVS' ) {
-					$themes[] = $file;
-				}
-			}
-			closedir( $dh );
-		}
-		if ( !empty($this->allowedThemes) && $allowed ) {
-			return array_intersect( $themes, $this->allowedThemes );
-		}
-		return $themes;
-	}
-
-}
-
-class xoops_pyro_Theme {
-   /**
-    * The name of this theme
-    * @var string
-    */
-	var $folderName = '';
-   /**
-    * Physical path of this theme folder
-    * @var string
-    */
-	var $path = '';
-	var $url = '';
-   /**
-   * Whether or not the theme engine should include the output generated by php
-   * @var string
-   */
-	var $bufferOutput = true;
-	/**
-	* Default content-type of pages generated by this theme
-	* @var string
-	*/
-	var $contentType = 'text/html';
-	/**
-	* Canvas-level template to use
-	* @var string
-	*/
-	var $canvasTemplate = '';
-	/**
-	* Page-level template to use
-	* @var string
-	*/
-	var $pageTemplate = '';
-	/**
-	* Content-level template to use
-	* @var string
-	*/
-	var $contentTemplate = '';
-	/**
-	* Text content to display right after the contentTemplate output
-	* @var string
-	*/
-	var $content = '';
-	/**
-	* The API version supported by this theme (used to achieve BC)
-	* @var string
-	*/
-	var $themeAPI = '2.3';
-	/**
-	* Name of this theme parent (if any)
-	* @var string
-	*/
-	var $parentTheme = '';
-	/**
-	* Array containing all this theme ancestors (parent,grand-parent,etc...)
-	* @var array
-	* @access protected
-	*/
-	var $parentInfos = array();
-	/**
-	* Page construction plug-ins to use
-	* @var array
-	* @access public
-	*/
-	var $plugins = array( 'xoops_logos_PageBuilder' );
-	
-	var $renderCount = 0;
-	/**
-	 * Pointer to the theme template engine
-	 *
-	 * @var object
-	 */
-	var $template = false;
-   /**#@-*/
-
-	function xoInit( $options = array() ) {
-		global $xoops;
-
-		$this->path	= $xoops->path( '/themes/' . $this->folderName );
-
-		$this->template =& XOS::create( 'xoops_template_Smarty' );
-		$this->template->currentTheme =& $this;
-		$this->template->compile_id = $this->folderName;
-
-		if ( $info = @include "$this->path/xo-info.php" ) {
-			XOS::apply( $this, $info );
-			if ( isset( $_SESSION ) ) {
-				unset( $_SESSION[$xoops->services['http']->xoBundleIdentifier]['tmpDisallowRedirections'] );
-			}
-		} else {
-			$this->themeAPI = '2.0';
-			$this->parentTheme = ( $this->folderName == 'xoops20' ? '' : 'xoops20' );
-			$_SESSION[$xoops->services['http']->xoBundleIdentifier]['tmpDisallowRedirections'] = true;
-		}
-		if ( $this->bufferOutput ) {
-			ob_start();
-		}
-		// Instanciate and initialize all the theme plugins
-		foreach ( $this->plugins as $k => $bundleId ) {
-			$this->plugins[$k] =& XOS::create( $bundleId, array( 'theme' => &$this ) );
-		}
-		return true;
-	}
-
-	/**
-	 * Render the page
-	 *
-	 * The theme engine builds pages from 3 templates: canvas, page and content.
-	 * 
-	 * The canvas template is the outermost one. It is the one containing the html container
-	 * elements (html,head,body), the header, footer and the left and right columns.
-	 * 
-	 * Standard themes should be delivered with the following canvas templates:
-	 * - canvas-default.xotpl: The "normal" template, used by most pages on a site
-	 * - canvas-dialog.xotpl: A lightweight canvas, without left and right columns, used by popups
-	 * - canvas-email.xotpl: The canvas used by e-mails sent by the site
-	 * 
-	 * The page template is the container for center blocks and the content. Themes don't have to
-	 * include several page templates, but applications may have their own page template that is
-	 * used instead of the default one (i.e: the XOOPS Management module).
-	 * 
-	 * A module can call this method directly and specify what templates the theme engine must use.
-	 * If render() hasn't been called before, the theme defaults will be used for the canvas and
-	 * page template (and xoopsOption['template_main'] for the content).
-	 * 
-	 * @param string $canvasTpl		The canvas template, if different from the theme default
-	 * @param string $pageTpl		The page template, if different from the theme default
-	 * @param string $contentTpl	The content template
-	 * @param array	 $vars			Template variables to send to the template engine
-	 */
-	function render( $canvasTpl = null, $pageTpl = null, $contentTpl = null, $vars = array() ) {
-		global $xoops;
-
-		if ( !$this->renderCount && $this->bufferOutput ) {
-			$this->content .= ob_get_contents();
-			ob_end_clean();
-		}
-		if ( $this->themeAPI != '2.3' ) {
-			include $xoops->path( $this->xoBundleRoot . '/render-' . $this->themeAPI . '.php' );
-		}
-		if ( !empty($canvasTpl) ) {
-			$this->canvasTemplate = $canvasTpl;
-		}
-		if ( !empty($pageTpl) ) {
-			$this->pageTemplate = $pageTpl;
-		}
-		if ( !empty($contentTpl) ) {
-			$this->contentTemplate = $contentTpl;
-		}
-		$vars['xoTheme']	=& $this;
-		/* this will be changed */
-		$vars['xoops_dirname'] = @!empty( $GLOBALS['xoopsModule'] ) ? $GLOBALS['xoopsModule']->getVar('dirname') : 'system';
-		$this->template->assign( $vars );
-		$this->renderZone( 'canvas' );
-		$this->renderCount++;
-	}
-	
-	/**
-	 * Render the specified page part
-	 * 
-	 * @param string $zone
-	 */
-	function renderZone( $zone ) {
-		switch ( $zone ) {
-		case 'canvas':
-			$this->renderCanvas();
-			break;
-		case 'page':
-			$this->renderPage();
-			echo $this->pageContent;
-			break;
-		case 'content':
-			$this->renderContent();
-		}
-	}
-	
-	function renderCanvas() {
-		$this->renderPage();
-		$this->template->display( $this->getZoneTemplate( 'canvas' ) );
-	}
-
-	function renderPage() {
-		ob_start();
-		if ( $tpl = $this->getZoneTemplate( 'page' ) ) {
-			$this->template->display( $tpl );
-		} else {
-			$this->renderContent();
-		}
-		$this->pageContent = ob_get_contents();
-		ob_end_clean();
-	}
-
-	function renderContent() {
-		if ( $tpl = $this->getZoneTemplate( 'content' ) ) {
-			$this->template->display( $tpl );
-		}
-		if ( !empty($this->content) ) {
-			echo $this->content;
-		}
-	}
-	
-	function getZoneTemplate( $zone ) {
-		global $xoops;
-		$zones = array( 'canvas' => 0, 'page' => 1, 'content' => 2 );
-		$tpl = '';
-		if ( isset( $zones[$zone] ) ) {
-			$tpl = $zone . 'Template';
-			$tpl = $this->$tpl;
-			if ( !empty( $tpl ) ) {
-				if ( substr( $tpl, 0, 1 ) == '.' ) {
-					$tpl = $xoops->path( $this->resourcePath( substr( $tpl, 1 ) ) );
-				} elseif ( !strpos( $tpl, ':' ) ) {
-					$tpl = 'xotpl:' . $tpl;
-				}
-			}
-		}
-		return $tpl;
-	}
-	
-	
-
-	function renderAttributes( $coll ) {
-		$str = '';
-		foreach ( $coll as $name => $val ) {
-			if ( $name != '_' ) {
-				$str .= ' ' . $name . '="' . htmlspecialchars( $val, ENT_QUOTES ) . '"';
-			}
-		}
-		return $str;
-	}
-	
-	
-	function resourcePath( $path, $fromDocRoot = true ) {
-		global $xoops;
-		
-		$parts = explode( '#', $path, 2 );
-		if ( count( $parts ) > 1 ) {
-			list( $bundleId, $resPath ) = $parts;
-			// This is component resource: modules are in 'modules', and components in 'components'
-			$themedRoot = ( substr( $parts[0], 0, 4 ) == 'mod_' ) ? 'modules' : 'components';
-			if ( file_exists( "$this->path/$themedRoot/$bundleId/$resPath" ) ) {
-				return "themes/$this->folderName/$themedRoot/$bundleId/$resPath";
-			} else {
-				return XOS::classVar( $bundleId, 'xoBundleRoot' ) . '/' . $resPath;
-			}
-		}		
-		if ( substr( $path, 0, 1 ) == '/' ) {
-			$path = substr( $path, 1 );
-			$fromDocRoot = false;
-		}
-		if ( file_exists( "$this->path/$path" ) ) {
-			return "themes/$this->folderName/$path";
-		}
-		if ( !empty( $this->parentTheme ) ) {
-			if ( !is_object( $this->parentTheme ) ) {
-				$this->parentTheme =& XOS::create( 'xoops_pyro_Theme', array( 'folderName' => $this->parentTheme ) );
-			}
-			if ( is_object( $this->parentTheme ) ) {
-				return $this->parentTheme->resourcePath( $path, $fromDocRoot );
-			}
-		}
-		return $fromDocRoot ? "www/$path" : "themes/$this->folderName/$path";
-	}
-	
-    /**
-    * Add Javascript file or JS code to the document head
-    *
-    * @param string $src path to .js file
-    * @param array $attributes name => value paired array of attributes such as title
-    * @param string $content JavaScript code to output between the tags
-    *
-    * @return void
-    **/
-    function addScript( $src = '', $attributes = array(), $content = '' ) {
-    	global $xoops;
-		if ( !empty( $src ) ) {
-			$attributes['src'] = $xoops->url( $this->resourcePath( $src ) );
-		}
-		if ( !empty( $content ) ) {
-			$attributes['_'] = $content;
-		}
-		if ( !isset( $attributes['type'] ) ) {
-			$attributes['type'] = 'text/javascript';
-		}
-		$this->setMeta( 'script', $src, $attributes );
-    }
-
-    /**
-    * Add StyleSheet or CSS code to the document head
-    *
-    * @param string $src path to .css file
-    * @param array $attributes name => value paired array of attributes such as title
-    * @param string $content CSS code to output between the <style> tags (in case $src is empty)
-    *
-    * @return void
-    **/
-    function addStylesheet( $src = '', $attributes = array(), $content = '' ) {
-    	global $xoops;
-		if ( !empty( $src ) ) {
-			$attributes['href'] = $xoops->url( $this->resourcePath( $src ) );
-		}
-		if ( !isset($attributes['type']) ) {
-			$attributes['type'] = 'text/css';
-		}
-		if ( !empty( $content ) ) {
-			$attributes['_'] = $content;
-		}
-    	$this->setMeta( 'stylesheet', $src, $attributes );
-    }
-	/**
-	 * Add a <link> to the header
-	 * 
-	 * @param string	$rel		Relationship from the current doc to the anchored one
-	 * @param string	$href		URI of the anchored document
-	 * @param array		$attributes	Additional attributes to add to the <link> element
-	 */
-	function addLink( $rel, $href = '', $attributes = array() ) {
-		global $xoops;
-		if ( !empty( $href ) ) {
-			$attributes['href'] = $href;
-		}
-		$this->setMeta( 'link', $rel, $attributes );
-	}
-    
-	/**
-	 * Change output page meta-information
-	 */
-    function setMeta( $type = 'meta', $name = '', $value = '' ) {
-		if ( !isset( $this->metas[$type] ) ) {
-			$this->metas[$type] = array();
-		}
-    	if ( isset($name) ) {
-			$this->metas[$type][$name] = $value;
-		} else {
-			$this->metas[$type][] = 	$value;
-		}
-		return $value;
-    }
-	
-
-	
-	
-
-}
-
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/theme.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/theme.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,27 +0,0 @@
-<?php
-/**
-* xoops_pyro_Theme bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo <skalpa at xoops.org>
-*/
-
-return array(
-	'xoBundleDisplayName' => 'XOOPS Theme component',
-	'xoBundleIdentifier' => 'xoops_pyro_Theme',
-	'xoClassPath' => '/theme.php',
-	'xoFactory' => 'xoops_pyro_ThemeFactory',
-	'xoServices' => array(
-		'xoops_pyro_ThemeFactory' => array(
-			'xoClassPath' => '/theme.php',
-		),
-	),
-);
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/Theme.xoobj/xo-info.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/Theme.xoobj/xo-info.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,82 +0,0 @@
-<?php
-/**
-* xoops_pyro_Widget component class file
-*
-* @copyright	The Xoops project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @package      xoops_pyro
-* @subpackage   xoops_pyro_Widget
-* @author       Skalpa Keo <skalpa at xoops.org>
-* @since        2.3.0
-* @version		$Id$
-*/
-
-/**
-* xoops_pyro_Widget
-*
-* Widgets are user interface components that can be rendered to HTML
-* 
-* 
-* 
-* 
-* @author 		Skalpa Keo
-* @package		xoops_pyro
-* @subpackage	xoops_pyro_Widget
-* @since        2.3.0
-*/
-class xoops_pyro_Widget {
-	/**
-	 * XMLID given to this widget main output element
-	 *
-	 * @var string
-	 */
-	var $elementId = '';
-	/**
-	 * Classes of this widget output element (when rendered to HTML)
-	 *
-	 * @var string[]
-	 */
-	var $elementClasses = array();
-	/**
-	 * Path to the stylesheet to add to the document when inserting this widget
-	 *
-	 * @var string
-	 */
-	var $stylesheet = '';
-	/**
-	 * Path to the javascript file to add to the document when inserting this widget
-	 *
-	 * @var string
-	 */
-	var $javascript = '';
-	/**
-	 * Template to use to render this widget (use hardcoded rendering if left empty)
-	 *
-	 * @var string
-	 */
-	var $template = '';
-	/**
-	 * Renders this widget
-	 */
-	function render() {
-		return '';
-	}
-	/**
-	 * Returns an XML opening tag with its 'id' and 'class' attributes set
-	 * @access protected
-	 */
-	function renderOpeningTag( $tagName ) {
-		$str = "<$tagName";
-		if ( $this->elementId ) {
-			$str .= ' id="' . $this->elementId . '"';
-		}
-		if ( !empty( $this->elementClasses ) ) {
-			$str .= ' class="' . implode( ' ', $this->elementClasses ) . '"';
-		}
-		return $str . '>';
-	}
-
-	
-	
-}
-

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/widget.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/widget.php)

Deleted: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php	2006-01-31 05:49:31 UTC (rev 217)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php	2006-02-13 15:34:59 UTC (rev 239)
@@ -1,34 +0,0 @@
-<?php
-/**
-* xoops_pyro bundle information file
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @since        2.3.0
-* @version		$Id$
-* @author		Skalpa Keo <skalpa at xoops.org>
-*/
-
-return array(
-	'xoBundleDisplayName' => '"Pyro" user interface framework',
-	'xoBundleIdentifier' => 'xoops_pyro',
-	'xoServices' => array(
-		'xoops_pyro_Theme'	=> array (
-			'xoBundleRoot' => '/Theme.xoobj'
-		),
-		'xoops_pyro_Widget' => array(
-			'xoClassPath' => '/widget.php',
-		),
-		'xoops_pyro_TreeWidget'	=> array (
-			'xoBundleRoot' => '/TreeWidget.xoobj'
-		),
-		'xoops_template_Smarty'	=> array (
-			'xoBundleRoot' => '/Smarty.xoobj'
-		),
-	),
-);
-
-?>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/xo-info.php (from rev 235, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Pyro.xofrm/xo-info.php)



From skalpa at berlios.de  Mon Feb 13 16:36:02 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:36:02 +0100
Subject: [Xoops4-svn] r240 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering
Message-ID: <200602131536.k1DFa2He026737@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:36:02 +0100 (Mon, 13 Feb 2006)
New Revision: 240

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/
Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm/
Log:
Moving the low-level rendering frameworks to a dedicated folder

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm (from rev 239, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Pyro.xofrm)



From skalpa at berlios.de  Mon Feb 13 16:41:12 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:41:12 +0100
Subject: [Xoops4-svn] r241 - XoopsCore/branches/tasks/123542-admin/XOOPS/Boot
Message-ID: <200602131541.k1DFfCSO027277@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:41:11 +0100 (Mon, 13 Feb 2006)
New Revision: 241

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/exxos.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/rc.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/xoops2.php
Log:
Renamed the XoopsOS layer folder

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/exxos.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/exxos.php	2006-02-13 15:36:02 UTC (rev 240)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/exxos.php	2006-02-13 15:41:11 UTC (rev 241)
@@ -114,7 +114,11 @@
 					$inst =& $me->factories[$id]->createInstance( $options );
 				}
 			} else {
-				$inst =& XOS::createInstanceOf( $id, $options, $args );
+				if ( isset( $me->registry[$id]['xoBundleIdentifier'] ) ) {
+					$inst =& XOS::createInstanceOf( $me->registry[$id]['xoBundleIdentifier'], $options, $args );
+				} else {
+					$inst =& XOS::createInstanceOf( $id, $options, $args );
+				}
 			}
 			if ( is_object( $inst ) ) {
 				if ( @$inst->xoSingleton ) {

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php	2006-02-13 15:36:02 UTC (rev 240)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php	2006-02-13 15:41:11 UTC (rev 241)
@@ -44,7 +44,7 @@
 	var $xoRunMode				= XO_MODE_PROD;
 	var $xoShortVersionString	= 'XOOPS 2.3.0-alpha1 "Cheerleaders"';
 
-	var $xoBundleRoot = 'XOOPS/Frameworks/XoopsCore/Foundation/Kernel.xofrm';
+	var $xoBundleRoot = 'XOOPS/Frameworks/XoopsCore/XoopsOS/Kernel.xofrm';
 	
 	/**
 	 * Current host identifier
@@ -95,7 +95,7 @@
 		'http'		=> 'xoops_http_HttpHandler',
 		'session'	=> 'xoops_http_SessionService',
 		'auth'		=> 'xoops_auth_AuthenticationService',
-		'theme'		=> 'xoops_pyro_Theme',
+		'theme'		=> 'xoops_opal_Theme',
 		'legacydb'	=> array( 'xoops_db_Database', array( 'driverName' => 'xoops.legacy' ) ),
 	);
 	/** 
@@ -170,6 +170,9 @@
 	 	$this->hostId = $hostId;
 	 	XOS::apply( $this, $hostVars );
 	 	
+		if ( @$GLOBALS['xoPreventDevMode'] ) {
+			$this->xoRunMode = 0;
+		}
 	 	// Enable error reporting by default in development mode, enable it otherwise
  		error_reporting( ( $this->xoRunMode == XO_MODE_DEV ) ? E_ALL : 0 );
 
@@ -278,6 +281,9 @@
 		if ( !$module ) {
 			$this->services['http']->sendResponse( 500, null, -1 );
 		} else {
+			if ( method_exists( $module, 'xoRunModule' ) && !call_user_func( array( &$module, 'xoRunModule' ) ) ) {
+				return false;
+			}
 			//if ( !$module->checkAccess() ) {
 				//$this->services['http']->sendResponse( 403, null, -1 );
 			//} else {
@@ -376,7 +382,9 @@
 				'fullName' => $user->getVar( 'name', 'n' ),
 				'level' => $lvl_lookup[ $user->getVar( 'level', 'n' ) ],
 			) );
-			
+			if ( isset( $this->services['http'] ) ) {
+				$this->services['http']->addVariation( 'xo-user', $this->currentUser->userId );
+			}
 			if ( $permanent && $this->services['session'] ) {
 				$this->services['session']->start();
 				$_SESSION[$this->xoBundleIdentifier]['currentUser'] = $login;
@@ -416,8 +424,25 @@
 			}
 		} else {
 			$root = XOS::classVar( $parts[0], 'xoBundleRoot' );
-			return $this->path( $root . '/' . $parts[1], $virtual );
+			@list( $location, $query ) = explode( '?', $parts[1] );
+			if ( empty($location) || strpos( $location, '/' ) !== false ) {
+				return $this->path( $root . '/' . $location, $virtual );
+			}
+			if ( $module = $this->loadModule( $parts[0] ) ) {
+				$uri = $module->xoBundleRoot;
+				if ( isset( $module->moduleLocations[$location] ) ) {
+					$uri .= $module->moduleLocations[$location]['scriptFile'];
+				} else {
+					trigger_error( "Unknown location {$parts[0]}#$location", E_USER_WARNING );
+					return false;
+				}
+				if ( isset($query ) ) {
+					$uri .= ( strpos( $uri, '?' ) ? '&' : '?' ) . $query;
+				}
+				return $this->path( $uri, $virtual );
+			}
 		}
+		return false;
 	}
 	/**
 	* Convert a XOOPS path to an URL

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/rc.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/rc.php	2006-02-13 15:36:02 UTC (rev 240)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/rc.php	2006-02-13 15:41:11 UTC (rev 241)
@@ -19,21 +19,27 @@
 if ( !defined( 'XOOPS_PATH' ) ) exit();
 
 
+if ( isset( $_SERVER['SERVER_NAME'] ) ) {
+	// If we're not using the cli sapi, instanciate the http service
+	$this->loadService( 'http' );
+}
+
 if ( $this->xoRunMode ) {
 	// If the server is not in production mode, instanciate the logger and error handling services	
 	$this->loadService( 'logger' );
 	$this->loadService( 'error' );
 }
 
-if ( isset( $_SERVER['SERVER_NAME'] ) ) {
-	// If we're not using the cli sapi, instanciate the http related services
+if ( isset( $this->services['http'] ) ) {
 	$this->loadService( 'session' );
-	$this->loadService( 'http' );
+	
+	if ( isset( $_SESSION ) ) {
+		$this->services['http']->reloadSessionState();
+	}
 	// Wake up user if info is found in the session
 	if ( isset( $_SESSION[$this->xoBundleIdentifier]['currentUser'] ) ) {
 		$this->acceptUser( $_SESSION[$this->xoBundleIdentifier]['currentUser'], true );
 	}
-
 }
 
 

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/xoops2.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/xoops2.php	2006-02-13 15:36:02 UTC (rev 240)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/xoops2.php	2006-02-13 15:41:11 UTC (rev 241)
@@ -66,6 +66,8 @@
 		$vars['hostLocation']	= $vars['hostLocation'][$aliasNum];
 		$vars['secureLocation'] = $vars['secureLocation'][$aliasNum];
 		$vars['isSecure'] = $reqSecure;
+		$vars['hostsList'] = array_keys( $hostsInfo );
+		unset( $vars['hostsList'][''] );
 		// Instanciate the kernel
 		new xoops_kernel_Xoops2( $hostId, $vars );
 		return true;



From skalpa at berlios.de  Mon Feb 13 16:41:43 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:41:43 +0100
Subject: [Xoops4-svn] r242 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore
Message-ID: <200602131541.k1DFfhXR027342@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:41:43 +0100 (Mon, 13 Feb 2006)
New Revision: 242

Removed:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation/
Log:
Renamed the XoopsOS layer folder



From skalpa at berlios.de  Mon Feb 13 16:41:57 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Mon, 13 Feb 2006 16:41:57 +0100
Subject: [Xoops4-svn] r243 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore
Message-ID: <200602131541.k1DFfvdW027375@sheep.berlios.de>

Author: skalpa
Date: 2006-02-13 16:41:57 +0100 (Mon, 13 Feb 2006)
New Revision: 243

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/XoopsOS/
Log:
Renamed the XoopsOS layer folder

Copied: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/XoopsOS (from rev 240, XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/Foundation)



From skalpa at berlios.de  Thu Feb 16 06:05:29 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Thu, 16 Feb 2006 06:05:29 +0100
Subject: [Xoops4-svn] r244 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm: . PdfMaker.xoobj PdfMaker.xoobj/fpdf PdfMaker.xoobj/fpdf/font PdfMaker.xoobj/fpdf/font/makefont
Message-ID: <200602160505.k1G55TCY014610@sheep.berlios.de>

Author: skalpa
Date: 2006-02-16 06:05:19 +0100 (Thu, 16 Feb 2006)
New Revision: 244

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/courier.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helvetica.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticab.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticabi.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticai.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1250.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1251.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1252.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1253.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1254.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1255.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1257.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1258.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp874.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-1.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-11.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-15.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-16.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-2.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-4.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-5.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-7.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-9.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-r.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-u.map
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/makefont.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/symbol.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/times.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesb.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesbi.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesi.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/zapfdingbats.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/fpdf.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdfmaker.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdml.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/xo-info.php
Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/xo-info.php
Log:
Added a standard PDF generation component based on FPDF+PDML. It's called by the theme engine to post-process output if PDF generation is requested.

Right now, I'm not sure of what PDML is really worth, so it's dimmed "experimental"... anyway, at least it provides an FPDF distro so module devs won't have to include the class in their modules anymore.

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/courier.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/courier.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/courier.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,7 @@
+<?php
+for($i=0;$i<=255;$i++)
+	$fpdf_charwidths['courier'][chr($i)]=600;
+$fpdf_charwidths['courierB']=$fpdf_charwidths['courier'];
+$fpdf_charwidths['courierI']=$fpdf_charwidths['courier'];
+$fpdf_charwidths['courierBI']=$fpdf_charwidths['courier'];
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/courier.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helvetica.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helvetica.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helvetica.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['helvetica']=array(
+	chr(0)=>278,chr(1)=>278,chr(2)=>278,chr(3)=>278,chr(4)=>278,chr(5)=>278,chr(6)=>278,chr(7)=>278,chr(8)=>278,chr(9)=>278,chr(10)=>278,chr(11)=>278,chr(12)=>278,chr(13)=>278,chr(14)=>278,chr(15)=>278,chr(16)=>278,chr(17)=>278,chr(18)=>278,chr(19)=>278,chr(20)=>278,chr(21)=>278,
+	chr(22)=>278,chr(23)=>278,chr(24)=>278,chr(25)=>278,chr(26)=>278,chr(27)=>278,chr(28)=>278,chr(29)=>278,chr(30)=>278,chr(31)=>278,' '=>278,'!'=>278,'"'=>355,'#'=>556,'$'=>556,'%'=>889,'&'=>667,'\''=>191,'('=>333,')'=>333,'*'=>389,'+'=>584,
+	','=>278,'-'=>333,'.'=>278,'/'=>278,'0'=>556,'1'=>556,'2'=>556,'3'=>556,'4'=>556,'5'=>556,'6'=>556,'7'=>556,'8'=>556,'9'=>556,':'=>278,';'=>278,'<'=>584,'='=>584,'>'=>584,'?'=>556,'@'=>1015,'A'=>667,
+	'B'=>667,'C'=>722,'D'=>722,'E'=>667,'F'=>611,'G'=>778,'H'=>722,'I'=>278,'J'=>500,'K'=>667,'L'=>556,'M'=>833,'N'=>722,'O'=>778,'P'=>667,'Q'=>778,'R'=>722,'S'=>667,'T'=>611,'U'=>722,'V'=>667,'W'=>944,
+	'X'=>667,'Y'=>667,'Z'=>611,'['=>278,'\\'=>278,']'=>278,'^'=>469,'_'=>556,'`'=>333,'a'=>556,'b'=>556,'c'=>500,'d'=>556,'e'=>556,'f'=>278,'g'=>556,'h'=>556,'i'=>222,'j'=>222,'k'=>500,'l'=>222,'m'=>833,
+	'n'=>556,'o'=>556,'p'=>556,'q'=>556,'r'=>333,'s'=>500,'t'=>278,'u'=>556,'v'=>500,'w'=>722,'x'=>500,'y'=>500,'z'=>500,'{'=>334,'|'=>260,'}'=>334,'~'=>584,chr(127)=>350,chr(128)=>556,chr(129)=>350,chr(130)=>222,chr(131)=>556,
+	chr(132)=>333,chr(133)=>1000,chr(134)=>556,chr(135)=>556,chr(136)=>333,chr(137)=>1000,chr(138)=>667,chr(139)=>333,chr(140)=>1000,chr(141)=>350,chr(142)=>611,chr(143)=>350,chr(144)=>350,chr(145)=>222,chr(146)=>222,chr(147)=>333,chr(148)=>333,chr(149)=>350,chr(150)=>556,chr(151)=>1000,chr(152)=>333,chr(153)=>1000,
+	chr(154)=>500,chr(155)=>333,chr(156)=>944,chr(157)=>350,chr(158)=>500,chr(159)=>667,chr(160)=>278,chr(161)=>333,chr(162)=>556,chr(163)=>556,chr(164)=>556,chr(165)=>556,chr(166)=>260,chr(167)=>556,chr(168)=>333,chr(169)=>737,chr(170)=>370,chr(171)=>556,chr(172)=>584,chr(173)=>333,chr(174)=>737,chr(175)=>333,
+	chr(176)=>400,chr(177)=>584,chr(178)=>333,chr(179)=>333,chr(180)=>333,chr(181)=>556,chr(182)=>537,chr(183)=>278,chr(184)=>333,chr(185)=>333,chr(186)=>365,chr(187)=>556,chr(188)=>834,chr(189)=>834,chr(190)=>834,chr(191)=>611,chr(192)=>667,chr(193)=>667,chr(194)=>667,chr(195)=>667,chr(196)=>667,chr(197)=>667,
+	chr(198)=>1000,chr(199)=>722,chr(200)=>667,chr(201)=>667,chr(202)=>667,chr(203)=>667,chr(204)=>278,chr(205)=>278,chr(206)=>278,chr(207)=>278,chr(208)=>722,chr(209)=>722,chr(210)=>778,chr(211)=>778,chr(212)=>778,chr(213)=>778,chr(214)=>778,chr(215)=>584,chr(216)=>778,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>667,chr(222)=>667,chr(223)=>611,chr(224)=>556,chr(225)=>556,chr(226)=>556,chr(227)=>556,chr(228)=>556,chr(229)=>556,chr(230)=>889,chr(231)=>500,chr(232)=>556,chr(233)=>556,chr(234)=>556,chr(235)=>556,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>556,chr(241)=>556,
+	chr(242)=>556,chr(243)=>556,chr(244)=>556,chr(245)=>556,chr(246)=>556,chr(247)=>584,chr(248)=>611,chr(249)=>556,chr(250)=>556,chr(251)=>556,chr(252)=>556,chr(253)=>500,chr(254)=>556,chr(255)=>500);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helvetica.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticab.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticab.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticab.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['helveticaB']=array(
+	chr(0)=>278,chr(1)=>278,chr(2)=>278,chr(3)=>278,chr(4)=>278,chr(5)=>278,chr(6)=>278,chr(7)=>278,chr(8)=>278,chr(9)=>278,chr(10)=>278,chr(11)=>278,chr(12)=>278,chr(13)=>278,chr(14)=>278,chr(15)=>278,chr(16)=>278,chr(17)=>278,chr(18)=>278,chr(19)=>278,chr(20)=>278,chr(21)=>278,
+	chr(22)=>278,chr(23)=>278,chr(24)=>278,chr(25)=>278,chr(26)=>278,chr(27)=>278,chr(28)=>278,chr(29)=>278,chr(30)=>278,chr(31)=>278,' '=>278,'!'=>333,'"'=>474,'#'=>556,'$'=>556,'%'=>889,'&'=>722,'\''=>238,'('=>333,')'=>333,'*'=>389,'+'=>584,
+	','=>278,'-'=>333,'.'=>278,'/'=>278,'0'=>556,'1'=>556,'2'=>556,'3'=>556,'4'=>556,'5'=>556,'6'=>556,'7'=>556,'8'=>556,'9'=>556,':'=>333,';'=>333,'<'=>584,'='=>584,'>'=>584,'?'=>611,'@'=>975,'A'=>722,
+	'B'=>722,'C'=>722,'D'=>722,'E'=>667,'F'=>611,'G'=>778,'H'=>722,'I'=>278,'J'=>556,'K'=>722,'L'=>611,'M'=>833,'N'=>722,'O'=>778,'P'=>667,'Q'=>778,'R'=>722,'S'=>667,'T'=>611,'U'=>722,'V'=>667,'W'=>944,
+	'X'=>667,'Y'=>667,'Z'=>611,'['=>333,'\\'=>278,']'=>333,'^'=>584,'_'=>556,'`'=>333,'a'=>556,'b'=>611,'c'=>556,'d'=>611,'e'=>556,'f'=>333,'g'=>611,'h'=>611,'i'=>278,'j'=>278,'k'=>556,'l'=>278,'m'=>889,
+	'n'=>611,'o'=>611,'p'=>611,'q'=>611,'r'=>389,'s'=>556,'t'=>333,'u'=>611,'v'=>556,'w'=>778,'x'=>556,'y'=>556,'z'=>500,'{'=>389,'|'=>280,'}'=>389,'~'=>584,chr(127)=>350,chr(128)=>556,chr(129)=>350,chr(130)=>278,chr(131)=>556,
+	chr(132)=>500,chr(133)=>1000,chr(134)=>556,chr(135)=>556,chr(136)=>333,chr(137)=>1000,chr(138)=>667,chr(139)=>333,chr(140)=>1000,chr(141)=>350,chr(142)=>611,chr(143)=>350,chr(144)=>350,chr(145)=>278,chr(146)=>278,chr(147)=>500,chr(148)=>500,chr(149)=>350,chr(150)=>556,chr(151)=>1000,chr(152)=>333,chr(153)=>1000,
+	chr(154)=>556,chr(155)=>333,chr(156)=>944,chr(157)=>350,chr(158)=>500,chr(159)=>667,chr(160)=>278,chr(161)=>333,chr(162)=>556,chr(163)=>556,chr(164)=>556,chr(165)=>556,chr(166)=>280,chr(167)=>556,chr(168)=>333,chr(169)=>737,chr(170)=>370,chr(171)=>556,chr(172)=>584,chr(173)=>333,chr(174)=>737,chr(175)=>333,
+	chr(176)=>400,chr(177)=>584,chr(178)=>333,chr(179)=>333,chr(180)=>333,chr(181)=>611,chr(182)=>556,chr(183)=>278,chr(184)=>333,chr(185)=>333,chr(186)=>365,chr(187)=>556,chr(188)=>834,chr(189)=>834,chr(190)=>834,chr(191)=>611,chr(192)=>722,chr(193)=>722,chr(194)=>722,chr(195)=>722,chr(196)=>722,chr(197)=>722,
+	chr(198)=>1000,chr(199)=>722,chr(200)=>667,chr(201)=>667,chr(202)=>667,chr(203)=>667,chr(204)=>278,chr(205)=>278,chr(206)=>278,chr(207)=>278,chr(208)=>722,chr(209)=>722,chr(210)=>778,chr(211)=>778,chr(212)=>778,chr(213)=>778,chr(214)=>778,chr(215)=>584,chr(216)=>778,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>667,chr(222)=>667,chr(223)=>611,chr(224)=>556,chr(225)=>556,chr(226)=>556,chr(227)=>556,chr(228)=>556,chr(229)=>556,chr(230)=>889,chr(231)=>556,chr(232)=>556,chr(233)=>556,chr(234)=>556,chr(235)=>556,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>611,chr(241)=>611,
+	chr(242)=>611,chr(243)=>611,chr(244)=>611,chr(245)=>611,chr(246)=>611,chr(247)=>584,chr(248)=>611,chr(249)=>611,chr(250)=>611,chr(251)=>611,chr(252)=>611,chr(253)=>556,chr(254)=>611,chr(255)=>556);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticab.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticabi.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticabi.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticabi.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['helveticaBI']=array(
+	chr(0)=>278,chr(1)=>278,chr(2)=>278,chr(3)=>278,chr(4)=>278,chr(5)=>278,chr(6)=>278,chr(7)=>278,chr(8)=>278,chr(9)=>278,chr(10)=>278,chr(11)=>278,chr(12)=>278,chr(13)=>278,chr(14)=>278,chr(15)=>278,chr(16)=>278,chr(17)=>278,chr(18)=>278,chr(19)=>278,chr(20)=>278,chr(21)=>278,
+	chr(22)=>278,chr(23)=>278,chr(24)=>278,chr(25)=>278,chr(26)=>278,chr(27)=>278,chr(28)=>278,chr(29)=>278,chr(30)=>278,chr(31)=>278,' '=>278,'!'=>333,'"'=>474,'#'=>556,'$'=>556,'%'=>889,'&'=>722,'\''=>238,'('=>333,')'=>333,'*'=>389,'+'=>584,
+	','=>278,'-'=>333,'.'=>278,'/'=>278,'0'=>556,'1'=>556,'2'=>556,'3'=>556,'4'=>556,'5'=>556,'6'=>556,'7'=>556,'8'=>556,'9'=>556,':'=>333,';'=>333,'<'=>584,'='=>584,'>'=>584,'?'=>611,'@'=>975,'A'=>722,
+	'B'=>722,'C'=>722,'D'=>722,'E'=>667,'F'=>611,'G'=>778,'H'=>722,'I'=>278,'J'=>556,'K'=>722,'L'=>611,'M'=>833,'N'=>722,'O'=>778,'P'=>667,'Q'=>778,'R'=>722,'S'=>667,'T'=>611,'U'=>722,'V'=>667,'W'=>944,
+	'X'=>667,'Y'=>667,'Z'=>611,'['=>333,'\\'=>278,']'=>333,'^'=>584,'_'=>556,'`'=>333,'a'=>556,'b'=>611,'c'=>556,'d'=>611,'e'=>556,'f'=>333,'g'=>611,'h'=>611,'i'=>278,'j'=>278,'k'=>556,'l'=>278,'m'=>889,
+	'n'=>611,'o'=>611,'p'=>611,'q'=>611,'r'=>389,'s'=>556,'t'=>333,'u'=>611,'v'=>556,'w'=>778,'x'=>556,'y'=>556,'z'=>500,'{'=>389,'|'=>280,'}'=>389,'~'=>584,chr(127)=>350,chr(128)=>556,chr(129)=>350,chr(130)=>278,chr(131)=>556,
+	chr(132)=>500,chr(133)=>1000,chr(134)=>556,chr(135)=>556,chr(136)=>333,chr(137)=>1000,chr(138)=>667,chr(139)=>333,chr(140)=>1000,chr(141)=>350,chr(142)=>611,chr(143)=>350,chr(144)=>350,chr(145)=>278,chr(146)=>278,chr(147)=>500,chr(148)=>500,chr(149)=>350,chr(150)=>556,chr(151)=>1000,chr(152)=>333,chr(153)=>1000,
+	chr(154)=>556,chr(155)=>333,chr(156)=>944,chr(157)=>350,chr(158)=>500,chr(159)=>667,chr(160)=>278,chr(161)=>333,chr(162)=>556,chr(163)=>556,chr(164)=>556,chr(165)=>556,chr(166)=>280,chr(167)=>556,chr(168)=>333,chr(169)=>737,chr(170)=>370,chr(171)=>556,chr(172)=>584,chr(173)=>333,chr(174)=>737,chr(175)=>333,
+	chr(176)=>400,chr(177)=>584,chr(178)=>333,chr(179)=>333,chr(180)=>333,chr(181)=>611,chr(182)=>556,chr(183)=>278,chr(184)=>333,chr(185)=>333,chr(186)=>365,chr(187)=>556,chr(188)=>834,chr(189)=>834,chr(190)=>834,chr(191)=>611,chr(192)=>722,chr(193)=>722,chr(194)=>722,chr(195)=>722,chr(196)=>722,chr(197)=>722,
+	chr(198)=>1000,chr(199)=>722,chr(200)=>667,chr(201)=>667,chr(202)=>667,chr(203)=>667,chr(204)=>278,chr(205)=>278,chr(206)=>278,chr(207)=>278,chr(208)=>722,chr(209)=>722,chr(210)=>778,chr(211)=>778,chr(212)=>778,chr(213)=>778,chr(214)=>778,chr(215)=>584,chr(216)=>778,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>667,chr(222)=>667,chr(223)=>611,chr(224)=>556,chr(225)=>556,chr(226)=>556,chr(227)=>556,chr(228)=>556,chr(229)=>556,chr(230)=>889,chr(231)=>556,chr(232)=>556,chr(233)=>556,chr(234)=>556,chr(235)=>556,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>611,chr(241)=>611,
+	chr(242)=>611,chr(243)=>611,chr(244)=>611,chr(245)=>611,chr(246)=>611,chr(247)=>584,chr(248)=>611,chr(249)=>611,chr(250)=>611,chr(251)=>611,chr(252)=>611,chr(253)=>556,chr(254)=>611,chr(255)=>556);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticabi.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticai.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticai.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticai.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['helveticaI']=array(
+	chr(0)=>278,chr(1)=>278,chr(2)=>278,chr(3)=>278,chr(4)=>278,chr(5)=>278,chr(6)=>278,chr(7)=>278,chr(8)=>278,chr(9)=>278,chr(10)=>278,chr(11)=>278,chr(12)=>278,chr(13)=>278,chr(14)=>278,chr(15)=>278,chr(16)=>278,chr(17)=>278,chr(18)=>278,chr(19)=>278,chr(20)=>278,chr(21)=>278,
+	chr(22)=>278,chr(23)=>278,chr(24)=>278,chr(25)=>278,chr(26)=>278,chr(27)=>278,chr(28)=>278,chr(29)=>278,chr(30)=>278,chr(31)=>278,' '=>278,'!'=>278,'"'=>355,'#'=>556,'$'=>556,'%'=>889,'&'=>667,'\''=>191,'('=>333,')'=>333,'*'=>389,'+'=>584,
+	','=>278,'-'=>333,'.'=>278,'/'=>278,'0'=>556,'1'=>556,'2'=>556,'3'=>556,'4'=>556,'5'=>556,'6'=>556,'7'=>556,'8'=>556,'9'=>556,':'=>278,';'=>278,'<'=>584,'='=>584,'>'=>584,'?'=>556,'@'=>1015,'A'=>667,
+	'B'=>667,'C'=>722,'D'=>722,'E'=>667,'F'=>611,'G'=>778,'H'=>722,'I'=>278,'J'=>500,'K'=>667,'L'=>556,'M'=>833,'N'=>722,'O'=>778,'P'=>667,'Q'=>778,'R'=>722,'S'=>667,'T'=>611,'U'=>722,'V'=>667,'W'=>944,
+	'X'=>667,'Y'=>667,'Z'=>611,'['=>278,'\\'=>278,']'=>278,'^'=>469,'_'=>556,'`'=>333,'a'=>556,'b'=>556,'c'=>500,'d'=>556,'e'=>556,'f'=>278,'g'=>556,'h'=>556,'i'=>222,'j'=>222,'k'=>500,'l'=>222,'m'=>833,
+	'n'=>556,'o'=>556,'p'=>556,'q'=>556,'r'=>333,'s'=>500,'t'=>278,'u'=>556,'v'=>500,'w'=>722,'x'=>500,'y'=>500,'z'=>500,'{'=>334,'|'=>260,'}'=>334,'~'=>584,chr(127)=>350,chr(128)=>556,chr(129)=>350,chr(130)=>222,chr(131)=>556,
+	chr(132)=>333,chr(133)=>1000,chr(134)=>556,chr(135)=>556,chr(136)=>333,chr(137)=>1000,chr(138)=>667,chr(139)=>333,chr(140)=>1000,chr(141)=>350,chr(142)=>611,chr(143)=>350,chr(144)=>350,chr(145)=>222,chr(146)=>222,chr(147)=>333,chr(148)=>333,chr(149)=>350,chr(150)=>556,chr(151)=>1000,chr(152)=>333,chr(153)=>1000,
+	chr(154)=>500,chr(155)=>333,chr(156)=>944,chr(157)=>350,chr(158)=>500,chr(159)=>667,chr(160)=>278,chr(161)=>333,chr(162)=>556,chr(163)=>556,chr(164)=>556,chr(165)=>556,chr(166)=>260,chr(167)=>556,chr(168)=>333,chr(169)=>737,chr(170)=>370,chr(171)=>556,chr(172)=>584,chr(173)=>333,chr(174)=>737,chr(175)=>333,
+	chr(176)=>400,chr(177)=>584,chr(178)=>333,chr(179)=>333,chr(180)=>333,chr(181)=>556,chr(182)=>537,chr(183)=>278,chr(184)=>333,chr(185)=>333,chr(186)=>365,chr(187)=>556,chr(188)=>834,chr(189)=>834,chr(190)=>834,chr(191)=>611,chr(192)=>667,chr(193)=>667,chr(194)=>667,chr(195)=>667,chr(196)=>667,chr(197)=>667,
+	chr(198)=>1000,chr(199)=>722,chr(200)=>667,chr(201)=>667,chr(202)=>667,chr(203)=>667,chr(204)=>278,chr(205)=>278,chr(206)=>278,chr(207)=>278,chr(208)=>722,chr(209)=>722,chr(210)=>778,chr(211)=>778,chr(212)=>778,chr(213)=>778,chr(214)=>778,chr(215)=>584,chr(216)=>778,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>667,chr(222)=>667,chr(223)=>611,chr(224)=>556,chr(225)=>556,chr(226)=>556,chr(227)=>556,chr(228)=>556,chr(229)=>556,chr(230)=>889,chr(231)=>500,chr(232)=>556,chr(233)=>556,chr(234)=>556,chr(235)=>556,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>556,chr(241)=>556,
+	chr(242)=>556,chr(243)=>556,chr(244)=>556,chr(245)=>556,chr(246)=>556,chr(247)=>584,chr(248)=>611,chr(249)=>556,chr(250)=>556,chr(251)=>556,chr(252)=>556,chr(253)=>500,chr(254)=>556,chr(255)=>500);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/helveticai.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1250.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1250.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1250.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,251 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!82 U+201A quotesinglbase
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!89 U+2030 perthousand
+!8A U+0160 Scaron
+!8B U+2039 guilsinglleft
+!8C U+015A Sacute
+!8D U+0164 Tcaron
+!8E U+017D Zcaron
+!8F U+0179 Zacute
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!99 U+2122 trademark
+!9A U+0161 scaron
+!9B U+203A guilsinglright
+!9C U+015B sacute
+!9D U+0165 tcaron
+!9E U+017E zcaron
+!9F U+017A zacute
+!A0 U+00A0 space
+!A1 U+02C7 caron
+!A2 U+02D8 breve
+!A3 U+0141 Lslash
+!A4 U+00A4 currency
+!A5 U+0104 Aogonek
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AA U+015E Scedilla
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+017B Zdotaccent
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+02DB ogonek
+!B3 U+0142 lslash
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+00B8 cedilla
+!B9 U+0105 aogonek
+!BA U+015F scedilla
+!BB U+00BB guillemotright
+!BC U+013D Lcaron
+!BD U+02DD hungarumlaut
+!BE U+013E lcaron
+!BF U+017C zdotaccent
+!C0 U+0154 Racute
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+0102 Abreve
+!C4 U+00C4 Adieresis
+!C5 U+0139 Lacute
+!C6 U+0106 Cacute
+!C7 U+00C7 Ccedilla
+!C8 U+010C Ccaron
+!C9 U+00C9 Eacute
+!CA U+0118 Eogonek
+!CB U+00CB Edieresis
+!CC U+011A Ecaron
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+010E Dcaron
+!D0 U+0110 Dcroat
+!D1 U+0143 Nacute
+!D2 U+0147 Ncaron
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+0150 Ohungarumlaut
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+0158 Rcaron
+!D9 U+016E Uring
+!DA U+00DA Uacute
+!DB U+0170 Uhungarumlaut
+!DC U+00DC Udieresis
+!DD U+00DD Yacute
+!DE U+0162 Tcommaaccent
+!DF U+00DF germandbls
+!E0 U+0155 racute
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+0103 abreve
+!E4 U+00E4 adieresis
+!E5 U+013A lacute
+!E6 U+0107 cacute
+!E7 U+00E7 ccedilla
+!E8 U+010D ccaron
+!E9 U+00E9 eacute
+!EA U+0119 eogonek
+!EB U+00EB edieresis
+!EC U+011B ecaron
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+010F dcaron
+!F0 U+0111 dcroat
+!F1 U+0144 nacute
+!F2 U+0148 ncaron
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+0151 ohungarumlaut
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+0159 rcaron
+!F9 U+016F uring
+!FA U+00FA uacute
+!FB U+0171 uhungarumlaut
+!FC U+00FC udieresis
+!FD U+00FD yacute
+!FE U+0163 tcommaaccent
+!FF U+02D9 dotaccent

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1251.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1251.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1251.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,255 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0402 afii10051
+!81 U+0403 afii10052
+!82 U+201A quotesinglbase
+!83 U+0453 afii10100
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!88 U+20AC Euro
+!89 U+2030 perthousand
+!8A U+0409 afii10058
+!8B U+2039 guilsinglleft
+!8C U+040A afii10059
+!8D U+040C afii10061
+!8E U+040B afii10060
+!8F U+040F afii10145
+!90 U+0452 afii10099
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!99 U+2122 trademark
+!9A U+0459 afii10106
+!9B U+203A guilsinglright
+!9C U+045A afii10107
+!9D U+045C afii10109
+!9E U+045B afii10108
+!9F U+045F afii10193
+!A0 U+00A0 space
+!A1 U+040E afii10062
+!A2 U+045E afii10110
+!A3 U+0408 afii10057
+!A4 U+00A4 currency
+!A5 U+0490 afii10050
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+0401 afii10023
+!A9 U+00A9 copyright
+!AA U+0404 afii10053
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+0407 afii10056
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+0406 afii10055
+!B3 U+0456 afii10103
+!B4 U+0491 afii10098
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+0451 afii10071
+!B9 U+2116 afii61352
+!BA U+0454 afii10101
+!BB U+00BB guillemotright
+!BC U+0458 afii10105
+!BD U+0405 afii10054
+!BE U+0455 afii10102
+!BF U+0457 afii10104
+!C0 U+0410 afii10017
+!C1 U+0411 afii10018
+!C2 U+0412 afii10019
+!C3 U+0413 afii10020
+!C4 U+0414 afii10021
+!C5 U+0415 afii10022
+!C6 U+0416 afii10024
+!C7 U+0417 afii10025
+!C8 U+0418 afii10026
+!C9 U+0419 afii10027
+!CA U+041A afii10028
+!CB U+041B afii10029
+!CC U+041C afii10030
+!CD U+041D afii10031
+!CE U+041E afii10032
+!CF U+041F afii10033
+!D0 U+0420 afii10034
+!D1 U+0421 afii10035
+!D2 U+0422 afii10036
+!D3 U+0423 afii10037
+!D4 U+0424 afii10038
+!D5 U+0425 afii10039
+!D6 U+0426 afii10040
+!D7 U+0427 afii10041
+!D8 U+0428 afii10042
+!D9 U+0429 afii10043
+!DA U+042A afii10044
+!DB U+042B afii10045
+!DC U+042C afii10046
+!DD U+042D afii10047
+!DE U+042E afii10048
+!DF U+042F afii10049
+!E0 U+0430 afii10065
+!E1 U+0431 afii10066
+!E2 U+0432 afii10067
+!E3 U+0433 afii10068
+!E4 U+0434 afii10069
+!E5 U+0435 afii10070
+!E6 U+0436 afii10072
+!E7 U+0437 afii10073
+!E8 U+0438 afii10074
+!E9 U+0439 afii10075
+!EA U+043A afii10076
+!EB U+043B afii10077
+!EC U+043C afii10078
+!ED U+043D afii10079
+!EE U+043E afii10080
+!EF U+043F afii10081
+!F0 U+0440 afii10082
+!F1 U+0441 afii10083
+!F2 U+0442 afii10084
+!F3 U+0443 afii10085
+!F4 U+0444 afii10086
+!F5 U+0445 afii10087
+!F6 U+0446 afii10088
+!F7 U+0447 afii10089
+!F8 U+0448 afii10090
+!F9 U+0449 afii10091
+!FA U+044A afii10092
+!FB U+044B afii10093
+!FC U+044C afii10094
+!FD U+044D afii10095
+!FE U+044E afii10096
+!FF U+044F afii10097

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1252.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1252.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1252.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,251 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!82 U+201A quotesinglbase
+!83 U+0192 florin
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!88 U+02C6 circumflex
+!89 U+2030 perthousand
+!8A U+0160 Scaron
+!8B U+2039 guilsinglleft
+!8C U+0152 OE
+!8E U+017D Zcaron
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!98 U+02DC tilde
+!99 U+2122 trademark
+!9A U+0161 scaron
+!9B U+203A guilsinglright
+!9C U+0153 oe
+!9E U+017E zcaron
+!9F U+0178 Ydieresis
+!A0 U+00A0 space
+!A1 U+00A1 exclamdown
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+00A4 currency
+!A5 U+00A5 yen
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AA U+00AA ordfeminine
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+00B8 cedilla
+!B9 U+00B9 onesuperior
+!BA U+00BA ordmasculine
+!BB U+00BB guillemotright
+!BC U+00BC onequarter
+!BD U+00BD onehalf
+!BE U+00BE threequarters
+!BF U+00BF questiondown
+!C0 U+00C0 Agrave
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+00C3 Atilde
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+00C6 AE
+!C7 U+00C7 Ccedilla
+!C8 U+00C8 Egrave
+!C9 U+00C9 Eacute
+!CA U+00CA Ecircumflex
+!CB U+00CB Edieresis
+!CC U+00CC Igrave
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+00CF Idieresis
+!D0 U+00D0 Eth
+!D1 U+00D1 Ntilde
+!D2 U+00D2 Ograve
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+00D5 Otilde
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+00D8 Oslash
+!D9 U+00D9 Ugrave
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+00DD Yacute
+!DE U+00DE Thorn
+!DF U+00DF germandbls
+!E0 U+00E0 agrave
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+00E3 atilde
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+00E6 ae
+!E7 U+00E7 ccedilla
+!E8 U+00E8 egrave
+!E9 U+00E9 eacute
+!EA U+00EA ecircumflex
+!EB U+00EB edieresis
+!EC U+00EC igrave
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+00EF idieresis
+!F0 U+00F0 eth
+!F1 U+00F1 ntilde
+!F2 U+00F2 ograve
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+00F5 otilde
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+00F8 oslash
+!F9 U+00F9 ugrave
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+00FD yacute
+!FE U+00FE thorn
+!FF U+00FF ydieresis

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1253.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1253.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1253.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,239 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!82 U+201A quotesinglbase
+!83 U+0192 florin
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!89 U+2030 perthousand
+!8B U+2039 guilsinglleft
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!99 U+2122 trademark
+!9B U+203A guilsinglright
+!A0 U+00A0 space
+!A1 U+0385 dieresistonos
+!A2 U+0386 Alphatonos
+!A3 U+00A3 sterling
+!A4 U+00A4 currency
+!A5 U+00A5 yen
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+2015 afii00208
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+0384 tonos
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+0388 Epsilontonos
+!B9 U+0389 Etatonos
+!BA U+038A Iotatonos
+!BB U+00BB guillemotright
+!BC U+038C Omicrontonos
+!BD U+00BD onehalf
+!BE U+038E Upsilontonos
+!BF U+038F Omegatonos
+!C0 U+0390 iotadieresistonos
+!C1 U+0391 Alpha
+!C2 U+0392 Beta
+!C3 U+0393 Gamma
+!C4 U+0394 Delta
+!C5 U+0395 Epsilon
+!C6 U+0396 Zeta
+!C7 U+0397 Eta
+!C8 U+0398 Theta
+!C9 U+0399 Iota
+!CA U+039A Kappa
+!CB U+039B Lambda
+!CC U+039C Mu
+!CD U+039D Nu
+!CE U+039E Xi
+!CF U+039F Omicron
+!D0 U+03A0 Pi
+!D1 U+03A1 Rho
+!D3 U+03A3 Sigma
+!D4 U+03A4 Tau
+!D5 U+03A5 Upsilon
+!D6 U+03A6 Phi
+!D7 U+03A7 Chi
+!D8 U+03A8 Psi
+!D9 U+03A9 Omega
+!DA U+03AA Iotadieresis
+!DB U+03AB Upsilondieresis
+!DC U+03AC alphatonos
+!DD U+03AD epsilontonos
+!DE U+03AE etatonos
+!DF U+03AF iotatonos
+!E0 U+03B0 upsilondieresistonos
+!E1 U+03B1 alpha
+!E2 U+03B2 beta
+!E3 U+03B3 gamma
+!E4 U+03B4 delta
+!E5 U+03B5 epsilon
+!E6 U+03B6 zeta
+!E7 U+03B7 eta
+!E8 U+03B8 theta
+!E9 U+03B9 iota
+!EA U+03BA kappa
+!EB U+03BB lambda
+!EC U+03BC mu
+!ED U+03BD nu
+!EE U+03BE xi
+!EF U+03BF omicron
+!F0 U+03C0 pi
+!F1 U+03C1 rho
+!F2 U+03C2 sigma1
+!F3 U+03C3 sigma
+!F4 U+03C4 tau
+!F5 U+03C5 upsilon
+!F6 U+03C6 phi
+!F7 U+03C7 chi
+!F8 U+03C8 psi
+!F9 U+03C9 omega
+!FA U+03CA iotadieresis
+!FB U+03CB upsilondieresis
+!FC U+03CC omicrontonos
+!FD U+03CD upsilontonos
+!FE U+03CE omegatonos

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1254.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1254.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1254.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,249 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!82 U+201A quotesinglbase
+!83 U+0192 florin
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!88 U+02C6 circumflex
+!89 U+2030 perthousand
+!8A U+0160 Scaron
+!8B U+2039 guilsinglleft
+!8C U+0152 OE
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!98 U+02DC tilde
+!99 U+2122 trademark
+!9A U+0161 scaron
+!9B U+203A guilsinglright
+!9C U+0153 oe
+!9F U+0178 Ydieresis
+!A0 U+00A0 space
+!A1 U+00A1 exclamdown
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+00A4 currency
+!A5 U+00A5 yen
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AA U+00AA ordfeminine
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+00B8 cedilla
+!B9 U+00B9 onesuperior
+!BA U+00BA ordmasculine
+!BB U+00BB guillemotright
+!BC U+00BC onequarter
+!BD U+00BD onehalf
+!BE U+00BE threequarters
+!BF U+00BF questiondown
+!C0 U+00C0 Agrave
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+00C3 Atilde
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+00C6 AE
+!C7 U+00C7 Ccedilla
+!C8 U+00C8 Egrave
+!C9 U+00C9 Eacute
+!CA U+00CA Ecircumflex
+!CB U+00CB Edieresis
+!CC U+00CC Igrave
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+00CF Idieresis
+!D0 U+011E Gbreve
+!D1 U+00D1 Ntilde
+!D2 U+00D2 Ograve
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+00D5 Otilde
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+00D8 Oslash
+!D9 U+00D9 Ugrave
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+0130 Idotaccent
+!DE U+015E Scedilla
+!DF U+00DF germandbls
+!E0 U+00E0 agrave
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+00E3 atilde
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+00E6 ae
+!E7 U+00E7 ccedilla
+!E8 U+00E8 egrave
+!E9 U+00E9 eacute
+!EA U+00EA ecircumflex
+!EB U+00EB edieresis
+!EC U+00EC igrave
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+00EF idieresis
+!F0 U+011F gbreve
+!F1 U+00F1 ntilde
+!F2 U+00F2 ograve
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+00F5 otilde
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+00F8 oslash
+!F9 U+00F9 ugrave
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+0131 dotlessi
+!FE U+015F scedilla
+!FF U+00FF ydieresis

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1255.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1255.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1255.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,233 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!82 U+201A quotesinglbase
+!83 U+0192 florin
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!88 U+02C6 circumflex
+!89 U+2030 perthousand
+!8B U+2039 guilsinglleft
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!98 U+02DC tilde
+!99 U+2122 trademark
+!9B U+203A guilsinglright
+!A0 U+00A0 space
+!A1 U+00A1 exclamdown
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+20AA afii57636
+!A5 U+00A5 yen
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AA U+00D7 multiply
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD sfthyphen
+!AE U+00AE registered
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 middot
+!B8 U+00B8 cedilla
+!B9 U+00B9 onesuperior
+!BA U+00F7 divide
+!BB U+00BB guillemotright
+!BC U+00BC onequarter
+!BD U+00BD onehalf
+!BE U+00BE threequarters
+!BF U+00BF questiondown
+!C0 U+05B0 afii57799
+!C1 U+05B1 afii57801
+!C2 U+05B2 afii57800
+!C3 U+05B3 afii57802
+!C4 U+05B4 afii57793
+!C5 U+05B5 afii57794
+!C6 U+05B6 afii57795
+!C7 U+05B7 afii57798
+!C8 U+05B8 afii57797
+!C9 U+05B9 afii57806
+!CB U+05BB afii57796
+!CC U+05BC afii57807
+!CD U+05BD afii57839
+!CE U+05BE afii57645
+!CF U+05BF afii57841
+!D0 U+05C0 afii57842
+!D1 U+05C1 afii57804
+!D2 U+05C2 afii57803
+!D3 U+05C3 afii57658
+!D4 U+05F0 afii57716
+!D5 U+05F1 afii57717
+!D6 U+05F2 afii57718
+!D7 U+05F3 gereshhebrew
+!D8 U+05F4 gershayimhebrew
+!E0 U+05D0 afii57664
+!E1 U+05D1 afii57665
+!E2 U+05D2 afii57666
+!E3 U+05D3 afii57667
+!E4 U+05D4 afii57668
+!E5 U+05D5 afii57669
+!E6 U+05D6 afii57670
+!E7 U+05D7 afii57671
+!E8 U+05D8 afii57672
+!E9 U+05D9 afii57673
+!EA U+05DA afii57674
+!EB U+05DB afii57675
+!EC U+05DC afii57676
+!ED U+05DD afii57677
+!EE U+05DE afii57678
+!EF U+05DF afii57679
+!F0 U+05E0 afii57680
+!F1 U+05E1 afii57681
+!F2 U+05E2 afii57682
+!F3 U+05E3 afii57683
+!F4 U+05E4 afii57684
+!F5 U+05E5 afii57685
+!F6 U+05E6 afii57686
+!F7 U+05E7 afii57687
+!F8 U+05E8 afii57688
+!F9 U+05E9 afii57689
+!FA U+05EA afii57690
+!FD U+200E afii299
+!FE U+200F afii300

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1257.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1257.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1257.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,244 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!82 U+201A quotesinglbase
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!89 U+2030 perthousand
+!8B U+2039 guilsinglleft
+!8D U+00A8 dieresis
+!8E U+02C7 caron
+!8F U+00B8 cedilla
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!99 U+2122 trademark
+!9B U+203A guilsinglright
+!9D U+00AF macron
+!9E U+02DB ogonek
+!A0 U+00A0 space
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+00A4 currency
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00D8 Oslash
+!A9 U+00A9 copyright
+!AA U+0156 Rcommaaccent
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+00C6 AE
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+00F8 oslash
+!B9 U+00B9 onesuperior
+!BA U+0157 rcommaaccent
+!BB U+00BB guillemotright
+!BC U+00BC onequarter
+!BD U+00BD onehalf
+!BE U+00BE threequarters
+!BF U+00E6 ae
+!C0 U+0104 Aogonek
+!C1 U+012E Iogonek
+!C2 U+0100 Amacron
+!C3 U+0106 Cacute
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+0118 Eogonek
+!C7 U+0112 Emacron
+!C8 U+010C Ccaron
+!C9 U+00C9 Eacute
+!CA U+0179 Zacute
+!CB U+0116 Edotaccent
+!CC U+0122 Gcommaaccent
+!CD U+0136 Kcommaaccent
+!CE U+012A Imacron
+!CF U+013B Lcommaaccent
+!D0 U+0160 Scaron
+!D1 U+0143 Nacute
+!D2 U+0145 Ncommaaccent
+!D3 U+00D3 Oacute
+!D4 U+014C Omacron
+!D5 U+00D5 Otilde
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+0172 Uogonek
+!D9 U+0141 Lslash
+!DA U+015A Sacute
+!DB U+016A Umacron
+!DC U+00DC Udieresis
+!DD U+017B Zdotaccent
+!DE U+017D Zcaron
+!DF U+00DF germandbls
+!E0 U+0105 aogonek
+!E1 U+012F iogonek
+!E2 U+0101 amacron
+!E3 U+0107 cacute
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+0119 eogonek
+!E7 U+0113 emacron
+!E8 U+010D ccaron
+!E9 U+00E9 eacute
+!EA U+017A zacute
+!EB U+0117 edotaccent
+!EC U+0123 gcommaaccent
+!ED U+0137 kcommaaccent
+!EE U+012B imacron
+!EF U+013C lcommaaccent
+!F0 U+0161 scaron
+!F1 U+0144 nacute
+!F2 U+0146 ncommaaccent
+!F3 U+00F3 oacute
+!F4 U+014D omacron
+!F5 U+00F5 otilde
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+0173 uogonek
+!F9 U+0142 lslash
+!FA U+015B sacute
+!FB U+016B umacron
+!FC U+00FC udieresis
+!FD U+017C zdotaccent
+!FE U+017E zcaron
+!FF U+02D9 dotaccent

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1258.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1258.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp1258.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,247 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!82 U+201A quotesinglbase
+!83 U+0192 florin
+!84 U+201E quotedblbase
+!85 U+2026 ellipsis
+!86 U+2020 dagger
+!87 U+2021 daggerdbl
+!88 U+02C6 circumflex
+!89 U+2030 perthousand
+!8B U+2039 guilsinglleft
+!8C U+0152 OE
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!98 U+02DC tilde
+!99 U+2122 trademark
+!9B U+203A guilsinglright
+!9C U+0153 oe
+!9F U+0178 Ydieresis
+!A0 U+00A0 space
+!A1 U+00A1 exclamdown
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+00A4 currency
+!A5 U+00A5 yen
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AA U+00AA ordfeminine
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+00B8 cedilla
+!B9 U+00B9 onesuperior
+!BA U+00BA ordmasculine
+!BB U+00BB guillemotright
+!BC U+00BC onequarter
+!BD U+00BD onehalf
+!BE U+00BE threequarters
+!BF U+00BF questiondown
+!C0 U+00C0 Agrave
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+0102 Abreve
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+00C6 AE
+!C7 U+00C7 Ccedilla
+!C8 U+00C8 Egrave
+!C9 U+00C9 Eacute
+!CA U+00CA Ecircumflex
+!CB U+00CB Edieresis
+!CC U+0300 gravecomb
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+00CF Idieresis
+!D0 U+0110 Dcroat
+!D1 U+00D1 Ntilde
+!D2 U+0309 hookabovecomb
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+01A0 Ohorn
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+00D8 Oslash
+!D9 U+00D9 Ugrave
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+01AF Uhorn
+!DE U+0303 tildecomb
+!DF U+00DF germandbls
+!E0 U+00E0 agrave
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+0103 abreve
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+00E6 ae
+!E7 U+00E7 ccedilla
+!E8 U+00E8 egrave
+!E9 U+00E9 eacute
+!EA U+00EA ecircumflex
+!EB U+00EB edieresis
+!EC U+0301 acutecomb
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+00EF idieresis
+!F0 U+0111 dcroat
+!F1 U+00F1 ntilde
+!F2 U+0323 dotbelowcomb
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+01A1 ohorn
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+00F8 oslash
+!F9 U+00F9 ugrave
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+01B0 uhorn
+!FE U+20AB dong
+!FF U+00FF ydieresis

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp874.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp874.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/cp874.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,225 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+20AC Euro
+!85 U+2026 ellipsis
+!91 U+2018 quoteleft
+!92 U+2019 quoteright
+!93 U+201C quotedblleft
+!94 U+201D quotedblright
+!95 U+2022 bullet
+!96 U+2013 endash
+!97 U+2014 emdash
+!A0 U+00A0 space
+!A1 U+0E01 kokaithai
+!A2 U+0E02 khokhaithai
+!A3 U+0E03 khokhuatthai
+!A4 U+0E04 khokhwaithai
+!A5 U+0E05 khokhonthai
+!A6 U+0E06 khorakhangthai
+!A7 U+0E07 ngonguthai
+!A8 U+0E08 chochanthai
+!A9 U+0E09 chochingthai
+!AA U+0E0A chochangthai
+!AB U+0E0B sosothai
+!AC U+0E0C chochoethai
+!AD U+0E0D yoyingthai
+!AE U+0E0E dochadathai
+!AF U+0E0F topatakthai
+!B0 U+0E10 thothanthai
+!B1 U+0E11 thonangmonthothai
+!B2 U+0E12 thophuthaothai
+!B3 U+0E13 nonenthai
+!B4 U+0E14 dodekthai
+!B5 U+0E15 totaothai
+!B6 U+0E16 thothungthai
+!B7 U+0E17 thothahanthai
+!B8 U+0E18 thothongthai
+!B9 U+0E19 nonuthai
+!BA U+0E1A bobaimaithai
+!BB U+0E1B poplathai
+!BC U+0E1C phophungthai
+!BD U+0E1D fofathai
+!BE U+0E1E phophanthai
+!BF U+0E1F fofanthai
+!C0 U+0E20 phosamphaothai
+!C1 U+0E21 momathai
+!C2 U+0E22 yoyakthai
+!C3 U+0E23 roruathai
+!C4 U+0E24 ruthai
+!C5 U+0E25 lolingthai
+!C6 U+0E26 luthai
+!C7 U+0E27 wowaenthai
+!C8 U+0E28 sosalathai
+!C9 U+0E29 sorusithai
+!CA U+0E2A sosuathai
+!CB U+0E2B hohipthai
+!CC U+0E2C lochulathai
+!CD U+0E2D oangthai
+!CE U+0E2E honokhukthai
+!CF U+0E2F paiyannoithai
+!D0 U+0E30 saraathai
+!D1 U+0E31 maihanakatthai
+!D2 U+0E32 saraaathai
+!D3 U+0E33 saraamthai
+!D4 U+0E34 saraithai
+!D5 U+0E35 saraiithai
+!D6 U+0E36 sarauethai
+!D7 U+0E37 saraueethai
+!D8 U+0E38 sarauthai
+!D9 U+0E39 sarauuthai
+!DA U+0E3A phinthuthai
+!DF U+0E3F bahtthai
+!E0 U+0E40 saraethai
+!E1 U+0E41 saraaethai
+!E2 U+0E42 saraothai
+!E3 U+0E43 saraaimaimuanthai
+!E4 U+0E44 saraaimaimalaithai
+!E5 U+0E45 lakkhangyaothai
+!E6 U+0E46 maiyamokthai
+!E7 U+0E47 maitaikhuthai
+!E8 U+0E48 maiekthai
+!E9 U+0E49 maithothai
+!EA U+0E4A maitrithai
+!EB U+0E4B maichattawathai
+!EC U+0E4C thanthakhatthai
+!ED U+0E4D nikhahitthai
+!EE U+0E4E yamakkanthai
+!EF U+0E4F fongmanthai
+!F0 U+0E50 zerothai
+!F1 U+0E51 onethai
+!F2 U+0E52 twothai
+!F3 U+0E53 threethai
+!F4 U+0E54 fourthai
+!F5 U+0E55 fivethai
+!F6 U+0E56 sixthai
+!F7 U+0E57 seventhai
+!F8 U+0E58 eightthai
+!F9 U+0E59 ninethai
+!FA U+0E5A angkhankhuthai
+!FB U+0E5B khomutthai

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-1.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-1.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-1.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+00A1 exclamdown
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+00A4 currency
+!A5 U+00A5 yen
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AA U+00AA ordfeminine
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+00B8 cedilla
+!B9 U+00B9 onesuperior
+!BA U+00BA ordmasculine
+!BB U+00BB guillemotright
+!BC U+00BC onequarter
+!BD U+00BD onehalf
+!BE U+00BE threequarters
+!BF U+00BF questiondown
+!C0 U+00C0 Agrave
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+00C3 Atilde
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+00C6 AE
+!C7 U+00C7 Ccedilla
+!C8 U+00C8 Egrave
+!C9 U+00C9 Eacute
+!CA U+00CA Ecircumflex
+!CB U+00CB Edieresis
+!CC U+00CC Igrave
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+00CF Idieresis
+!D0 U+00D0 Eth
+!D1 U+00D1 Ntilde
+!D2 U+00D2 Ograve
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+00D5 Otilde
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+00D8 Oslash
+!D9 U+00D9 Ugrave
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+00DD Yacute
+!DE U+00DE Thorn
+!DF U+00DF germandbls
+!E0 U+00E0 agrave
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+00E3 atilde
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+00E6 ae
+!E7 U+00E7 ccedilla
+!E8 U+00E8 egrave
+!E9 U+00E9 eacute
+!EA U+00EA ecircumflex
+!EB U+00EB edieresis
+!EC U+00EC igrave
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+00EF idieresis
+!F0 U+00F0 eth
+!F1 U+00F1 ntilde
+!F2 U+00F2 ograve
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+00F5 otilde
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+00F8 oslash
+!F9 U+00F9 ugrave
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+00FD yacute
+!FE U+00FE thorn
+!FF U+00FF ydieresis

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-11.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-11.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-11.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,248 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+0E01 kokaithai
+!A2 U+0E02 khokhaithai
+!A3 U+0E03 khokhuatthai
+!A4 U+0E04 khokhwaithai
+!A5 U+0E05 khokhonthai
+!A6 U+0E06 khorakhangthai
+!A7 U+0E07 ngonguthai
+!A8 U+0E08 chochanthai
+!A9 U+0E09 chochingthai
+!AA U+0E0A chochangthai
+!AB U+0E0B sosothai
+!AC U+0E0C chochoethai
+!AD U+0E0D yoyingthai
+!AE U+0E0E dochadathai
+!AF U+0E0F topatakthai
+!B0 U+0E10 thothanthai
+!B1 U+0E11 thonangmonthothai
+!B2 U+0E12 thophuthaothai
+!B3 U+0E13 nonenthai
+!B4 U+0E14 dodekthai
+!B5 U+0E15 totaothai
+!B6 U+0E16 thothungthai
+!B7 U+0E17 thothahanthai
+!B8 U+0E18 thothongthai
+!B9 U+0E19 nonuthai
+!BA U+0E1A bobaimaithai
+!BB U+0E1B poplathai
+!BC U+0E1C phophungthai
+!BD U+0E1D fofathai
+!BE U+0E1E phophanthai
+!BF U+0E1F fofanthai
+!C0 U+0E20 phosamphaothai
+!C1 U+0E21 momathai
+!C2 U+0E22 yoyakthai
+!C3 U+0E23 roruathai
+!C4 U+0E24 ruthai
+!C5 U+0E25 lolingthai
+!C6 U+0E26 luthai
+!C7 U+0E27 wowaenthai
+!C8 U+0E28 sosalathai
+!C9 U+0E29 sorusithai
+!CA U+0E2A sosuathai
+!CB U+0E2B hohipthai
+!CC U+0E2C lochulathai
+!CD U+0E2D oangthai
+!CE U+0E2E honokhukthai
+!CF U+0E2F paiyannoithai
+!D0 U+0E30 saraathai
+!D1 U+0E31 maihanakatthai
+!D2 U+0E32 saraaathai
+!D3 U+0E33 saraamthai
+!D4 U+0E34 saraithai
+!D5 U+0E35 saraiithai
+!D6 U+0E36 sarauethai
+!D7 U+0E37 saraueethai
+!D8 U+0E38 sarauthai
+!D9 U+0E39 sarauuthai
+!DA U+0E3A phinthuthai
+!DF U+0E3F bahtthai
+!E0 U+0E40 saraethai
+!E1 U+0E41 saraaethai
+!E2 U+0E42 saraothai
+!E3 U+0E43 saraaimaimuanthai
+!E4 U+0E44 saraaimaimalaithai
+!E5 U+0E45 lakkhangyaothai
+!E6 U+0E46 maiyamokthai
+!E7 U+0E47 maitaikhuthai
+!E8 U+0E48 maiekthai
+!E9 U+0E49 maithothai
+!EA U+0E4A maitrithai
+!EB U+0E4B maichattawathai
+!EC U+0E4C thanthakhatthai
+!ED U+0E4D nikhahitthai
+!EE U+0E4E yamakkanthai
+!EF U+0E4F fongmanthai
+!F0 U+0E50 zerothai
+!F1 U+0E51 onethai
+!F2 U+0E52 twothai
+!F3 U+0E53 threethai
+!F4 U+0E54 fourthai
+!F5 U+0E55 fivethai
+!F6 U+0E56 sixthai
+!F7 U+0E57 seventhai
+!F8 U+0E58 eightthai
+!F9 U+0E59 ninethai
+!FA U+0E5A angkhankhuthai
+!FB U+0E5B khomutthai

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-15.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-15.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-15.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+00A1 exclamdown
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+20AC Euro
+!A5 U+00A5 yen
+!A6 U+0160 Scaron
+!A7 U+00A7 section
+!A8 U+0161 scaron
+!A9 U+00A9 copyright
+!AA U+00AA ordfeminine
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+017D Zcaron
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+017E zcaron
+!B9 U+00B9 onesuperior
+!BA U+00BA ordmasculine
+!BB U+00BB guillemotright
+!BC U+0152 OE
+!BD U+0153 oe
+!BE U+0178 Ydieresis
+!BF U+00BF questiondown
+!C0 U+00C0 Agrave
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+00C3 Atilde
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+00C6 AE
+!C7 U+00C7 Ccedilla
+!C8 U+00C8 Egrave
+!C9 U+00C9 Eacute
+!CA U+00CA Ecircumflex
+!CB U+00CB Edieresis
+!CC U+00CC Igrave
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+00CF Idieresis
+!D0 U+00D0 Eth
+!D1 U+00D1 Ntilde
+!D2 U+00D2 Ograve
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+00D5 Otilde
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+00D8 Oslash
+!D9 U+00D9 Ugrave
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+00DD Yacute
+!DE U+00DE Thorn
+!DF U+00DF germandbls
+!E0 U+00E0 agrave
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+00E3 atilde
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+00E6 ae
+!E7 U+00E7 ccedilla
+!E8 U+00E8 egrave
+!E9 U+00E9 eacute
+!EA U+00EA ecircumflex
+!EB U+00EB edieresis
+!EC U+00EC igrave
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+00EF idieresis
+!F0 U+00F0 eth
+!F1 U+00F1 ntilde
+!F2 U+00F2 ograve
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+00F5 otilde
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+00F8 oslash
+!F9 U+00F9 ugrave
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+00FD yacute
+!FE U+00FE thorn
+!FF U+00FF ydieresis

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-16.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-16.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-16.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+0104 Aogonek
+!A2 U+0105 aogonek
+!A3 U+0141 Lslash
+!A4 U+20AC Euro
+!A5 U+201E quotedblbase
+!A6 U+0160 Scaron
+!A7 U+00A7 section
+!A8 U+0161 scaron
+!A9 U+00A9 copyright
+!AA U+0218 Scommaaccent
+!AB U+00AB guillemotleft
+!AC U+0179 Zacute
+!AD U+00AD hyphen
+!AE U+017A zacute
+!AF U+017B Zdotaccent
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+010C Ccaron
+!B3 U+0142 lslash
+!B4 U+017D Zcaron
+!B5 U+201D quotedblright
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+017E zcaron
+!B9 U+010D ccaron
+!BA U+0219 scommaaccent
+!BB U+00BB guillemotright
+!BC U+0152 OE
+!BD U+0153 oe
+!BE U+0178 Ydieresis
+!BF U+017C zdotaccent
+!C0 U+00C0 Agrave
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+0102 Abreve
+!C4 U+00C4 Adieresis
+!C5 U+0106 Cacute
+!C6 U+00C6 AE
+!C7 U+00C7 Ccedilla
+!C8 U+00C8 Egrave
+!C9 U+00C9 Eacute
+!CA U+00CA Ecircumflex
+!CB U+00CB Edieresis
+!CC U+00CC Igrave
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+00CF Idieresis
+!D0 U+0110 Dcroat
+!D1 U+0143 Nacute
+!D2 U+00D2 Ograve
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+0150 Ohungarumlaut
+!D6 U+00D6 Odieresis
+!D7 U+015A Sacute
+!D8 U+0170 Uhungarumlaut
+!D9 U+00D9 Ugrave
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+0118 Eogonek
+!DE U+021A Tcommaaccent
+!DF U+00DF germandbls
+!E0 U+00E0 agrave
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+0103 abreve
+!E4 U+00E4 adieresis
+!E5 U+0107 cacute
+!E6 U+00E6 ae
+!E7 U+00E7 ccedilla
+!E8 U+00E8 egrave
+!E9 U+00E9 eacute
+!EA U+00EA ecircumflex
+!EB U+00EB edieresis
+!EC U+00EC igrave
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+00EF idieresis
+!F0 U+0111 dcroat
+!F1 U+0144 nacute
+!F2 U+00F2 ograve
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+0151 ohungarumlaut
+!F6 U+00F6 odieresis
+!F7 U+015B sacute
+!F8 U+0171 uhungarumlaut
+!F9 U+00F9 ugrave
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+0119 eogonek
+!FE U+021B tcommaaccent
+!FF U+00FF ydieresis

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-2.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-2.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-2.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+0104 Aogonek
+!A2 U+02D8 breve
+!A3 U+0141 Lslash
+!A4 U+00A4 currency
+!A5 U+013D Lcaron
+!A6 U+015A Sacute
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+0160 Scaron
+!AA U+015E Scedilla
+!AB U+0164 Tcaron
+!AC U+0179 Zacute
+!AD U+00AD hyphen
+!AE U+017D Zcaron
+!AF U+017B Zdotaccent
+!B0 U+00B0 degree
+!B1 U+0105 aogonek
+!B2 U+02DB ogonek
+!B3 U+0142 lslash
+!B4 U+00B4 acute
+!B5 U+013E lcaron
+!B6 U+015B sacute
+!B7 U+02C7 caron
+!B8 U+00B8 cedilla
+!B9 U+0161 scaron
+!BA U+015F scedilla
+!BB U+0165 tcaron
+!BC U+017A zacute
+!BD U+02DD hungarumlaut
+!BE U+017E zcaron
+!BF U+017C zdotaccent
+!C0 U+0154 Racute
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+0102 Abreve
+!C4 U+00C4 Adieresis
+!C5 U+0139 Lacute
+!C6 U+0106 Cacute
+!C7 U+00C7 Ccedilla
+!C8 U+010C Ccaron
+!C9 U+00C9 Eacute
+!CA U+0118 Eogonek
+!CB U+00CB Edieresis
+!CC U+011A Ecaron
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+010E Dcaron
+!D0 U+0110 Dcroat
+!D1 U+0143 Nacute
+!D2 U+0147 Ncaron
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+0150 Ohungarumlaut
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+0158 Rcaron
+!D9 U+016E Uring
+!DA U+00DA Uacute
+!DB U+0170 Uhungarumlaut
+!DC U+00DC Udieresis
+!DD U+00DD Yacute
+!DE U+0162 Tcommaaccent
+!DF U+00DF germandbls
+!E0 U+0155 racute
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+0103 abreve
+!E4 U+00E4 adieresis
+!E5 U+013A lacute
+!E6 U+0107 cacute
+!E7 U+00E7 ccedilla
+!E8 U+010D ccaron
+!E9 U+00E9 eacute
+!EA U+0119 eogonek
+!EB U+00EB edieresis
+!EC U+011B ecaron
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+010F dcaron
+!F0 U+0111 dcroat
+!F1 U+0144 nacute
+!F2 U+0148 ncaron
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+0151 ohungarumlaut
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+0159 rcaron
+!F9 U+016F uring
+!FA U+00FA uacute
+!FB U+0171 uhungarumlaut
+!FC U+00FC udieresis
+!FD U+00FD yacute
+!FE U+0163 tcommaaccent
+!FF U+02D9 dotaccent

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-4.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-4.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-4.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+0104 Aogonek
+!A2 U+0138 kgreenlandic
+!A3 U+0156 Rcommaaccent
+!A4 U+00A4 currency
+!A5 U+0128 Itilde
+!A6 U+013B Lcommaaccent
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+0160 Scaron
+!AA U+0112 Emacron
+!AB U+0122 Gcommaaccent
+!AC U+0166 Tbar
+!AD U+00AD hyphen
+!AE U+017D Zcaron
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+0105 aogonek
+!B2 U+02DB ogonek
+!B3 U+0157 rcommaaccent
+!B4 U+00B4 acute
+!B5 U+0129 itilde
+!B6 U+013C lcommaaccent
+!B7 U+02C7 caron
+!B8 U+00B8 cedilla
+!B9 U+0161 scaron
+!BA U+0113 emacron
+!BB U+0123 gcommaaccent
+!BC U+0167 tbar
+!BD U+014A Eng
+!BE U+017E zcaron
+!BF U+014B eng
+!C0 U+0100 Amacron
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+00C3 Atilde
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+00C6 AE
+!C7 U+012E Iogonek
+!C8 U+010C Ccaron
+!C9 U+00C9 Eacute
+!CA U+0118 Eogonek
+!CB U+00CB Edieresis
+!CC U+0116 Edotaccent
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+012A Imacron
+!D0 U+0110 Dcroat
+!D1 U+0145 Ncommaaccent
+!D2 U+014C Omacron
+!D3 U+0136 Kcommaaccent
+!D4 U+00D4 Ocircumflex
+!D5 U+00D5 Otilde
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+00D8 Oslash
+!D9 U+0172 Uogonek
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+0168 Utilde
+!DE U+016A Umacron
+!DF U+00DF germandbls
+!E0 U+0101 amacron
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+00E3 atilde
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+00E6 ae
+!E7 U+012F iogonek
+!E8 U+010D ccaron
+!E9 U+00E9 eacute
+!EA U+0119 eogonek
+!EB U+00EB edieresis
+!EC U+0117 edotaccent
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+012B imacron
+!F0 U+0111 dcroat
+!F1 U+0146 ncommaaccent
+!F2 U+014D omacron
+!F3 U+0137 kcommaaccent
+!F4 U+00F4 ocircumflex
+!F5 U+00F5 otilde
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+00F8 oslash
+!F9 U+0173 uogonek
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+0169 utilde
+!FE U+016B umacron
+!FF U+02D9 dotaccent

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-5.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-5.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-5.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+0401 afii10023
+!A2 U+0402 afii10051
+!A3 U+0403 afii10052
+!A4 U+0404 afii10053
+!A5 U+0405 afii10054
+!A6 U+0406 afii10055
+!A7 U+0407 afii10056
+!A8 U+0408 afii10057
+!A9 U+0409 afii10058
+!AA U+040A afii10059
+!AB U+040B afii10060
+!AC U+040C afii10061
+!AD U+00AD hyphen
+!AE U+040E afii10062
+!AF U+040F afii10145
+!B0 U+0410 afii10017
+!B1 U+0411 afii10018
+!B2 U+0412 afii10019
+!B3 U+0413 afii10020
+!B4 U+0414 afii10021
+!B5 U+0415 afii10022
+!B6 U+0416 afii10024
+!B7 U+0417 afii10025
+!B8 U+0418 afii10026
+!B9 U+0419 afii10027
+!BA U+041A afii10028
+!BB U+041B afii10029
+!BC U+041C afii10030
+!BD U+041D afii10031
+!BE U+041E afii10032
+!BF U+041F afii10033
+!C0 U+0420 afii10034
+!C1 U+0421 afii10035
+!C2 U+0422 afii10036
+!C3 U+0423 afii10037
+!C4 U+0424 afii10038
+!C5 U+0425 afii10039
+!C6 U+0426 afii10040
+!C7 U+0427 afii10041
+!C8 U+0428 afii10042
+!C9 U+0429 afii10043
+!CA U+042A afii10044
+!CB U+042B afii10045
+!CC U+042C afii10046
+!CD U+042D afii10047
+!CE U+042E afii10048
+!CF U+042F afii10049
+!D0 U+0430 afii10065
+!D1 U+0431 afii10066
+!D2 U+0432 afii10067
+!D3 U+0433 afii10068
+!D4 U+0434 afii10069
+!D5 U+0435 afii10070
+!D6 U+0436 afii10072
+!D7 U+0437 afii10073
+!D8 U+0438 afii10074
+!D9 U+0439 afii10075
+!DA U+043A afii10076
+!DB U+043B afii10077
+!DC U+043C afii10078
+!DD U+043D afii10079
+!DE U+043E afii10080
+!DF U+043F afii10081
+!E0 U+0440 afii10082
+!E1 U+0441 afii10083
+!E2 U+0442 afii10084
+!E3 U+0443 afii10085
+!E4 U+0444 afii10086
+!E5 U+0445 afii10087
+!E6 U+0446 afii10088
+!E7 U+0447 afii10089
+!E8 U+0448 afii10090
+!E9 U+0449 afii10091
+!EA U+044A afii10092
+!EB U+044B afii10093
+!EC U+044C afii10094
+!ED U+044D afii10095
+!EE U+044E afii10096
+!EF U+044F afii10097
+!F0 U+2116 afii61352
+!F1 U+0451 afii10071
+!F2 U+0452 afii10099
+!F3 U+0453 afii10100
+!F4 U+0454 afii10101
+!F5 U+0455 afii10102
+!F6 U+0456 afii10103
+!F7 U+0457 afii10104
+!F8 U+0458 afii10105
+!F9 U+0459 afii10106
+!FA U+045A afii10107
+!FB U+045B afii10108
+!FC U+045C afii10109
+!FD U+00A7 section
+!FE U+045E afii10110
+!FF U+045F afii10193

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-7.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-7.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-7.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,250 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+2018 quoteleft
+!A2 U+2019 quoteright
+!A3 U+00A3 sterling
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AF U+2015 afii00208
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+0384 tonos
+!B5 U+0385 dieresistonos
+!B6 U+0386 Alphatonos
+!B7 U+00B7 periodcentered
+!B8 U+0388 Epsilontonos
+!B9 U+0389 Etatonos
+!BA U+038A Iotatonos
+!BB U+00BB guillemotright
+!BC U+038C Omicrontonos
+!BD U+00BD onehalf
+!BE U+038E Upsilontonos
+!BF U+038F Omegatonos
+!C0 U+0390 iotadieresistonos
+!C1 U+0391 Alpha
+!C2 U+0392 Beta
+!C3 U+0393 Gamma
+!C4 U+0394 Delta
+!C5 U+0395 Epsilon
+!C6 U+0396 Zeta
+!C7 U+0397 Eta
+!C8 U+0398 Theta
+!C9 U+0399 Iota
+!CA U+039A Kappa
+!CB U+039B Lambda
+!CC U+039C Mu
+!CD U+039D Nu
+!CE U+039E Xi
+!CF U+039F Omicron
+!D0 U+03A0 Pi
+!D1 U+03A1 Rho
+!D3 U+03A3 Sigma
+!D4 U+03A4 Tau
+!D5 U+03A5 Upsilon
+!D6 U+03A6 Phi
+!D7 U+03A7 Chi
+!D8 U+03A8 Psi
+!D9 U+03A9 Omega
+!DA U+03AA Iotadieresis
+!DB U+03AB Upsilondieresis
+!DC U+03AC alphatonos
+!DD U+03AD epsilontonos
+!DE U+03AE etatonos
+!DF U+03AF iotatonos
+!E0 U+03B0 upsilondieresistonos
+!E1 U+03B1 alpha
+!E2 U+03B2 beta
+!E3 U+03B3 gamma
+!E4 U+03B4 delta
+!E5 U+03B5 epsilon
+!E6 U+03B6 zeta
+!E7 U+03B7 eta
+!E8 U+03B8 theta
+!E9 U+03B9 iota
+!EA U+03BA kappa
+!EB U+03BB lambda
+!EC U+03BC mu
+!ED U+03BD nu
+!EE U+03BE xi
+!EF U+03BF omicron
+!F0 U+03C0 pi
+!F1 U+03C1 rho
+!F2 U+03C2 sigma1
+!F3 U+03C3 sigma
+!F4 U+03C4 tau
+!F5 U+03C5 upsilon
+!F6 U+03C6 phi
+!F7 U+03C7 chi
+!F8 U+03C8 psi
+!F9 U+03C9 omega
+!FA U+03CA iotadieresis
+!FB U+03CB upsilondieresis
+!FC U+03CC omicrontonos
+!FD U+03CD upsilontonos
+!FE U+03CE omegatonos

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-9.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-9.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/iso-8859-9.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+0080 .notdef
+!81 U+0081 .notdef
+!82 U+0082 .notdef
+!83 U+0083 .notdef
+!84 U+0084 .notdef
+!85 U+0085 .notdef
+!86 U+0086 .notdef
+!87 U+0087 .notdef
+!88 U+0088 .notdef
+!89 U+0089 .notdef
+!8A U+008A .notdef
+!8B U+008B .notdef
+!8C U+008C .notdef
+!8D U+008D .notdef
+!8E U+008E .notdef
+!8F U+008F .notdef
+!90 U+0090 .notdef
+!91 U+0091 .notdef
+!92 U+0092 .notdef
+!93 U+0093 .notdef
+!94 U+0094 .notdef
+!95 U+0095 .notdef
+!96 U+0096 .notdef
+!97 U+0097 .notdef
+!98 U+0098 .notdef
+!99 U+0099 .notdef
+!9A U+009A .notdef
+!9B U+009B .notdef
+!9C U+009C .notdef
+!9D U+009D .notdef
+!9E U+009E .notdef
+!9F U+009F .notdef
+!A0 U+00A0 space
+!A1 U+00A1 exclamdown
+!A2 U+00A2 cent
+!A3 U+00A3 sterling
+!A4 U+00A4 currency
+!A5 U+00A5 yen
+!A6 U+00A6 brokenbar
+!A7 U+00A7 section
+!A8 U+00A8 dieresis
+!A9 U+00A9 copyright
+!AA U+00AA ordfeminine
+!AB U+00AB guillemotleft
+!AC U+00AC logicalnot
+!AD U+00AD hyphen
+!AE U+00AE registered
+!AF U+00AF macron
+!B0 U+00B0 degree
+!B1 U+00B1 plusminus
+!B2 U+00B2 twosuperior
+!B3 U+00B3 threesuperior
+!B4 U+00B4 acute
+!B5 U+00B5 mu
+!B6 U+00B6 paragraph
+!B7 U+00B7 periodcentered
+!B8 U+00B8 cedilla
+!B9 U+00B9 onesuperior
+!BA U+00BA ordmasculine
+!BB U+00BB guillemotright
+!BC U+00BC onequarter
+!BD U+00BD onehalf
+!BE U+00BE threequarters
+!BF U+00BF questiondown
+!C0 U+00C0 Agrave
+!C1 U+00C1 Aacute
+!C2 U+00C2 Acircumflex
+!C3 U+00C3 Atilde
+!C4 U+00C4 Adieresis
+!C5 U+00C5 Aring
+!C6 U+00C6 AE
+!C7 U+00C7 Ccedilla
+!C8 U+00C8 Egrave
+!C9 U+00C9 Eacute
+!CA U+00CA Ecircumflex
+!CB U+00CB Edieresis
+!CC U+00CC Igrave
+!CD U+00CD Iacute
+!CE U+00CE Icircumflex
+!CF U+00CF Idieresis
+!D0 U+011E Gbreve
+!D1 U+00D1 Ntilde
+!D2 U+00D2 Ograve
+!D3 U+00D3 Oacute
+!D4 U+00D4 Ocircumflex
+!D5 U+00D5 Otilde
+!D6 U+00D6 Odieresis
+!D7 U+00D7 multiply
+!D8 U+00D8 Oslash
+!D9 U+00D9 Ugrave
+!DA U+00DA Uacute
+!DB U+00DB Ucircumflex
+!DC U+00DC Udieresis
+!DD U+0130 Idotaccent
+!DE U+015E Scedilla
+!DF U+00DF germandbls
+!E0 U+00E0 agrave
+!E1 U+00E1 aacute
+!E2 U+00E2 acircumflex
+!E3 U+00E3 atilde
+!E4 U+00E4 adieresis
+!E5 U+00E5 aring
+!E6 U+00E6 ae
+!E7 U+00E7 ccedilla
+!E8 U+00E8 egrave
+!E9 U+00E9 eacute
+!EA U+00EA ecircumflex
+!EB U+00EB edieresis
+!EC U+00EC igrave
+!ED U+00ED iacute
+!EE U+00EE icircumflex
+!EF U+00EF idieresis
+!F0 U+011F gbreve
+!F1 U+00F1 ntilde
+!F2 U+00F2 ograve
+!F3 U+00F3 oacute
+!F4 U+00F4 ocircumflex
+!F5 U+00F5 otilde
+!F6 U+00F6 odieresis
+!F7 U+00F7 divide
+!F8 U+00F8 oslash
+!F9 U+00F9 ugrave
+!FA U+00FA uacute
+!FB U+00FB ucircumflex
+!FC U+00FC udieresis
+!FD U+0131 dotlessi
+!FE U+015F scedilla
+!FF U+00FF ydieresis

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-r.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-r.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-r.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+2500 SF100000
+!81 U+2502 SF110000
+!82 U+250C SF010000
+!83 U+2510 SF030000
+!84 U+2514 SF020000
+!85 U+2518 SF040000
+!86 U+251C SF080000
+!87 U+2524 SF090000
+!88 U+252C SF060000
+!89 U+2534 SF070000
+!8A U+253C SF050000
+!8B U+2580 upblock
+!8C U+2584 dnblock
+!8D U+2588 block
+!8E U+258C lfblock
+!8F U+2590 rtblock
+!90 U+2591 ltshade
+!91 U+2592 shade
+!92 U+2593 dkshade
+!93 U+2320 integraltp
+!94 U+25A0 filledbox
+!95 U+2219 periodcentered
+!96 U+221A radical
+!97 U+2248 approxequal
+!98 U+2264 lessequal
+!99 U+2265 greaterequal
+!9A U+00A0 space
+!9B U+2321 integralbt
+!9C U+00B0 degree
+!9D U+00B2 twosuperior
+!9E U+00B7 periodcentered
+!9F U+00F7 divide
+!A0 U+2550 SF430000
+!A1 U+2551 SF240000
+!A2 U+2552 SF510000
+!A3 U+0451 afii10071
+!A4 U+2553 SF520000
+!A5 U+2554 SF390000
+!A6 U+2555 SF220000
+!A7 U+2556 SF210000
+!A8 U+2557 SF250000
+!A9 U+2558 SF500000
+!AA U+2559 SF490000
+!AB U+255A SF380000
+!AC U+255B SF280000
+!AD U+255C SF270000
+!AE U+255D SF260000
+!AF U+255E SF360000
+!B0 U+255F SF370000
+!B1 U+2560 SF420000
+!B2 U+2561 SF190000
+!B3 U+0401 afii10023
+!B4 U+2562 SF200000
+!B5 U+2563 SF230000
+!B6 U+2564 SF470000
+!B7 U+2565 SF480000
+!B8 U+2566 SF410000
+!B9 U+2567 SF450000
+!BA U+2568 SF460000
+!BB U+2569 SF400000
+!BC U+256A SF540000
+!BD U+256B SF530000
+!BE U+256C SF440000
+!BF U+00A9 copyright
+!C0 U+044E afii10096
+!C1 U+0430 afii10065
+!C2 U+0431 afii10066
+!C3 U+0446 afii10088
+!C4 U+0434 afii10069
+!C5 U+0435 afii10070
+!C6 U+0444 afii10086
+!C7 U+0433 afii10068
+!C8 U+0445 afii10087
+!C9 U+0438 afii10074
+!CA U+0439 afii10075
+!CB U+043A afii10076
+!CC U+043B afii10077
+!CD U+043C afii10078
+!CE U+043D afii10079
+!CF U+043E afii10080
+!D0 U+043F afii10081
+!D1 U+044F afii10097
+!D2 U+0440 afii10082
+!D3 U+0441 afii10083
+!D4 U+0442 afii10084
+!D5 U+0443 afii10085
+!D6 U+0436 afii10072
+!D7 U+0432 afii10067
+!D8 U+044C afii10094
+!D9 U+044B afii10093
+!DA U+0437 afii10073
+!DB U+0448 afii10090
+!DC U+044D afii10095
+!DD U+0449 afii10091
+!DE U+0447 afii10089
+!DF U+044A afii10092
+!E0 U+042E afii10048
+!E1 U+0410 afii10017
+!E2 U+0411 afii10018
+!E3 U+0426 afii10040
+!E4 U+0414 afii10021
+!E5 U+0415 afii10022
+!E6 U+0424 afii10038
+!E7 U+0413 afii10020
+!E8 U+0425 afii10039
+!E9 U+0418 afii10026
+!EA U+0419 afii10027
+!EB U+041A afii10028
+!EC U+041B afii10029
+!ED U+041C afii10030
+!EE U+041D afii10031
+!EF U+041E afii10032
+!F0 U+041F afii10033
+!F1 U+042F afii10049
+!F2 U+0420 afii10034
+!F3 U+0421 afii10035
+!F4 U+0422 afii10036
+!F5 U+0423 afii10037
+!F6 U+0416 afii10024
+!F7 U+0412 afii10019
+!F8 U+042C afii10046
+!F9 U+042B afii10045
+!FA U+0417 afii10025
+!FB U+0428 afii10042
+!FC U+042D afii10047
+!FD U+0429 afii10043
+!FE U+0427 afii10041
+!FF U+042A afii10044

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-u.map
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-u.map	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/koi8-u.map	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,256 @@
+!00 U+0000 .notdef
+!01 U+0001 .notdef
+!02 U+0002 .notdef
+!03 U+0003 .notdef
+!04 U+0004 .notdef
+!05 U+0005 .notdef
+!06 U+0006 .notdef
+!07 U+0007 .notdef
+!08 U+0008 .notdef
+!09 U+0009 .notdef
+!0A U+000A .notdef
+!0B U+000B .notdef
+!0C U+000C .notdef
+!0D U+000D .notdef
+!0E U+000E .notdef
+!0F U+000F .notdef
+!10 U+0010 .notdef
+!11 U+0011 .notdef
+!12 U+0012 .notdef
+!13 U+0013 .notdef
+!14 U+0014 .notdef
+!15 U+0015 .notdef
+!16 U+0016 .notdef
+!17 U+0017 .notdef
+!18 U+0018 .notdef
+!19 U+0019 .notdef
+!1A U+001A .notdef
+!1B U+001B .notdef
+!1C U+001C .notdef
+!1D U+001D .notdef
+!1E U+001E .notdef
+!1F U+001F .notdef
+!20 U+0020 space
+!21 U+0021 exclam
+!22 U+0022 quotedbl
+!23 U+0023 numbersign
+!24 U+0024 dollar
+!25 U+0025 percent
+!26 U+0026 ampersand
+!27 U+0027 quotesingle
+!28 U+0028 parenleft
+!29 U+0029 parenright
+!2A U+002A asterisk
+!2B U+002B plus
+!2C U+002C comma
+!2D U+002D hyphen
+!2E U+002E period
+!2F U+002F slash
+!30 U+0030 zero
+!31 U+0031 one
+!32 U+0032 two
+!33 U+0033 three
+!34 U+0034 four
+!35 U+0035 five
+!36 U+0036 six
+!37 U+0037 seven
+!38 U+0038 eight
+!39 U+0039 nine
+!3A U+003A colon
+!3B U+003B semicolon
+!3C U+003C less
+!3D U+003D equal
+!3E U+003E greater
+!3F U+003F question
+!40 U+0040 at
+!41 U+0041 A
+!42 U+0042 B
+!43 U+0043 C
+!44 U+0044 D
+!45 U+0045 E
+!46 U+0046 F
+!47 U+0047 G
+!48 U+0048 H
+!49 U+0049 I
+!4A U+004A J
+!4B U+004B K
+!4C U+004C L
+!4D U+004D M
+!4E U+004E N
+!4F U+004F O
+!50 U+0050 P
+!51 U+0051 Q
+!52 U+0052 R
+!53 U+0053 S
+!54 U+0054 T
+!55 U+0055 U
+!56 U+0056 V
+!57 U+0057 W
+!58 U+0058 X
+!59 U+0059 Y
+!5A U+005A Z
+!5B U+005B bracketleft
+!5C U+005C backslash
+!5D U+005D bracketright
+!5E U+005E asciicircum
+!5F U+005F underscore
+!60 U+0060 grave
+!61 U+0061 a
+!62 U+0062 b
+!63 U+0063 c
+!64 U+0064 d
+!65 U+0065 e
+!66 U+0066 f
+!67 U+0067 g
+!68 U+0068 h
+!69 U+0069 i
+!6A U+006A j
+!6B U+006B k
+!6C U+006C l
+!6D U+006D m
+!6E U+006E n
+!6F U+006F o
+!70 U+0070 p
+!71 U+0071 q
+!72 U+0072 r
+!73 U+0073 s
+!74 U+0074 t
+!75 U+0075 u
+!76 U+0076 v
+!77 U+0077 w
+!78 U+0078 x
+!79 U+0079 y
+!7A U+007A z
+!7B U+007B braceleft
+!7C U+007C bar
+!7D U+007D braceright
+!7E U+007E asciitilde
+!7F U+007F .notdef
+!80 U+2500 SF100000
+!81 U+2502 SF110000
+!82 U+250C SF010000
+!83 U+2510 SF030000
+!84 U+2514 SF020000
+!85 U+2518 SF040000
+!86 U+251C SF080000
+!87 U+2524 SF090000
+!88 U+252C SF060000
+!89 U+2534 SF070000
+!8A U+253C SF050000
+!8B U+2580 upblock
+!8C U+2584 dnblock
+!8D U+2588 block
+!8E U+258C lfblock
+!8F U+2590 rtblock
+!90 U+2591 ltshade
+!91 U+2592 shade
+!92 U+2593 dkshade
+!93 U+2320 integraltp
+!94 U+25A0 filledbox
+!95 U+2022 bullet
+!96 U+221A radical
+!97 U+2248 approxequal
+!98 U+2264 lessequal
+!99 U+2265 greaterequal
+!9A U+00A0 space
+!9B U+2321 integralbt
+!9C U+00B0 degree
+!9D U+00B2 twosuperior
+!9E U+00B7 periodcentered
+!9F U+00F7 divide
+!A0 U+2550 SF430000
+!A1 U+2551 SF240000
+!A2 U+2552 SF510000
+!A3 U+0451 afii10071
+!A4 U+0454 afii10101
+!A5 U+2554 SF390000
+!A6 U+0456 afii10103
+!A7 U+0457 afii10104
+!A8 U+2557 SF250000
+!A9 U+2558 SF500000
+!AA U+2559 SF490000
+!AB U+255A SF380000
+!AC U+255B SF280000
+!AD U+0491 afii10098
+!AE U+255D SF260000
+!AF U+255E SF360000
+!B0 U+255F SF370000
+!B1 U+2560 SF420000
+!B2 U+2561 SF190000
+!B3 U+0401 afii10023
+!B4 U+0404 afii10053
+!B5 U+2563 SF230000
+!B6 U+0406 afii10055
+!B7 U+0407 afii10056
+!B8 U+2566 SF410000
+!B9 U+2567 SF450000
+!BA U+2568 SF460000
+!BB U+2569 SF400000
+!BC U+256A SF540000
+!BD U+0490 afii10050
+!BE U+256C SF440000
+!BF U+00A9 copyright
+!C0 U+044E afii10096
+!C1 U+0430 afii10065
+!C2 U+0431 afii10066
+!C3 U+0446 afii10088
+!C4 U+0434 afii10069
+!C5 U+0435 afii10070
+!C6 U+0444 afii10086
+!C7 U+0433 afii10068
+!C8 U+0445 afii10087
+!C9 U+0438 afii10074
+!CA U+0439 afii10075
+!CB U+043A afii10076
+!CC U+043B afii10077
+!CD U+043C afii10078
+!CE U+043D afii10079
+!CF U+043E afii10080
+!D0 U+043F afii10081
+!D1 U+044F afii10097
+!D2 U+0440 afii10082
+!D3 U+0441 afii10083
+!D4 U+0442 afii10084
+!D5 U+0443 afii10085
+!D6 U+0436 afii10072
+!D7 U+0432 afii10067
+!D8 U+044C afii10094
+!D9 U+044B afii10093
+!DA U+0437 afii10073
+!DB U+0448 afii10090
+!DC U+044D afii10095
+!DD U+0449 afii10091
+!DE U+0447 afii10089
+!DF U+044A afii10092
+!E0 U+042E afii10048
+!E1 U+0410 afii10017
+!E2 U+0411 afii10018
+!E3 U+0426 afii10040
+!E4 U+0414 afii10021
+!E5 U+0415 afii10022
+!E6 U+0424 afii10038
+!E7 U+0413 afii10020
+!E8 U+0425 afii10039
+!E9 U+0418 afii10026
+!EA U+0419 afii10027
+!EB U+041A afii10028
+!EC U+041B afii10029
+!ED U+041C afii10030
+!EE U+041D afii10031
+!EF U+041E afii10032
+!F0 U+041F afii10033
+!F1 U+042F afii10049
+!F2 U+0420 afii10034
+!F3 U+0421 afii10035
+!F4 U+0422 afii10036
+!F5 U+0423 afii10037
+!F6 U+0416 afii10024
+!F7 U+0412 afii10019
+!F8 U+042C afii10046
+!F9 U+042B afii10045
+!FA U+0417 afii10025
+!FB U+0428 afii10042
+!FC U+042D afii10047
+!FD U+0429 afii10043
+!FE U+0427 afii10041
+!FF U+042A afii10044

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/makefont.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/makefont.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/makefont.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,416 @@
+<?php
+/*******************************************************************************
+* Utility to generate font definition files                                    *
+* Version: 1.13                                                                *
+* Date:    2004-12-31                                                          *
+*******************************************************************************/
+
+function ReadMap($enc)
+{
+	//Read a map file
+	$file=dirname(__FILE__).'/'.strtolower($enc).'.map';
+	$a=file($file);
+	if(empty($a))
+		die('<B>Error:</B> encoding not found: '.$enc);
+	$cc2gn=array();
+	foreach($a as $l)
+	{
+		if($l{0}=='!')
+		{
+			$e=preg_split('/[ \\t]+/',rtrim($l));
+			$cc=hexdec(substr($e[0],1));
+			$gn=$e[2];
+			$cc2gn[$cc]=$gn;
+		}
+	}
+	for($i=0;$i<=255;$i++)
+	{
+		if(!isset($cc2gn[$i]))
+			$cc2gn[$i]='.notdef';
+	}
+	return $cc2gn;
+}
+
+function ReadAFM($file,&$map)
+{
+	//Read a font metric file
+	$a=file($file);
+	if(empty($a))
+		die('File not found');
+	$widths=array();
+	$fm=array();
+	$fix=array('Edot'=>'Edotaccent','edot'=>'edotaccent','Idot'=>'Idotaccent','Zdot'=>'Zdotaccent','zdot'=>'zdotaccent',
+		'Odblacute'=>'Ohungarumlaut','odblacute'=>'ohungarumlaut','Udblacute'=>'Uhungarumlaut','udblacute'=>'uhungarumlaut',
+		'Gcedilla'=>'Gcommaaccent','gcedilla'=>'gcommaaccent','Kcedilla'=>'Kcommaaccent','kcedilla'=>'kcommaaccent',
+		'Lcedilla'=>'Lcommaaccent','lcedilla'=>'lcommaaccent','Ncedilla'=>'Ncommaaccent','ncedilla'=>'ncommaaccent',
+		'Rcedilla'=>'Rcommaaccent','rcedilla'=>'rcommaaccent','Scedilla'=>'Scommaaccent','scedilla'=>'scommaaccent',
+		'Tcedilla'=>'Tcommaaccent','tcedilla'=>'tcommaaccent','Dslash'=>'Dcroat','dslash'=>'dcroat','Dmacron'=>'Dcroat','dmacron'=>'dcroat',
+		'combininggraveaccent'=>'gravecomb','combininghookabove'=>'hookabovecomb','combiningtildeaccent'=>'tildecomb',
+		'combiningacuteaccent'=>'acutecomb','combiningdotbelow'=>'dotbelowcomb','dongsign'=>'dong');
+	foreach($a as $l)
+	{
+		$e=explode(' ',rtrim($l));
+		if(count($e)<2)
+			continue;
+		$code=$e[0];
+		$param=$e[1];
+		if($code=='C')
+		{
+			//Character metrics
+			$cc=(int)$e[1];
+			$w=$e[4];
+			$gn=$e[7];
+			if(substr($gn,-4)=='20AC')
+				$gn='Euro';
+			if(isset($fix[$gn]))
+			{
+				//Fix incorrect glyph name
+				foreach($map as $c=>$n)
+				{
+					if($n==$fix[$gn])
+						$map[$c]=$gn;
+				}
+			}
+			if(empty($map))
+			{
+				//Symbolic font: use built-in encoding
+				$widths[$cc]=$w;
+			}
+			else
+			{
+				$widths[$gn]=$w;
+				if($gn=='X')
+					$fm['CapXHeight']=$e[13];
+			}
+			if($gn=='.notdef')
+				$fm['MissingWidth']=$w;
+		}
+		elseif($code=='FontName')
+			$fm['FontName']=$param;
+		elseif($code=='Weight')
+			$fm['Weight']=$param;
+		elseif($code=='ItalicAngle')
+			$fm['ItalicAngle']=(double)$param;
+		elseif($code=='Ascender')
+			$fm['Ascender']=(int)$param;
+		elseif($code=='Descender')
+			$fm['Descender']=(int)$param;
+		elseif($code=='UnderlineThickness')
+			$fm['UnderlineThickness']=(int)$param;
+		elseif($code=='UnderlinePosition')
+			$fm['UnderlinePosition']=(int)$param;
+		elseif($code=='IsFixedPitch')
+			$fm['IsFixedPitch']=($param=='true');
+		elseif($code=='FontBBox')
+			$fm['FontBBox']=array($e[1],$e[2],$e[3],$e[4]);
+		elseif($code=='CapHeight')
+			$fm['CapHeight']=(int)$param;
+		elseif($code=='StdVW')
+			$fm['StdVW']=(int)$param;
+	}
+	if(!isset($fm['FontName']))
+		die('FontName not found');
+	if(!empty($map))
+	{
+		if(!isset($widths['.notdef']))
+			$widths['.notdef']=600;
+		if(!isset($widths['Delta']) and isset($widths['increment']))
+			$widths['Delta']=$widths['increment'];
+		//Order widths according to map
+		for($i=0;$i<=255;$i++)
+		{
+			if(!isset($widths[$map[$i]]))
+			{
+				echo '<B>Warning:</B> character '.$map[$i].' is missing<BR>';
+				$widths[$i]=$widths['.notdef'];
+			}
+			else
+				$widths[$i]=$widths[$map[$i]];
+		}
+	}
+	$fm['Widths']=$widths;
+	return $fm;
+}
+
+function MakeFontDescriptor($fm,$symbolic)
+{
+	//Ascent
+	$asc=(isset($fm['Ascender']) ? $fm['Ascender'] : 1000);
+	$fd="array('Ascent'=>".$asc;
+	//Descent
+	$desc=(isset($fm['Descender']) ? $fm['Descender'] : -200);
+	$fd.=",'Descent'=>".$desc;
+	//CapHeight
+	if(isset($fm['CapHeight']))
+		$ch=$fm['CapHeight'];
+	elseif(isset($fm['CapXHeight']))
+		$ch=$fm['CapXHeight'];
+	else
+		$ch=$asc;
+	$fd.=",'CapHeight'=>".$ch;
+	//Flags
+	$flags=0;
+	if(isset($fm['IsFixedPitch']) and $fm['IsFixedPitch'])
+		$flags+=1<<0;
+	if($symbolic)
+		$flags+=1<<2;
+	if(!$symbolic)
+		$flags+=1<<5;
+	if(isset($fm['ItalicAngle']) and $fm['ItalicAngle']!=0)
+		$flags+=1<<6;
+	$fd.=",'Flags'=>".$flags;
+	//FontBBox
+	if(isset($fm['FontBBox']))
+		$fbb=$fm['FontBBox'];
+	else
+		$fbb=array(0,$des-100,1000,$asc+100);
+	$fd.=",'FontBBox'=>'[".$fbb[0].' '.$fbb[1].' '.$fbb[2].' '.$fbb[3]."]'";
+	//ItalicAngle
+	$ia=(isset($fm['ItalicAngle']) ? $fm['ItalicAngle'] : 0);
+	$fd.=",'ItalicAngle'=>".$ia;
+	//StemV
+	if(isset($fm['StdVW']))
+		$stemv=$fm['StdVW'];
+	elseif(isset($fm['Weight']) and eregi('(bold|black)',$fm['Weight']))
+		$stemv=120;
+	else
+		$stemv=70;
+	$fd.=",'StemV'=>".$stemv;
+	//MissingWidth
+	if(isset($fm['MissingWidth']))
+		$fd.=",'MissingWidth'=>".$fm['MissingWidth'];
+	$fd.=')';
+	return $fd;
+}
+
+function MakeWidthArray($fm)
+{
+	//Make character width array
+	$s="array(\n\t";
+	$cw=$fm['Widths'];
+	for($i=0;$i<=255;$i++)
+	{
+		if(chr($i)=="'")
+			$s.="'\\''";
+		elseif(chr($i)=="\\")
+			$s.="'\\\\'";
+		elseif($i>=32 and $i<=126)
+			$s.="'".chr($i)."'";
+		else
+			$s.="chr($i)";
+		$s.='=>'.$fm['Widths'][$i];
+		if($i<255)
+			$s.=',';
+		if(($i+1)%22==0)
+			$s.="\n\t";
+	}
+	$s.=')';
+	return $s;
+}
+
+function MakeFontEncoding($map)
+{
+	//Build differences from reference encoding
+	$ref=ReadMap('cp1252');
+	$s='';
+	$last=0;
+	for($i=32;$i<=255;$i++)
+	{
+		if($map[$i]!=$ref[$i])
+		{
+			if($i!=$last+1)
+				$s.=$i.' ';
+			$last=$i;
+			$s.='/'.$map[$i].' ';
+		}
+	}
+	return rtrim($s);
+}
+
+function SaveToFile($file,$s,$mode='t')
+{
+	$f=fopen($file,'w'.$mode);
+	if(!$f)
+		die('Can\'t write to file '.$file);
+	fwrite($f,$s,strlen($s));
+	fclose($f);
+}
+
+function ReadShort($f)
+{
+	$a=unpack('n1n',fread($f,2));
+	return $a['n'];
+}
+
+function ReadLong($f)
+{
+	$a=unpack('N1N',fread($f,4));
+	return $a['N'];
+}
+
+function CheckTTF($file)
+{
+	//Check if font license allows embedding
+	$f=fopen($file,'rb');
+	if(!$f)
+		die('<B>Error:</B> Can\'t open '.$file);
+	//Extract number of tables
+	fseek($f,4,SEEK_CUR);
+	$nb=ReadShort($f);
+	fseek($f,6,SEEK_CUR);
+	//Seek OS/2 table
+	$found=false;
+	for($i=0;$i<$nb;$i++)
+	{
+		if(fread($f,4)=='OS/2')
+		{
+			$found=true;
+			break;
+		}
+		fseek($f,12,SEEK_CUR);
+	}
+	if(!$found)
+	{
+		fclose($f);
+		return;
+	}
+	fseek($f,4,SEEK_CUR);
+	$offset=ReadLong($f);
+	fseek($f,$offset,SEEK_SET);
+	//Extract fsType flags
+	fseek($f,8,SEEK_CUR);
+	$fsType=ReadShort($f);
+	$rl=($fsType & 0x02)!=0;
+	$pp=($fsType & 0x04)!=0;
+	$e=($fsType & 0x08)!=0;
+	fclose($f);
+	if($rl and !$pp and !$e)
+		echo '<B>Warning:</B> font license does not allow embedding';
+}
+
+/*******************************************************************************
+* $fontfile : chemin du fichier TTF (ou cha?ne vide si pas d'incorporation)    *
+* $afmfile :  chemin du fichier AFM                                            *
+* $enc :      encodage (ou cha?ne vide si la police est symbolique)            *
+* $patch :    patch optionnel pour l'encodage                                  *
+* $type :     type de la police si $fontfile est vide                          *
+*******************************************************************************/
+function MakeFont($fontfile,$afmfile,$enc='cp1252',$patch=array(),$type='TrueType')
+{
+	//Generate a font definition file
+	set_magic_quotes_runtime(0);
+	ini_set('auto_detect_line_endings','1');
+	if($enc)
+	{
+		$map=ReadMap($enc);
+		foreach($patch as $cc=>$gn)
+			$map[$cc]=$gn;
+	}
+	else
+		$map=array();
+	if(!file_exists($afmfile))
+		die('<B>Error:</B> AFM file not found: '.$afmfile);
+	$fm=ReadAFM($afmfile,$map);
+	if($enc)
+		$diff=MakeFontEncoding($map);
+	else
+		$diff='';
+	$fd=MakeFontDescriptor($fm,empty($map));
+	//Find font type
+	if($fontfile)
+	{
+		$ext=strtolower(substr($fontfile,-3));
+		if($ext=='ttf')
+			$type='TrueType';
+		elseif($ext=='pfb')
+			$type='Type1';
+		else
+			die('<B>Error:</B> unrecognized font file extension: '.$ext);
+	}
+	else
+	{
+		if($type!='TrueType' and $type!='Type1')
+			die('<B>Error:</B> incorrect font type: '.$type);
+	}
+	//Start generation
+	$s='<?php'."\n";
+	$s.='$type=\''.$type."';\n";
+	$s.='$name=\''.$fm['FontName']."';\n";
+	$s.='$desc='.$fd.";\n";
+	if(!isset($fm['UnderlinePosition']))
+		$fm['UnderlinePosition']=-100;
+	if(!isset($fm['UnderlineThickness']))
+		$fm['UnderlineThickness']=50;
+	$s.='$up='.$fm['UnderlinePosition'].";\n";
+	$s.='$ut='.$fm['UnderlineThickness'].";\n";
+	$w=MakeWidthArray($fm);
+	$s.='$cw='.$w.";\n";
+	$s.='$enc=\''.$enc."';\n";
+	$s.='$diff=\''.$diff."';\n";
+	$basename=substr(basename($afmfile),0,-4);
+	if($fontfile)
+	{
+		//Embedded font
+		if(!file_exists($fontfile))
+			die('<B>Error:</B> font file not found: '.$fontfile);
+		if($type=='TrueType')
+			CheckTTF($fontfile);
+		$f=fopen($fontfile,'rb');
+		if(!$f)
+			die('<B>Error:</B> Can\'t open '.$fontfile);
+		$file=fread($f,filesize($fontfile));
+		fclose($f);
+		if($type=='Type1')
+		{
+			//Find first two sections and discard third one
+			$header=(ord($file{0})==128);
+			if($header)
+			{
+				//Strip first binary header
+				$file=substr($file,6);
+			}
+			$pos=strpos($file,'eexec');
+			if(!$pos)
+				die('<B>Error:</B> font file does not seem to be valid Type1');
+			$size1=$pos+6;
+			if($header and ord($file{$size1})==128)
+			{
+				//Strip second binary header
+				$file=substr($file,0,$size1).substr($file,$size1+6);
+			}
+			$pos=strpos($file,'00000000');
+			if(!$pos)
+				die('<B>Error:</B> font file does not seem to be valid Type1');
+			$size2=$pos-$size1;
+			$file=substr($file,0,$size1+$size2);
+		}
+		if(function_exists('gzcompress'))
+		{
+			$cmp=$basename.'.z';
+			SaveToFile($cmp,gzcompress($file),'b');
+			$s.='$file=\''.$cmp."';\n";
+			echo 'Font file compressed ('.$cmp.')<BR>';
+		}
+		else
+		{
+			$s.='$file=\''.basename($fontfile)."';\n";
+			echo '<B>Notice:</B> font file could not be compressed (zlib extension not available)<BR>';
+		}
+		if($type=='Type1')
+		{
+			$s.='$size1='.$size1.";\n";
+			$s.='$size2='.$size2.";\n";
+		}
+		else
+			$s.='$originalsize='.filesize($fontfile).";\n";
+	}
+	else
+	{
+		//Not embedded font
+		$s.='$file='."'';\n";
+	}
+	$s.="?>\n";
+	SaveToFile($basename.'.php',$s);
+	echo 'Font definition file generated ('.$basename.'.php'.')<BR>';
+}
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/makefont/makefont.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/symbol.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/symbol.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/symbol.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['symbol']=array(
+	chr(0)=>250,chr(1)=>250,chr(2)=>250,chr(3)=>250,chr(4)=>250,chr(5)=>250,chr(6)=>250,chr(7)=>250,chr(8)=>250,chr(9)=>250,chr(10)=>250,chr(11)=>250,chr(12)=>250,chr(13)=>250,chr(14)=>250,chr(15)=>250,chr(16)=>250,chr(17)=>250,chr(18)=>250,chr(19)=>250,chr(20)=>250,chr(21)=>250,
+	chr(22)=>250,chr(23)=>250,chr(24)=>250,chr(25)=>250,chr(26)=>250,chr(27)=>250,chr(28)=>250,chr(29)=>250,chr(30)=>250,chr(31)=>250,' '=>250,'!'=>333,'"'=>713,'#'=>500,'$'=>549,'%'=>833,'&'=>778,'\''=>439,'('=>333,')'=>333,'*'=>500,'+'=>549,
+	','=>250,'-'=>549,'.'=>250,'/'=>278,'0'=>500,'1'=>500,'2'=>500,'3'=>500,'4'=>500,'5'=>500,'6'=>500,'7'=>500,'8'=>500,'9'=>500,':'=>278,';'=>278,'<'=>549,'='=>549,'>'=>549,'?'=>444,'@'=>549,'A'=>722,
+	'B'=>667,'C'=>722,'D'=>612,'E'=>611,'F'=>763,'G'=>603,'H'=>722,'I'=>333,'J'=>631,'K'=>722,'L'=>686,'M'=>889,'N'=>722,'O'=>722,'P'=>768,'Q'=>741,'R'=>556,'S'=>592,'T'=>611,'U'=>690,'V'=>439,'W'=>768,
+	'X'=>645,'Y'=>795,'Z'=>611,'['=>333,'\\'=>863,']'=>333,'^'=>658,'_'=>500,'`'=>500,'a'=>631,'b'=>549,'c'=>549,'d'=>494,'e'=>439,'f'=>521,'g'=>411,'h'=>603,'i'=>329,'j'=>603,'k'=>549,'l'=>549,'m'=>576,
+	'n'=>521,'o'=>549,'p'=>549,'q'=>521,'r'=>549,'s'=>603,'t'=>439,'u'=>576,'v'=>713,'w'=>686,'x'=>493,'y'=>686,'z'=>494,'{'=>480,'|'=>200,'}'=>480,'~'=>549,chr(127)=>0,chr(128)=>0,chr(129)=>0,chr(130)=>0,chr(131)=>0,
+	chr(132)=>0,chr(133)=>0,chr(134)=>0,chr(135)=>0,chr(136)=>0,chr(137)=>0,chr(138)=>0,chr(139)=>0,chr(140)=>0,chr(141)=>0,chr(142)=>0,chr(143)=>0,chr(144)=>0,chr(145)=>0,chr(146)=>0,chr(147)=>0,chr(148)=>0,chr(149)=>0,chr(150)=>0,chr(151)=>0,chr(152)=>0,chr(153)=>0,
+	chr(154)=>0,chr(155)=>0,chr(156)=>0,chr(157)=>0,chr(158)=>0,chr(159)=>0,chr(160)=>750,chr(161)=>620,chr(162)=>247,chr(163)=>549,chr(164)=>167,chr(165)=>713,chr(166)=>500,chr(167)=>753,chr(168)=>753,chr(169)=>753,chr(170)=>753,chr(171)=>1042,chr(172)=>987,chr(173)=>603,chr(174)=>987,chr(175)=>603,
+	chr(176)=>400,chr(177)=>549,chr(178)=>411,chr(179)=>549,chr(180)=>549,chr(181)=>713,chr(182)=>494,chr(183)=>460,chr(184)=>549,chr(185)=>549,chr(186)=>549,chr(187)=>549,chr(188)=>1000,chr(189)=>603,chr(190)=>1000,chr(191)=>658,chr(192)=>823,chr(193)=>686,chr(194)=>795,chr(195)=>987,chr(196)=>768,chr(197)=>768,
+	chr(198)=>823,chr(199)=>768,chr(200)=>768,chr(201)=>713,chr(202)=>713,chr(203)=>713,chr(204)=>713,chr(205)=>713,chr(206)=>713,chr(207)=>713,chr(208)=>768,chr(209)=>713,chr(210)=>790,chr(211)=>790,chr(212)=>890,chr(213)=>823,chr(214)=>549,chr(215)=>250,chr(216)=>713,chr(217)=>603,chr(218)=>603,chr(219)=>1042,
+	chr(220)=>987,chr(221)=>603,chr(222)=>987,chr(223)=>603,chr(224)=>494,chr(225)=>329,chr(226)=>790,chr(227)=>790,chr(228)=>786,chr(229)=>713,chr(230)=>384,chr(231)=>384,chr(232)=>384,chr(233)=>384,chr(234)=>384,chr(235)=>384,chr(236)=>494,chr(237)=>494,chr(238)=>494,chr(239)=>494,chr(240)=>0,chr(241)=>329,
+	chr(242)=>274,chr(243)=>686,chr(244)=>686,chr(245)=>686,chr(246)=>384,chr(247)=>384,chr(248)=>384,chr(249)=>384,chr(250)=>384,chr(251)=>384,chr(252)=>494,chr(253)=>494,chr(254)=>494,chr(255)=>0);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/symbol.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/times.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/times.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/times.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['times']=array(
+	chr(0)=>250,chr(1)=>250,chr(2)=>250,chr(3)=>250,chr(4)=>250,chr(5)=>250,chr(6)=>250,chr(7)=>250,chr(8)=>250,chr(9)=>250,chr(10)=>250,chr(11)=>250,chr(12)=>250,chr(13)=>250,chr(14)=>250,chr(15)=>250,chr(16)=>250,chr(17)=>250,chr(18)=>250,chr(19)=>250,chr(20)=>250,chr(21)=>250,
+	chr(22)=>250,chr(23)=>250,chr(24)=>250,chr(25)=>250,chr(26)=>250,chr(27)=>250,chr(28)=>250,chr(29)=>250,chr(30)=>250,chr(31)=>250,' '=>250,'!'=>333,'"'=>408,'#'=>500,'$'=>500,'%'=>833,'&'=>778,'\''=>180,'('=>333,')'=>333,'*'=>500,'+'=>564,
+	','=>250,'-'=>333,'.'=>250,'/'=>278,'0'=>500,'1'=>500,'2'=>500,'3'=>500,'4'=>500,'5'=>500,'6'=>500,'7'=>500,'8'=>500,'9'=>500,':'=>278,';'=>278,'<'=>564,'='=>564,'>'=>564,'?'=>444,'@'=>921,'A'=>722,
+	'B'=>667,'C'=>667,'D'=>722,'E'=>611,'F'=>556,'G'=>722,'H'=>722,'I'=>333,'J'=>389,'K'=>722,'L'=>611,'M'=>889,'N'=>722,'O'=>722,'P'=>556,'Q'=>722,'R'=>667,'S'=>556,'T'=>611,'U'=>722,'V'=>722,'W'=>944,
+	'X'=>722,'Y'=>722,'Z'=>611,'['=>333,'\\'=>278,']'=>333,'^'=>469,'_'=>500,'`'=>333,'a'=>444,'b'=>500,'c'=>444,'d'=>500,'e'=>444,'f'=>333,'g'=>500,'h'=>500,'i'=>278,'j'=>278,'k'=>500,'l'=>278,'m'=>778,
+	'n'=>500,'o'=>500,'p'=>500,'q'=>500,'r'=>333,'s'=>389,'t'=>278,'u'=>500,'v'=>500,'w'=>722,'x'=>500,'y'=>500,'z'=>444,'{'=>480,'|'=>200,'}'=>480,'~'=>541,chr(127)=>350,chr(128)=>500,chr(129)=>350,chr(130)=>333,chr(131)=>500,
+	chr(132)=>444,chr(133)=>1000,chr(134)=>500,chr(135)=>500,chr(136)=>333,chr(137)=>1000,chr(138)=>556,chr(139)=>333,chr(140)=>889,chr(141)=>350,chr(142)=>611,chr(143)=>350,chr(144)=>350,chr(145)=>333,chr(146)=>333,chr(147)=>444,chr(148)=>444,chr(149)=>350,chr(150)=>500,chr(151)=>1000,chr(152)=>333,chr(153)=>980,
+	chr(154)=>389,chr(155)=>333,chr(156)=>722,chr(157)=>350,chr(158)=>444,chr(159)=>722,chr(160)=>250,chr(161)=>333,chr(162)=>500,chr(163)=>500,chr(164)=>500,chr(165)=>500,chr(166)=>200,chr(167)=>500,chr(168)=>333,chr(169)=>760,chr(170)=>276,chr(171)=>500,chr(172)=>564,chr(173)=>333,chr(174)=>760,chr(175)=>333,
+	chr(176)=>400,chr(177)=>564,chr(178)=>300,chr(179)=>300,chr(180)=>333,chr(181)=>500,chr(182)=>453,chr(183)=>250,chr(184)=>333,chr(185)=>300,chr(186)=>310,chr(187)=>500,chr(188)=>750,chr(189)=>750,chr(190)=>750,chr(191)=>444,chr(192)=>722,chr(193)=>722,chr(194)=>722,chr(195)=>722,chr(196)=>722,chr(197)=>722,
+	chr(198)=>889,chr(199)=>667,chr(200)=>611,chr(201)=>611,chr(202)=>611,chr(203)=>611,chr(204)=>333,chr(205)=>333,chr(206)=>333,chr(207)=>333,chr(208)=>722,chr(209)=>722,chr(210)=>722,chr(211)=>722,chr(212)=>722,chr(213)=>722,chr(214)=>722,chr(215)=>564,chr(216)=>722,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>722,chr(222)=>556,chr(223)=>500,chr(224)=>444,chr(225)=>444,chr(226)=>444,chr(227)=>444,chr(228)=>444,chr(229)=>444,chr(230)=>667,chr(231)=>444,chr(232)=>444,chr(233)=>444,chr(234)=>444,chr(235)=>444,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>500,chr(241)=>500,
+	chr(242)=>500,chr(243)=>500,chr(244)=>500,chr(245)=>500,chr(246)=>500,chr(247)=>564,chr(248)=>500,chr(249)=>500,chr(250)=>500,chr(251)=>500,chr(252)=>500,chr(253)=>500,chr(254)=>500,chr(255)=>500);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/times.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesb.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesb.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesb.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['timesB']=array(
+	chr(0)=>250,chr(1)=>250,chr(2)=>250,chr(3)=>250,chr(4)=>250,chr(5)=>250,chr(6)=>250,chr(7)=>250,chr(8)=>250,chr(9)=>250,chr(10)=>250,chr(11)=>250,chr(12)=>250,chr(13)=>250,chr(14)=>250,chr(15)=>250,chr(16)=>250,chr(17)=>250,chr(18)=>250,chr(19)=>250,chr(20)=>250,chr(21)=>250,
+	chr(22)=>250,chr(23)=>250,chr(24)=>250,chr(25)=>250,chr(26)=>250,chr(27)=>250,chr(28)=>250,chr(29)=>250,chr(30)=>250,chr(31)=>250,' '=>250,'!'=>333,'"'=>555,'#'=>500,'$'=>500,'%'=>1000,'&'=>833,'\''=>278,'('=>333,')'=>333,'*'=>500,'+'=>570,
+	','=>250,'-'=>333,'.'=>250,'/'=>278,'0'=>500,'1'=>500,'2'=>500,'3'=>500,'4'=>500,'5'=>500,'6'=>500,'7'=>500,'8'=>500,'9'=>500,':'=>333,';'=>333,'<'=>570,'='=>570,'>'=>570,'?'=>500,'@'=>930,'A'=>722,
+	'B'=>667,'C'=>722,'D'=>722,'E'=>667,'F'=>611,'G'=>778,'H'=>778,'I'=>389,'J'=>500,'K'=>778,'L'=>667,'M'=>944,'N'=>722,'O'=>778,'P'=>611,'Q'=>778,'R'=>722,'S'=>556,'T'=>667,'U'=>722,'V'=>722,'W'=>1000,
+	'X'=>722,'Y'=>722,'Z'=>667,'['=>333,'\\'=>278,']'=>333,'^'=>581,'_'=>500,'`'=>333,'a'=>500,'b'=>556,'c'=>444,'d'=>556,'e'=>444,'f'=>333,'g'=>500,'h'=>556,'i'=>278,'j'=>333,'k'=>556,'l'=>278,'m'=>833,
+	'n'=>556,'o'=>500,'p'=>556,'q'=>556,'r'=>444,'s'=>389,'t'=>333,'u'=>556,'v'=>500,'w'=>722,'x'=>500,'y'=>500,'z'=>444,'{'=>394,'|'=>220,'}'=>394,'~'=>520,chr(127)=>350,chr(128)=>500,chr(129)=>350,chr(130)=>333,chr(131)=>500,
+	chr(132)=>500,chr(133)=>1000,chr(134)=>500,chr(135)=>500,chr(136)=>333,chr(137)=>1000,chr(138)=>556,chr(139)=>333,chr(140)=>1000,chr(141)=>350,chr(142)=>667,chr(143)=>350,chr(144)=>350,chr(145)=>333,chr(146)=>333,chr(147)=>500,chr(148)=>500,chr(149)=>350,chr(150)=>500,chr(151)=>1000,chr(152)=>333,chr(153)=>1000,
+	chr(154)=>389,chr(155)=>333,chr(156)=>722,chr(157)=>350,chr(158)=>444,chr(159)=>722,chr(160)=>250,chr(161)=>333,chr(162)=>500,chr(163)=>500,chr(164)=>500,chr(165)=>500,chr(166)=>220,chr(167)=>500,chr(168)=>333,chr(169)=>747,chr(170)=>300,chr(171)=>500,chr(172)=>570,chr(173)=>333,chr(174)=>747,chr(175)=>333,
+	chr(176)=>400,chr(177)=>570,chr(178)=>300,chr(179)=>300,chr(180)=>333,chr(181)=>556,chr(182)=>540,chr(183)=>250,chr(184)=>333,chr(185)=>300,chr(186)=>330,chr(187)=>500,chr(188)=>750,chr(189)=>750,chr(190)=>750,chr(191)=>500,chr(192)=>722,chr(193)=>722,chr(194)=>722,chr(195)=>722,chr(196)=>722,chr(197)=>722,
+	chr(198)=>1000,chr(199)=>722,chr(200)=>667,chr(201)=>667,chr(202)=>667,chr(203)=>667,chr(204)=>389,chr(205)=>389,chr(206)=>389,chr(207)=>389,chr(208)=>722,chr(209)=>722,chr(210)=>778,chr(211)=>778,chr(212)=>778,chr(213)=>778,chr(214)=>778,chr(215)=>570,chr(216)=>778,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>722,chr(222)=>611,chr(223)=>556,chr(224)=>500,chr(225)=>500,chr(226)=>500,chr(227)=>500,chr(228)=>500,chr(229)=>500,chr(230)=>722,chr(231)=>444,chr(232)=>444,chr(233)=>444,chr(234)=>444,chr(235)=>444,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>500,chr(241)=>556,
+	chr(242)=>500,chr(243)=>500,chr(244)=>500,chr(245)=>500,chr(246)=>500,chr(247)=>570,chr(248)=>500,chr(249)=>556,chr(250)=>556,chr(251)=>556,chr(252)=>556,chr(253)=>500,chr(254)=>556,chr(255)=>500);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesb.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesbi.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesbi.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesbi.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['timesBI']=array(
+	chr(0)=>250,chr(1)=>250,chr(2)=>250,chr(3)=>250,chr(4)=>250,chr(5)=>250,chr(6)=>250,chr(7)=>250,chr(8)=>250,chr(9)=>250,chr(10)=>250,chr(11)=>250,chr(12)=>250,chr(13)=>250,chr(14)=>250,chr(15)=>250,chr(16)=>250,chr(17)=>250,chr(18)=>250,chr(19)=>250,chr(20)=>250,chr(21)=>250,
+	chr(22)=>250,chr(23)=>250,chr(24)=>250,chr(25)=>250,chr(26)=>250,chr(27)=>250,chr(28)=>250,chr(29)=>250,chr(30)=>250,chr(31)=>250,' '=>250,'!'=>389,'"'=>555,'#'=>500,'$'=>500,'%'=>833,'&'=>778,'\''=>278,'('=>333,')'=>333,'*'=>500,'+'=>570,
+	','=>250,'-'=>333,'.'=>250,'/'=>278,'0'=>500,'1'=>500,'2'=>500,'3'=>500,'4'=>500,'5'=>500,'6'=>500,'7'=>500,'8'=>500,'9'=>500,':'=>333,';'=>333,'<'=>570,'='=>570,'>'=>570,'?'=>500,'@'=>832,'A'=>667,
+	'B'=>667,'C'=>667,'D'=>722,'E'=>667,'F'=>667,'G'=>722,'H'=>778,'I'=>389,'J'=>500,'K'=>667,'L'=>611,'M'=>889,'N'=>722,'O'=>722,'P'=>611,'Q'=>722,'R'=>667,'S'=>556,'T'=>611,'U'=>722,'V'=>667,'W'=>889,
+	'X'=>667,'Y'=>611,'Z'=>611,'['=>333,'\\'=>278,']'=>333,'^'=>570,'_'=>500,'`'=>333,'a'=>500,'b'=>500,'c'=>444,'d'=>500,'e'=>444,'f'=>333,'g'=>500,'h'=>556,'i'=>278,'j'=>278,'k'=>500,'l'=>278,'m'=>778,
+	'n'=>556,'o'=>500,'p'=>500,'q'=>500,'r'=>389,'s'=>389,'t'=>278,'u'=>556,'v'=>444,'w'=>667,'x'=>500,'y'=>444,'z'=>389,'{'=>348,'|'=>220,'}'=>348,'~'=>570,chr(127)=>350,chr(128)=>500,chr(129)=>350,chr(130)=>333,chr(131)=>500,
+	chr(132)=>500,chr(133)=>1000,chr(134)=>500,chr(135)=>500,chr(136)=>333,chr(137)=>1000,chr(138)=>556,chr(139)=>333,chr(140)=>944,chr(141)=>350,chr(142)=>611,chr(143)=>350,chr(144)=>350,chr(145)=>333,chr(146)=>333,chr(147)=>500,chr(148)=>500,chr(149)=>350,chr(150)=>500,chr(151)=>1000,chr(152)=>333,chr(153)=>1000,
+	chr(154)=>389,chr(155)=>333,chr(156)=>722,chr(157)=>350,chr(158)=>389,chr(159)=>611,chr(160)=>250,chr(161)=>389,chr(162)=>500,chr(163)=>500,chr(164)=>500,chr(165)=>500,chr(166)=>220,chr(167)=>500,chr(168)=>333,chr(169)=>747,chr(170)=>266,chr(171)=>500,chr(172)=>606,chr(173)=>333,chr(174)=>747,chr(175)=>333,
+	chr(176)=>400,chr(177)=>570,chr(178)=>300,chr(179)=>300,chr(180)=>333,chr(181)=>576,chr(182)=>500,chr(183)=>250,chr(184)=>333,chr(185)=>300,chr(186)=>300,chr(187)=>500,chr(188)=>750,chr(189)=>750,chr(190)=>750,chr(191)=>500,chr(192)=>667,chr(193)=>667,chr(194)=>667,chr(195)=>667,chr(196)=>667,chr(197)=>667,
+	chr(198)=>944,chr(199)=>667,chr(200)=>667,chr(201)=>667,chr(202)=>667,chr(203)=>667,chr(204)=>389,chr(205)=>389,chr(206)=>389,chr(207)=>389,chr(208)=>722,chr(209)=>722,chr(210)=>722,chr(211)=>722,chr(212)=>722,chr(213)=>722,chr(214)=>722,chr(215)=>570,chr(216)=>722,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>611,chr(222)=>611,chr(223)=>500,chr(224)=>500,chr(225)=>500,chr(226)=>500,chr(227)=>500,chr(228)=>500,chr(229)=>500,chr(230)=>722,chr(231)=>444,chr(232)=>444,chr(233)=>444,chr(234)=>444,chr(235)=>444,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>500,chr(241)=>556,
+	chr(242)=>500,chr(243)=>500,chr(244)=>500,chr(245)=>500,chr(246)=>500,chr(247)=>570,chr(248)=>500,chr(249)=>556,chr(250)=>556,chr(251)=>556,chr(252)=>556,chr(253)=>444,chr(254)=>500,chr(255)=>444);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesbi.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesi.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesi.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesi.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['timesI']=array(
+	chr(0)=>250,chr(1)=>250,chr(2)=>250,chr(3)=>250,chr(4)=>250,chr(5)=>250,chr(6)=>250,chr(7)=>250,chr(8)=>250,chr(9)=>250,chr(10)=>250,chr(11)=>250,chr(12)=>250,chr(13)=>250,chr(14)=>250,chr(15)=>250,chr(16)=>250,chr(17)=>250,chr(18)=>250,chr(19)=>250,chr(20)=>250,chr(21)=>250,
+	chr(22)=>250,chr(23)=>250,chr(24)=>250,chr(25)=>250,chr(26)=>250,chr(27)=>250,chr(28)=>250,chr(29)=>250,chr(30)=>250,chr(31)=>250,' '=>250,'!'=>333,'"'=>420,'#'=>500,'$'=>500,'%'=>833,'&'=>778,'\''=>214,'('=>333,')'=>333,'*'=>500,'+'=>675,
+	','=>250,'-'=>333,'.'=>250,'/'=>278,'0'=>500,'1'=>500,'2'=>500,'3'=>500,'4'=>500,'5'=>500,'6'=>500,'7'=>500,'8'=>500,'9'=>500,':'=>333,';'=>333,'<'=>675,'='=>675,'>'=>675,'?'=>500,'@'=>920,'A'=>611,
+	'B'=>611,'C'=>667,'D'=>722,'E'=>611,'F'=>611,'G'=>722,'H'=>722,'I'=>333,'J'=>444,'K'=>667,'L'=>556,'M'=>833,'N'=>667,'O'=>722,'P'=>611,'Q'=>722,'R'=>611,'S'=>500,'T'=>556,'U'=>722,'V'=>611,'W'=>833,
+	'X'=>611,'Y'=>556,'Z'=>556,'['=>389,'\\'=>278,']'=>389,'^'=>422,'_'=>500,'`'=>333,'a'=>500,'b'=>500,'c'=>444,'d'=>500,'e'=>444,'f'=>278,'g'=>500,'h'=>500,'i'=>278,'j'=>278,'k'=>444,'l'=>278,'m'=>722,
+	'n'=>500,'o'=>500,'p'=>500,'q'=>500,'r'=>389,'s'=>389,'t'=>278,'u'=>500,'v'=>444,'w'=>667,'x'=>444,'y'=>444,'z'=>389,'{'=>400,'|'=>275,'}'=>400,'~'=>541,chr(127)=>350,chr(128)=>500,chr(129)=>350,chr(130)=>333,chr(131)=>500,
+	chr(132)=>556,chr(133)=>889,chr(134)=>500,chr(135)=>500,chr(136)=>333,chr(137)=>1000,chr(138)=>500,chr(139)=>333,chr(140)=>944,chr(141)=>350,chr(142)=>556,chr(143)=>350,chr(144)=>350,chr(145)=>333,chr(146)=>333,chr(147)=>556,chr(148)=>556,chr(149)=>350,chr(150)=>500,chr(151)=>889,chr(152)=>333,chr(153)=>980,
+	chr(154)=>389,chr(155)=>333,chr(156)=>667,chr(157)=>350,chr(158)=>389,chr(159)=>556,chr(160)=>250,chr(161)=>389,chr(162)=>500,chr(163)=>500,chr(164)=>500,chr(165)=>500,chr(166)=>275,chr(167)=>500,chr(168)=>333,chr(169)=>760,chr(170)=>276,chr(171)=>500,chr(172)=>675,chr(173)=>333,chr(174)=>760,chr(175)=>333,
+	chr(176)=>400,chr(177)=>675,chr(178)=>300,chr(179)=>300,chr(180)=>333,chr(181)=>500,chr(182)=>523,chr(183)=>250,chr(184)=>333,chr(185)=>300,chr(186)=>310,chr(187)=>500,chr(188)=>750,chr(189)=>750,chr(190)=>750,chr(191)=>500,chr(192)=>611,chr(193)=>611,chr(194)=>611,chr(195)=>611,chr(196)=>611,chr(197)=>611,
+	chr(198)=>889,chr(199)=>667,chr(200)=>611,chr(201)=>611,chr(202)=>611,chr(203)=>611,chr(204)=>333,chr(205)=>333,chr(206)=>333,chr(207)=>333,chr(208)=>722,chr(209)=>667,chr(210)=>722,chr(211)=>722,chr(212)=>722,chr(213)=>722,chr(214)=>722,chr(215)=>675,chr(216)=>722,chr(217)=>722,chr(218)=>722,chr(219)=>722,
+	chr(220)=>722,chr(221)=>556,chr(222)=>611,chr(223)=>500,chr(224)=>500,chr(225)=>500,chr(226)=>500,chr(227)=>500,chr(228)=>500,chr(229)=>500,chr(230)=>667,chr(231)=>444,chr(232)=>444,chr(233)=>444,chr(234)=>444,chr(235)=>444,chr(236)=>278,chr(237)=>278,chr(238)=>278,chr(239)=>278,chr(240)=>500,chr(241)=>500,
+	chr(242)=>500,chr(243)=>500,chr(244)=>500,chr(245)=>500,chr(246)=>500,chr(247)=>675,chr(248)=>500,chr(249)=>500,chr(250)=>500,chr(251)=>500,chr(252)=>500,chr(253)=>444,chr(254)=>500,chr(255)=>444);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/timesi.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/zapfdingbats.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/zapfdingbats.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/zapfdingbats.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,15 @@
+<?php
+$fpdf_charwidths['zapfdingbats']=array(
+	chr(0)=>0,chr(1)=>0,chr(2)=>0,chr(3)=>0,chr(4)=>0,chr(5)=>0,chr(6)=>0,chr(7)=>0,chr(8)=>0,chr(9)=>0,chr(10)=>0,chr(11)=>0,chr(12)=>0,chr(13)=>0,chr(14)=>0,chr(15)=>0,chr(16)=>0,chr(17)=>0,chr(18)=>0,chr(19)=>0,chr(20)=>0,chr(21)=>0,
+	chr(22)=>0,chr(23)=>0,chr(24)=>0,chr(25)=>0,chr(26)=>0,chr(27)=>0,chr(28)=>0,chr(29)=>0,chr(30)=>0,chr(31)=>0,' '=>278,'!'=>974,'"'=>961,'#'=>974,'$'=>980,'%'=>719,'&'=>789,'\''=>790,'('=>791,')'=>690,'*'=>960,'+'=>939,
+	','=>549,'-'=>855,'.'=>911,'/'=>933,'0'=>911,'1'=>945,'2'=>974,'3'=>755,'4'=>846,'5'=>762,'6'=>761,'7'=>571,'8'=>677,'9'=>763,':'=>760,';'=>759,'<'=>754,'='=>494,'>'=>552,'?'=>537,'@'=>577,'A'=>692,
+	'B'=>786,'C'=>788,'D'=>788,'E'=>790,'F'=>793,'G'=>794,'H'=>816,'I'=>823,'J'=>789,'K'=>841,'L'=>823,'M'=>833,'N'=>816,'O'=>831,'P'=>923,'Q'=>744,'R'=>723,'S'=>749,'T'=>790,'U'=>792,'V'=>695,'W'=>776,
+	'X'=>768,'Y'=>792,'Z'=>759,'['=>707,'\\'=>708,']'=>682,'^'=>701,'_'=>826,'`'=>815,'a'=>789,'b'=>789,'c'=>707,'d'=>687,'e'=>696,'f'=>689,'g'=>786,'h'=>787,'i'=>713,'j'=>791,'k'=>785,'l'=>791,'m'=>873,
+	'n'=>761,'o'=>762,'p'=>762,'q'=>759,'r'=>759,'s'=>892,'t'=>892,'u'=>788,'v'=>784,'w'=>438,'x'=>138,'y'=>277,'z'=>415,'{'=>392,'|'=>392,'}'=>668,'~'=>668,chr(127)=>0,chr(128)=>390,chr(129)=>390,chr(130)=>317,chr(131)=>317,
+	chr(132)=>276,chr(133)=>276,chr(134)=>509,chr(135)=>509,chr(136)=>410,chr(137)=>410,chr(138)=>234,chr(139)=>234,chr(140)=>334,chr(141)=>334,chr(142)=>0,chr(143)=>0,chr(144)=>0,chr(145)=>0,chr(146)=>0,chr(147)=>0,chr(148)=>0,chr(149)=>0,chr(150)=>0,chr(151)=>0,chr(152)=>0,chr(153)=>0,
+	chr(154)=>0,chr(155)=>0,chr(156)=>0,chr(157)=>0,chr(158)=>0,chr(159)=>0,chr(160)=>0,chr(161)=>732,chr(162)=>544,chr(163)=>544,chr(164)=>910,chr(165)=>667,chr(166)=>760,chr(167)=>760,chr(168)=>776,chr(169)=>595,chr(170)=>694,chr(171)=>626,chr(172)=>788,chr(173)=>788,chr(174)=>788,chr(175)=>788,
+	chr(176)=>788,chr(177)=>788,chr(178)=>788,chr(179)=>788,chr(180)=>788,chr(181)=>788,chr(182)=>788,chr(183)=>788,chr(184)=>788,chr(185)=>788,chr(186)=>788,chr(187)=>788,chr(188)=>788,chr(189)=>788,chr(190)=>788,chr(191)=>788,chr(192)=>788,chr(193)=>788,chr(194)=>788,chr(195)=>788,chr(196)=>788,chr(197)=>788,
+	chr(198)=>788,chr(199)=>788,chr(200)=>788,chr(201)=>788,chr(202)=>788,chr(203)=>788,chr(204)=>788,chr(205)=>788,chr(206)=>788,chr(207)=>788,chr(208)=>788,chr(209)=>788,chr(210)=>788,chr(211)=>788,chr(212)=>894,chr(213)=>838,chr(214)=>1016,chr(215)=>458,chr(216)=>748,chr(217)=>924,chr(218)=>748,chr(219)=>918,
+	chr(220)=>927,chr(221)=>928,chr(222)=>928,chr(223)=>834,chr(224)=>873,chr(225)=>828,chr(226)=>924,chr(227)=>924,chr(228)=>917,chr(229)=>930,chr(230)=>931,chr(231)=>463,chr(232)=>883,chr(233)=>836,chr(234)=>836,chr(235)=>867,chr(236)=>867,chr(237)=>696,chr(238)=>696,chr(239)=>874,chr(240)=>0,chr(241)=>874,
+	chr(242)=>760,chr(243)=>946,chr(244)=>771,chr(245)=>865,chr(246)=>771,chr(247)=>888,chr(248)=>967,chr(249)=>888,chr(250)=>831,chr(251)=>873,chr(252)=>927,chr(253)=>970,chr(254)=>918,chr(255)=>0);
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/font/zapfdingbats.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/fpdf.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/fpdf.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/fpdf.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,1647 @@
+<?php
+/*******************************************************************************
+* Software: FPDF                                                               *
+* Version:  1.53                                                               *
+* Date:     2004-12-31                                                         *
+* Author:   Olivier PLATHEY                                                    *
+* License:  Freeware                                                           *
+*                                                                              *
+* You may use, modify and redistribute this software as you wish.              *
+*******************************************************************************/
+
+if(!class_exists('FPDF'))
+{
+define('FPDF_VERSION','1.53');
+
+class FPDF
+{
+//Private properties
+var $page;               //current page number
+var $n;                  //current object number
+var $offsets;            //array of object offsets
+var $buffer;             //buffer holding in-memory PDF
+var $pages;              //array containing pages
+var $state;              //current document state
+var $compress;           //compression flag
+var $DefOrientation;     //default orientation
+var $CurOrientation;     //current orientation
+var $OrientationChanges; //array indicating orientation changes
+var $k;                  //scale factor (number of points in user unit)
+var $fwPt,$fhPt;         //dimensions of page format in points
+var $fw,$fh;             //dimensions of page format in user unit
+var $wPt,$hPt;           //current dimensions of page in points
+var $w,$h;               //current dimensions of page in user unit
+var $lMargin;            //left margin
+var $tMargin;            //top margin
+var $rMargin;            //right margin
+var $bMargin;            //page break margin
+var $cMargin;            //cell margin
+var $x,$y;               //current position in user unit for cell positioning
+var $lasth;              //height of last cell printed
+var $LineWidth;          //line width in user unit
+var $CoreFonts;          //array of standard font names
+var $fonts;              //array of used fonts
+var $FontFiles;          //array of font files
+var $diffs;              //array of encoding differences
+var $images;             //array of used images
+var $PageLinks;          //array of links in pages
+var $links;              //array of internal links
+var $FontFamily;         //current font family
+var $FontStyle;          //current font style
+var $underline;          //underlining flag
+var $CurrentFont;        //current font info
+var $FontSizePt;         //current font size in points
+var $FontSize;           //current font size in user unit
+var $DrawColor;          //commands for drawing color
+var $FillColor;          //commands for filling color
+var $TextColor;          //commands for text color
+var $ColorFlag;          //indicates whether fill and text colors are different
+var $ws;                 //word spacing
+var $AutoPageBreak;      //automatic page breaking
+var $PageBreakTrigger;   //threshold used to trigger page breaks
+var $InFooter;           //flag set when processing footer
+var $ZoomMode;           //zoom display mode
+var $LayoutMode;         //layout display mode
+var $title;              //title
+var $subject;            //subject
+var $author;             //author
+var $keywords;           //keywords
+var $creator;            //creator
+var $AliasNbPages;       //alias for total number of pages
+var $PDFVersion;         //PDF version number
+
+/*******************************************************************************
+*                                                                              *
+*                               Public methods                                 *
+*                                                                              *
+*******************************************************************************/
+function FPDF($orientation='P',$unit='mm',$format='A4')
+{
+	//Some checks
+	$this->_dochecks();
+	//Initialization of properties
+	$this->page=0;
+	$this->n=2;
+	$this->buffer='';
+	$this->pages=array();
+	$this->OrientationChanges=array();
+	$this->state=0;
+	$this->fonts=array();
+	$this->FontFiles=array();
+	$this->diffs=array();
+	$this->images=array();
+	$this->links=array();
+	$this->InFooter=false;
+	$this->lasth=0;
+	$this->FontFamily='';
+	$this->FontStyle='';
+	$this->FontSizePt=12;
+	$this->underline=false;
+	$this->DrawColor='0 G';
+	$this->FillColor='0 g';
+	$this->TextColor='0 g';
+	$this->ColorFlag=false;
+	$this->ws=0;
+	//Standard fonts
+	$this->CoreFonts=array('courier'=>'Courier','courierB'=>'Courier-Bold','courierI'=>'Courier-Oblique','courierBI'=>'Courier-BoldOblique',
+		'helvetica'=>'Helvetica','helveticaB'=>'Helvetica-Bold','helveticaI'=>'Helvetica-Oblique','helveticaBI'=>'Helvetica-BoldOblique',
+		'times'=>'Times-Roman','timesB'=>'Times-Bold','timesI'=>'Times-Italic','timesBI'=>'Times-BoldItalic',
+		'symbol'=>'Symbol','zapfdingbats'=>'ZapfDingbats');
+	//Scale factor
+	if($unit=='pt')
+		$this->k=1;
+	elseif($unit=='mm')
+		$this->k=72/25.4;
+	elseif($unit=='cm')
+		$this->k=72/2.54;
+	elseif($unit=='in')
+		$this->k=72;
+	else
+		$this->Error('Incorrect unit: '.$unit);
+	//Page format
+	if(is_string($format))
+	{
+		$format=strtolower($format);
+		if($format=='a3')
+			$format=array(841.89,1190.55);
+		elseif($format=='a4')
+			$format=array(595.28,841.89);
+		elseif($format=='a5')
+			$format=array(420.94,595.28);
+		elseif($format=='letter')
+			$format=array(612,792);
+		elseif($format=='legal')
+			$format=array(612,1008);
+		else
+			$this->Error('Unknown page format: '.$format);
+		$this->fwPt=$format[0];
+		$this->fhPt=$format[1];
+	}
+	else
+	{
+		$this->fwPt=$format[0]*$this->k;
+		$this->fhPt=$format[1]*$this->k;
+	}
+	$this->fw=$this->fwPt/$this->k;
+	$this->fh=$this->fhPt/$this->k;
+	//Page orientation
+	$orientation=strtolower($orientation);
+	if($orientation=='p' || $orientation=='portrait')
+	{
+		$this->DefOrientation='P';
+		$this->wPt=$this->fwPt;
+		$this->hPt=$this->fhPt;
+	}
+	elseif($orientation=='l' || $orientation=='landscape')
+	{
+		$this->DefOrientation='L';
+		$this->wPt=$this->fhPt;
+		$this->hPt=$this->fwPt;
+	}
+	else
+		$this->Error('Incorrect orientation: '.$orientation);
+	$this->CurOrientation=$this->DefOrientation;
+	$this->w=$this->wPt/$this->k;
+	$this->h=$this->hPt/$this->k;
+	//Page margins (1 cm)
+	$margin=28.35/$this->k;
+	$this->SetMargins($margin,$margin);
+	//Interior cell margin (1 mm)
+	$this->cMargin=$margin/10;
+	//Line width (0.2 mm)
+	$this->LineWidth=.567/$this->k;
+	//Automatic page break
+	$this->SetAutoPageBreak(true,2*$margin);
+	//Full width display mode
+	$this->SetDisplayMode('fullwidth');
+	//Enable compression
+	$this->SetCompression(true);
+	//Set default PDF version number
+	$this->PDFVersion='1.3';
+}
+
+function SetMargins($left,$top,$right=-1)
+{
+	//Set left, top and right margins
+	$this->lMargin=$left;
+	$this->tMargin=$top;
+	if($right==-1)
+		$right=$left;
+	$this->rMargin=$right;
+}
+
+function SetLeftMargin($margin)
+{
+	//Set left margin
+	$this->lMargin=$margin;
+	if($this->page>0 && $this->x<$margin)
+		$this->x=$margin;
+}
+
+function SetTopMargin($margin)
+{
+	//Set top margin
+	$this->tMargin=$margin;
+}
+
+function SetRightMargin($margin)
+{
+	//Set right margin
+	$this->rMargin=$margin;
+}
+
+function SetAutoPageBreak($auto,$margin=0)
+{
+	//Set auto page break mode and triggering margin
+	$this->AutoPageBreak=$auto;
+	$this->bMargin=$margin;
+	$this->PageBreakTrigger=$this->h-$margin;
+}
+
+function SetDisplayMode($zoom,$layout='continuous')
+{
+	//Set display mode in viewer
+	if($zoom=='fullpage' || $zoom=='fullwidth' || $zoom=='real' || $zoom=='default' || !is_string($zoom))
+		$this->ZoomMode=$zoom;
+	else
+		$this->Error('Incorrect zoom display mode: '.$zoom);
+	if($layout=='single' || $layout=='continuous' || $layout=='two' || $layout=='default')
+		$this->LayoutMode=$layout;
+	else
+		$this->Error('Incorrect layout display mode: '.$layout);
+}
+
+function SetCompression($compress)
+{
+	//Set page compression
+	if(function_exists('gzcompress'))
+		$this->compress=$compress;
+	else
+		$this->compress=false;
+}
+
+function SetTitle($title)
+{
+	//Title of document
+	$this->title=$title;
+}
+
+function SetSubject($subject)
+{
+	//Subject of document
+	$this->subject=$subject;
+}
+
+function SetAuthor($author)
+{
+	//Author of document
+	$this->author=$author;
+}
+
+function SetKeywords($keywords)
+{
+	//Keywords of document
+	$this->keywords=$keywords;
+}
+
+function SetCreator($creator)
+{
+	//Creator of document
+	$this->creator=$creator;
+}
+
+function AliasNbPages($alias='{nb}')
+{
+	//Define an alias for total number of pages
+	$this->AliasNbPages=$alias;
+}
+
+function Error($msg)
+{
+	//Fatal error
+	die('<B>FPDF error: </B>'.$msg);
+}
+
+function Open()
+{
+	//Begin document
+	$this->state=1;
+}
+
+function Close()
+{
+	//Terminate document
+	if($this->state==3)
+		return;
+	if($this->page==0)
+		$this->AddPage();
+	//Page footer
+	$this->InFooter=true;
+	$this->Footer();
+	$this->InFooter=false;
+	//Close page
+	$this->_endpage();
+	//Close document
+	$this->_enddoc();
+}
+
+function AddPage($orientation='')
+{
+	//Start a new page
+	if($this->state==0)
+		$this->Open();
+	$family=$this->FontFamily;
+	$style=$this->FontStyle.($this->underline ? 'U' : '');
+	$size=$this->FontSizePt;
+	$lw=$this->LineWidth;
+	$dc=$this->DrawColor;
+	$fc=$this->FillColor;
+	$tc=$this->TextColor;
+	$cf=$this->ColorFlag;
+	if($this->page>0)
+	{
+		//Page footer
+		$this->InFooter=true;
+		$this->Footer();
+		$this->InFooter=false;
+		//Close page
+		$this->_endpage();
+	}
+	//Start new page
+	$this->_beginpage($orientation);
+	//Set line cap style to square
+	$this->_out('2 J');
+	//Set line width
+	$this->LineWidth=$lw;
+	$this->_out(sprintf('%.2f w',$lw*$this->k));
+	//Set font
+	if($family)
+		$this->SetFont($family,$style,$size);
+	//Set colors
+	$this->DrawColor=$dc;
+	if($dc!='0 G')
+		$this->_out($dc);
+	$this->FillColor=$fc;
+	if($fc!='0 g')
+		$this->_out($fc);
+	$this->TextColor=$tc;
+	$this->ColorFlag=$cf;
+	//Page header
+	$this->Header();
+	//Restore line width
+	if($this->LineWidth!=$lw)
+	{
+		$this->LineWidth=$lw;
+		$this->_out(sprintf('%.2f w',$lw*$this->k));
+	}
+	//Restore font
+	if($family)
+		$this->SetFont($family,$style,$size);
+	//Restore colors
+	if($this->DrawColor!=$dc)
+	{
+		$this->DrawColor=$dc;
+		$this->_out($dc);
+	}
+	if($this->FillColor!=$fc)
+	{
+		$this->FillColor=$fc;
+		$this->_out($fc);
+	}
+	$this->TextColor=$tc;
+	$this->ColorFlag=$cf;
+}
+
+function Header()
+{
+	//To be implemented in your own inherited class
+}
+
+function Footer()
+{
+	//To be implemented in your own inherited class
+}
+
+function PageNo()
+{
+	//Get current page number
+	return $this->page;
+}
+
+function SetDrawColor($r,$g=-1,$b=-1)
+{
+	//Set color for all stroking operations
+	if(($r==0 && $g==0 && $b==0) || $g==-1)
+		$this->DrawColor=sprintf('%.3f G',$r/255);
+	else
+		$this->DrawColor=sprintf('%.3f %.3f %.3f RG',$r/255,$g/255,$b/255);
+	if($this->page>0)
+		$this->_out($this->DrawColor);
+}
+
+function SetFillColor($r,$g=-1,$b=-1)
+{
+	//Set color for all filling operations
+	if(($r==0 && $g==0 && $b==0) || $g==-1)
+		$this->FillColor=sprintf('%.3f g',$r/255);
+	else
+		$this->FillColor=sprintf('%.3f %.3f %.3f rg',$r/255,$g/255,$b/255);
+	$this->ColorFlag=($this->FillColor!=$this->TextColor);
+	if($this->page>0)
+		$this->_out($this->FillColor);
+}
+
+function SetTextColor($r,$g=-1,$b=-1)
+{
+	//Set color for text
+	if(($r==0 && $g==0 && $b==0) || $g==-1)
+		$this->TextColor=sprintf('%.3f g',$r/255);
+	else
+		$this->TextColor=sprintf('%.3f %.3f %.3f rg',$r/255,$g/255,$b/255);
+	$this->ColorFlag=($this->FillColor!=$this->TextColor);
+}
+
+function GetStringWidth($s)
+{
+	//Get width of a string in the current font
+	$s=(string)$s;
+	$cw=&$this->CurrentFont['cw'];
+	$w=0;
+	$l=strlen($s);
+	for($i=0;$i<$l;$i++)
+		$w+=$cw[$s{$i}];
+	return $w*$this->FontSize/1000;
+}
+
+function SetLineWidth($width)
+{
+	//Set line width
+	$this->LineWidth=$width;
+	if($this->page>0)
+		$this->_out(sprintf('%.2f w',$width*$this->k));
+}
+
+function Line($x1,$y1,$x2,$y2)
+{
+	//Draw a line
+	$this->_out(sprintf('%.2f %.2f m %.2f %.2f l S',$x1*$this->k,($this->h-$y1)*$this->k,$x2*$this->k,($this->h-$y2)*$this->k));
+}
+
+function Rect($x,$y,$w,$h,$style='')
+{
+	//Draw a rectangle
+	if($style=='F')
+		$op='f';
+	elseif($style=='FD' || $style=='DF')
+		$op='B';
+	else
+		$op='S';
+	$this->_out(sprintf('%.2f %.2f %.2f %.2f re %s',$x*$this->k,($this->h-$y)*$this->k,$w*$this->k,-$h*$this->k,$op));
+}
+
+function AddFont($family,$style='',$file='')
+{
+	//Add a TrueType or Type1 font
+	$family=strtolower($family);
+	if($file=='')
+		$file=str_replace(' ','',$family).strtolower($style).'.php';
+	if($family=='arial')
+		$family='helvetica';
+	$style=strtoupper($style);
+	if($style=='IB')
+		$style='BI';
+	$fontkey=$family.$style;
+	if(isset($this->fonts[$fontkey]))
+		$this->Error('Font already added: '.$family.' '.$style);
+	include($this->_getfontpath().$file);
+	if(!isset($name))
+		$this->Error('Could not include font definition file');
+	$i=count($this->fonts)+1;
+	$this->fonts[$fontkey]=array('i'=>$i,'type'=>$type,'name'=>$name,'desc'=>$desc,'up'=>$up,'ut'=>$ut,'cw'=>$cw,'enc'=>$enc,'file'=>$file);
+	if($diff)
+	{
+		//Search existing encodings
+		$d=0;
+		$nb=count($this->diffs);
+		for($i=1;$i<=$nb;$i++)
+		{
+			if($this->diffs[$i]==$diff)
+			{
+				$d=$i;
+				break;
+			}
+		}
+		if($d==0)
+		{
+			$d=$nb+1;
+			$this->diffs[$d]=$diff;
+		}
+		$this->fonts[$fontkey]['diff']=$d;
+	}
+	if($file)
+	{
+		if($type=='TrueType')
+			$this->FontFiles[$file]=array('length1'=>$originalsize);
+		else
+			$this->FontFiles[$file]=array('length1'=>$size1,'length2'=>$size2);
+	}
+}
+
+function SetFont($family,$style='',$size=0)
+{
+	//Select a font; size given in points
+	global $fpdf_charwidths;
+
+	$family=strtolower($family);
+	if($family=='')
+		$family=$this->FontFamily;
+	if($family=='arial')
+		$family='helvetica';
+	elseif($family=='symbol' || $family=='zapfdingbats')
+		$style='';
+	$style=strtoupper($style);
+	if(strpos($style,'U')!==false)
+	{
+		$this->underline=true;
+		$style=str_replace('U','',$style);
+	}
+	else
+		$this->underline=false;
+	if($style=='IB')
+		$style='BI';
+	if($size==0)
+		$size=$this->FontSizePt;
+	//Test if font is already selected
+	if($this->FontFamily==$family && $this->FontStyle==$style && $this->FontSizePt==$size)
+		return;
+	//Test if used for the first time
+	$fontkey=$family.$style;
+	if(!isset($this->fonts[$fontkey]))
+	{
+		//Check if one of the standard fonts
+		if(isset($this->CoreFonts[$fontkey]))
+		{
+			if(!isset($fpdf_charwidths[$fontkey]))
+			{
+				//Load metric file
+				$file=$family;
+				if($family=='times' || $family=='helvetica')
+					$file.=strtolower($style);
+				include($this->_getfontpath().$file.'.php');
+				if(!isset($fpdf_charwidths[$fontkey]))
+					$this->Error('Could not include font metric file');
+			}
+			$i=count($this->fonts)+1;
+			$this->fonts[$fontkey]=array('i'=>$i,'type'=>'core','name'=>$this->CoreFonts[$fontkey],'up'=>-100,'ut'=>50,'cw'=>$fpdf_charwidths[$fontkey]);
+		}
+		else
+			$this->Error('Undefined font: '.$family.' '.$style);
+	}
+	//Select it
+	$this->FontFamily=$family;
+	$this->FontStyle=$style;
+	$this->FontSizePt=$size;
+	$this->FontSize=$size/$this->k;
+	$this->CurrentFont=&$this->fonts[$fontkey];
+	if($this->page>0)
+		$this->_out(sprintf('BT /F%d %.2f Tf ET',$this->CurrentFont['i'],$this->FontSizePt));
+}
+
+function SetFontSize($size)
+{
+	//Set font size in points
+	if($this->FontSizePt==$size)
+		return;
+	$this->FontSizePt=$size;
+	$this->FontSize=$size/$this->k;
+	if($this->page>0)
+		$this->_out(sprintf('BT /F%d %.2f Tf ET',$this->CurrentFont['i'],$this->FontSizePt));
+}
+
+function AddLink()
+{
+	//Create a new internal link
+	$n=count($this->links)+1;
+	$this->links[$n]=array(0,0);
+	return $n;
+}
+
+function SetLink($link,$y=0,$page=-1)
+{
+	//Set destination of internal link
+	if($y==-1)
+		$y=$this->y;
+	if($page==-1)
+		$page=$this->page;
+	$this->links[$link]=array($page,$y);
+}
+
+function Link($x,$y,$w,$h,$link)
+{
+	//Put a link on the page
+	$this->PageLinks[$this->page][]=array($x*$this->k,$this->hPt-$y*$this->k,$w*$this->k,$h*$this->k,$link);
+}
+
+function Text($x,$y,$txt)
+{
+	//Output a string
+	$s=sprintf('BT %.2f %.2f Td (%s) Tj ET',$x*$this->k,($this->h-$y)*$this->k,$this->_escape($txt));
+	if($this->underline && $txt!='')
+		$s.=' '.$this->_dounderline($x,$y,$txt);
+	if($this->ColorFlag)
+		$s='q '.$this->TextColor.' '.$s.' Q';
+	$this->_out($s);
+}
+
+function AcceptPageBreak()
+{
+	//Accept automatic page break or not
+	return $this->AutoPageBreak;
+}
+
+function Cell($w,$h=0,$txt='',$border=0,$ln=0,$align='',$fill=0,$link='')
+{
+	//Output a cell
+	$k=$this->k;
+	if($this->y+$h>$this->PageBreakTrigger && !$this->InFooter && $this->AcceptPageBreak())
+	{
+		//Automatic page break
+		$x=$this->x;
+		$ws=$this->ws;
+		if($ws>0)
+		{
+			$this->ws=0;
+			$this->_out('0 Tw');
+		}
+		$this->AddPage($this->CurOrientation);
+		$this->x=$x;
+		if($ws>0)
+		{
+			$this->ws=$ws;
+			$this->_out(sprintf('%.3f Tw',$ws*$k));
+		}
+	}
+	if($w==0)
+		$w=$this->w-$this->rMargin-$this->x;
+	$s='';
+	if($fill==1 || $border==1)
+	{
+		if($fill==1)
+			$op=($border==1) ? 'B' : 'f';
+		else
+			$op='S';
+		$s=sprintf('%.2f %.2f %.2f %.2f re %s ',$this->x*$k,($this->h-$this->y)*$k,$w*$k,-$h*$k,$op);
+	}
+	if(is_string($border))
+	{
+		$x=$this->x;
+		$y=$this->y;
+		if(strpos($border,'L')!==false)
+			$s.=sprintf('%.2f %.2f m %.2f %.2f l S ',$x*$k,($this->h-$y)*$k,$x*$k,($this->h-($y+$h))*$k);
+		if(strpos($border,'T')!==false)
+			$s.=sprintf('%.2f %.2f m %.2f %.2f l S ',$x*$k,($this->h-$y)*$k,($x+$w)*$k,($this->h-$y)*$k);
+		if(strpos($border,'R')!==false)
+			$s.=sprintf('%.2f %.2f m %.2f %.2f l S ',($x+$w)*$k,($this->h-$y)*$k,($x+$w)*$k,($this->h-($y+$h))*$k);
+		if(strpos($border,'B')!==false)
+			$s.=sprintf('%.2f %.2f m %.2f %.2f l S ',$x*$k,($this->h-($y+$h))*$k,($x+$w)*$k,($this->h-($y+$h))*$k);
+	}
+	if($txt!=='')
+	{
+		if($align=='R')
+			$dx=$w-$this->cMargin-$this->GetStringWidth($txt);
+		elseif($align=='C')
+			$dx=($w-$this->GetStringWidth($txt))/2;
+		else
+			$dx=$this->cMargin;
+		if($this->ColorFlag)
+			$s.='q '.$this->TextColor.' ';
+		$txt2=str_replace(')','\\)',str_replace('(','\\(',str_replace('\\','\\\\',$txt)));
+		$s.=sprintf('BT %.2f %.2f Td (%s) Tj ET',($this->x+$dx)*$k,($this->h-($this->y+.5*$h+.3*$this->FontSize))*$k,$txt2);
+		if($this->underline)
+			$s.=' '.$this->_dounderline($this->x+$dx,$this->y+.5*$h+.3*$this->FontSize,$txt);
+		if($this->ColorFlag)
+			$s.=' Q';
+		if($link)
+			$this->Link($this->x+$dx,$this->y+.5*$h-.5*$this->FontSize,$this->GetStringWidth($txt),$this->FontSize,$link);
+	}
+	if($s)
+		$this->_out($s);
+	$this->lasth=$h;
+	if($ln>0)
+	{
+		//Go to next line
+		$this->y+=$h;
+		if($ln==1)
+			$this->x=$this->lMargin;
+	}
+	else
+		$this->x+=$w;
+}
+
+function MultiCell($w,$h,$txt,$border=0,$align='J',$fill=0)
+{
+	//Output text with automatic or explicit line breaks
+	$cw=&$this->CurrentFont['cw'];
+	if($w==0)
+		$w=$this->w-$this->rMargin-$this->x;
+	$wmax=($w-2*$this->cMargin)*1000/$this->FontSize;
+	$s=str_replace("\r",'',$txt);
+	$nb=strlen($s);
+	if($nb>0 && $s[$nb-1]=="\n")
+		$nb--;
+	$b=0;
+	if($border)
+	{
+		if($border==1)
+		{
+			$border='LTRB';
+			$b='LRT';
+			$b2='LR';
+		}
+		else
+		{
+			$b2='';
+			if(strpos($border,'L')!==false)
+				$b2.='L';
+			if(strpos($border,'R')!==false)
+				$b2.='R';
+			$b=(strpos($border,'T')!==false) ? $b2.'T' : $b2;
+		}
+	}
+	$sep=-1;
+	$i=0;
+	$j=0;
+	$l=0;
+	$ns=0;
+	$nl=1;
+	while($i<$nb)
+	{
+		//Get next character
+		$c=$s{$i};
+		if($c=="\n")
+		{
+			//Explicit line break
+			if($this->ws>0)
+			{
+				$this->ws=0;
+				$this->_out('0 Tw');
+			}
+			$this->Cell($w,$h,substr($s,$j,$i-$j),$b,2,$align,$fill);
+			$i++;
+			$sep=-1;
+			$j=$i;
+			$l=0;
+			$ns=0;
+			$nl++;
+			if($border && $nl==2)
+				$b=$b2;
+			continue;
+		}
+		if($c==' ')
+		{
+			$sep=$i;
+			$ls=$l;
+			$ns++;
+		}
+		$l+=$cw[$c];
+		if($l>$wmax)
+		{
+			//Automatic line break
+			if($sep==-1)
+			{
+				if($i==$j)
+					$i++;
+				if($this->ws>0)
+				{
+					$this->ws=0;
+					$this->_out('0 Tw');
+				}
+				$this->Cell($w,$h,substr($s,$j,$i-$j),$b,2,$align,$fill);
+			}
+			else
+			{
+				if($align=='J')
+				{
+					$this->ws=($ns>1) ? ($wmax-$ls)/1000*$this->FontSize/($ns-1) : 0;
+					$this->_out(sprintf('%.3f Tw',$this->ws*$this->k));
+				}
+				$this->Cell($w,$h,substr($s,$j,$sep-$j),$b,2,$align,$fill);
+				$i=$sep+1;
+			}
+			$sep=-1;
+			$j=$i;
+			$l=0;
+			$ns=0;
+			$nl++;
+			if($border && $nl==2)
+				$b=$b2;
+		}
+		else
+			$i++;
+	}
+	//Last chunk
+	if($this->ws>0)
+	{
+		$this->ws=0;
+		$this->_out('0 Tw');
+	}
+	if($border && strpos($border,'B')!==false)
+		$b.='B';
+	$this->Cell($w,$h,substr($s,$j,$i-$j),$b,2,$align,$fill);
+	$this->x=$this->lMargin;
+}
+
+function Write($h,$txt,$link='')
+{
+	//Output text in flowing mode
+	$cw=&$this->CurrentFont['cw'];
+	$w=$this->w-$this->rMargin-$this->x;
+	$wmax=($w-2*$this->cMargin)*1000/$this->FontSize;
+	$s=str_replace("\r",'',$txt);
+	$nb=strlen($s);
+	$sep=-1;
+	$i=0;
+	$j=0;
+	$l=0;
+	$nl=1;
+	while($i<$nb)
+	{
+		//Get next character
+		$c=$s{$i};
+		if($c=="\n")
+		{
+			//Explicit line break
+			$this->Cell($w,$h,substr($s,$j,$i-$j),0,2,'',0,$link);
+			$i++;
+			$sep=-1;
+			$j=$i;
+			$l=0;
+			if($nl==1)
+			{
+				$this->x=$this->lMargin;
+				$w=$this->w-$this->rMargin-$this->x;
+				$wmax=($w-2*$this->cMargin)*1000/$this->FontSize;
+			}
+			$nl++;
+			continue;
+		}
+		if($c==' ')
+			$sep=$i;
+		$l+=$cw[$c];
+		if($l>$wmax)
+		{
+			//Automatic line break
+			if($sep==-1)
+			{
+				if($this->x>$this->lMargin)
+				{
+					//Move to next line
+					$this->x=$this->lMargin;
+					$this->y+=$h;
+					$w=$this->w-$this->rMargin-$this->x;
+					$wmax=($w-2*$this->cMargin)*1000/$this->FontSize;
+					$i++;
+					$nl++;
+					continue;
+				}
+				if($i==$j)
+					$i++;
+				$this->Cell($w,$h,substr($s,$j,$i-$j),0,2,'',0,$link);
+			}
+			else
+			{
+				$this->Cell($w,$h,substr($s,$j,$sep-$j),0,2,'',0,$link);
+				$i=$sep+1;
+			}
+			$sep=-1;
+			$j=$i;
+			$l=0;
+			if($nl==1)
+			{
+				$this->x=$this->lMargin;
+				$w=$this->w-$this->rMargin-$this->x;
+				$wmax=($w-2*$this->cMargin)*1000/$this->FontSize;
+			}
+			$nl++;
+		}
+		else
+			$i++;
+	}
+	//Last chunk
+	if($i!=$j)
+		$this->Cell($l/1000*$this->FontSize,$h,substr($s,$j),0,0,'',0,$link);
+}
+
+function Image($file,$x,$y,$w=0,$h=0,$type='',$link='')
+{
+	//Put an image on the page
+	if(!isset($this->images[$file]))
+	{
+		//First use of image, get info
+		if($type=='')
+		{
+			$pos=strrpos($file,'.');
+			if(!$pos)
+				$this->Error('Image file has no extension and no type was specified: '.$file);
+			$type=substr($file,$pos+1);
+		}
+		$type=strtolower($type);
+		$mqr=get_magic_quotes_runtime();
+		set_magic_quotes_runtime(0);
+		if($type=='jpg' || $type=='jpeg')
+			$info=$this->_parsejpg($file);
+		elseif($type=='png')
+			$info=$this->_parsepng($file);
+		else
+		{
+			//Allow for additional formats
+			$mtd='_parse'.$type;
+			if(!method_exists($this,$mtd))
+				$this->Error('Unsupported image type: '.$type);
+			$info=$this->$mtd($file);
+		}
+		set_magic_quotes_runtime($mqr);
+		$info['i']=count($this->images)+1;
+		$this->images[$file]=$info;
+	}
+	else
+		$info=$this->images[$file];
+	//Automatic width and height calculation if needed
+	if($w==0 && $h==0)
+	{
+		//Put image at 72 dpi
+		$w=$info['w']/$this->k;
+		$h=$info['h']/$this->k;
+	}
+	if($w==0)
+		$w=$h*$info['w']/$info['h'];
+	if($h==0)
+		$h=$w*$info['h']/$info['w'];
+	$this->_out(sprintf('q %.2f 0 0 %.2f %.2f %.2f cm /I%d Do Q',$w*$this->k,$h*$this->k,$x*$this->k,($this->h-($y+$h))*$this->k,$info['i']));
+	if($link)
+		$this->Link($x,$y,$w,$h,$link);
+}
+
+function Ln($h='')
+{
+	//Line feed; default value is last cell height
+	$this->x=$this->lMargin;
+	if(is_string($h))
+		$this->y+=$this->lasth;
+	else
+		$this->y+=$h;
+}
+
+function GetX()
+{
+	//Get x position
+	return $this->x;
+}
+
+function SetX($x)
+{
+	//Set x position
+	if($x>=0)
+		$this->x=$x;
+	else
+		$this->x=$this->w+$x;
+}
+
+function GetY()
+{
+	//Get y position
+	return $this->y;
+}
+
+function SetY($y)
+{
+	//Set y position and reset x
+	$this->x=$this->lMargin;
+	if($y>=0)
+		$this->y=$y;
+	else
+		$this->y=$this->h+$y;
+}
+
+function SetXY($x,$y)
+{
+	//Set x and y positions
+	$this->SetY($y);
+	$this->SetX($x);
+}
+
+function Output($name='',$dest='')
+{
+	//Output PDF to some destination
+	//Finish document if necessary
+	if($this->state<3)
+		$this->Close();
+	//Normalize parameters
+	if(is_bool($dest))
+		$dest=$dest ? 'D' : 'F';
+	$dest=strtoupper($dest);
+	if($dest=='')
+	{
+		if($name=='')
+		{
+			$name='doc.pdf';
+			$dest='I';
+		}
+		else
+			$dest='F';
+	}
+	switch($dest)
+	{
+		case 'I':
+			//Send to standard output
+			if(ob_get_contents())
+				$this->Error('Some data has already been output, can\'t send PDF file');
+			if(php_sapi_name()!='cli')
+			{
+				//We send to a browser
+				header('Content-Type: application/pdf');
+				if(headers_sent())
+					$this->Error('Some data has already been output to browser, can\'t send PDF file');
+				header('Content-Length: '.strlen($this->buffer));
+				header('Content-disposition: inline; filename="'.$name.'"');
+			}
+			echo $this->buffer;
+			break;
+		case 'D':
+			//Download file
+			if(ob_get_contents())
+				$this->Error('Some data has already been output, can\'t send PDF file');
+			if(isset($_SERVER['HTTP_USER_AGENT']) && strpos($_SERVER['HTTP_USER_AGENT'],'MSIE'))
+				header('Content-Type: application/force-download');
+			else
+				header('Content-Type: application/octet-stream');
+			if(headers_sent())
+				$this->Error('Some data has already been output to browser, can\'t send PDF file');
+			header('Content-Length: '.strlen($this->buffer));
+			header('Content-disposition: attachment; filename="'.$name.'"');
+			echo $this->buffer;
+			break;
+		case 'F':
+			//Save to local file
+			$f=fopen($name,'wb');
+			if(!$f)
+				$this->Error('Unable to create output file: '.$name);
+			fwrite($f,$this->buffer,strlen($this->buffer));
+			fclose($f);
+			break;
+		case 'S':
+			//Return as a string
+			return $this->buffer;
+		default:
+			$this->Error('Incorrect output destination: '.$dest);
+	}
+	return '';
+}
+
+/*******************************************************************************
+*                                                                              *
+*                              Protected methods                               *
+*                                                                              *
+*******************************************************************************/
+function _dochecks()
+{
+	//Check for locale-related bug
+	if(1.1==1)
+		$this->Error('Don\'t alter the locale before including class file');
+	//Check for decimal separator
+	if(sprintf('%.1f',1.0)!='1.0')
+		setlocale(LC_NUMERIC,'C');
+}
+
+function _getfontpath()
+{
+	if(!defined('FPDF_FONTPATH') && is_dir(dirname(__FILE__).'/font'))
+		define('FPDF_FONTPATH',dirname(__FILE__).'/font/');
+	return defined('FPDF_FONTPATH') ? FPDF_FONTPATH : '';
+}
+
+function _putpages()
+{
+	$nb=$this->page;
+	if(!empty($this->AliasNbPages))
+	{
+		//Replace number of pages
+		for($n=1;$n<=$nb;$n++)
+			$this->pages[$n]=str_replace($this->AliasNbPages,$nb,$this->pages[$n]);
+	}
+	if($this->DefOrientation=='P')
+	{
+		$wPt=$this->fwPt;
+		$hPt=$this->fhPt;
+	}
+	else
+	{
+		$wPt=$this->fhPt;
+		$hPt=$this->fwPt;
+	}
+	$filter=($this->compress) ? '/Filter /FlateDecode ' : '';
+	for($n=1;$n<=$nb;$n++)
+	{
+		//Page
+		$this->_newobj();
+		$this->_out('<</Type /Page');
+		$this->_out('/Parent 1 0 R');
+		if(isset($this->OrientationChanges[$n]))
+			$this->_out(sprintf('/MediaBox [0 0 %.2f %.2f]',$hPt,$wPt));
+		$this->_out('/Resources 2 0 R');
+		if(isset($this->PageLinks[$n]))
+		{
+			//Links
+			$annots='/Annots [';
+			foreach($this->PageLinks[$n] as $pl)
+			{
+				$rect=sprintf('%.2f %.2f %.2f %.2f',$pl[0],$pl[1],$pl[0]+$pl[2],$pl[1]-$pl[3]);
+				$annots.='<</Type /Annot /Subtype /Link /Rect ['.$rect.'] /Border [0 0 0] ';
+				if(is_string($pl[4]))
+					$annots.='/A <</S /URI /URI '.$this->_textstring($pl[4]).'>>>>';
+				else
+				{
+					$l=$this->links[$pl[4]];
+					$h=isset($this->OrientationChanges[$l[0]]) ? $wPt : $hPt;
+					$annots.=sprintf('/Dest [%d 0 R /XYZ 0 %.2f null]>>',1+2*$l[0],$h-$l[1]*$this->k);
+				}
+			}
+			$this->_out($annots.']');
+		}
+		$this->_out('/Contents '.($this->n+1).' 0 R>>');
+		$this->_out('endobj');
+		//Page content
+		$p=($this->compress) ? gzcompress($this->pages[$n]) : $this->pages[$n];
+		$this->_newobj();
+		$this->_out('<<'.$filter.'/Length '.strlen($p).'>>');
+		$this->_putstream($p);
+		$this->_out('endobj');
+	}
+	//Pages root
+	$this->offsets[1]=strlen($this->buffer);
+	$this->_out('1 0 obj');
+	$this->_out('<</Type /Pages');
+	$kids='/Kids [';
+	for($i=0;$i<$nb;$i++)
+		$kids.=(3+2*$i).' 0 R ';
+	$this->_out($kids.']');
+	$this->_out('/Count '.$nb);
+	$this->_out(sprintf('/MediaBox [0 0 %.2f %.2f]',$wPt,$hPt));
+	$this->_out('>>');
+	$this->_out('endobj');
+}
+
+function _putfonts()
+{
+	$nf=$this->n;
+	foreach($this->diffs as $diff)
+	{
+		//Encodings
+		$this->_newobj();
+		$this->_out('<</Type /Encoding /BaseEncoding /WinAnsiEncoding /Differences ['.$diff.']>>');
+		$this->_out('endobj');
+	}
+	$mqr=get_magic_quotes_runtime();
+	set_magic_quotes_runtime(0);
+	foreach($this->FontFiles as $file=>$info)
+	{
+		//Font file embedding
+		$this->_newobj();
+		$this->FontFiles[$file]['n']=$this->n;
+		$font='';
+		$f=fopen($this->_getfontpath().$file,'rb',1);
+		if(!$f)
+			$this->Error('Font file not found');
+		while(!feof($f))
+			$font.=fread($f,8192);
+		fclose($f);
+		$compressed=(substr($file,-2)=='.z');
+		if(!$compressed && isset($info['length2']))
+		{
+			$header=(ord($font{0})==128);
+			if($header)
+			{
+				//Strip first binary header
+				$font=substr($font,6);
+			}
+			if($header && ord($font{$info['length1']})==128)
+			{
+				//Strip second binary header
+				$font=substr($font,0,$info['length1']).substr($font,$info['length1']+6);
+			}
+		}
+		$this->_out('<</Length '.strlen($font));
+		if($compressed)
+			$this->_out('/Filter /FlateDecode');
+		$this->_out('/Length1 '.$info['length1']);
+		if(isset($info['length2']))
+			$this->_out('/Length2 '.$info['length2'].' /Length3 0');
+		$this->_out('>>');
+		$this->_putstream($font);
+		$this->_out('endobj');
+	}
+	set_magic_quotes_runtime($mqr);
+	foreach($this->fonts as $k=>$font)
+	{
+		//Font objects
+		$this->fonts[$k]['n']=$this->n+1;
+		$type=$font['type'];
+		$name=$font['name'];
+		if($type=='core')
+		{
+			//Standard font
+			$this->_newobj();
+			$this->_out('<</Type /Font');
+			$this->_out('/BaseFont /'.$name);
+			$this->_out('/Subtype /Type1');
+			if($name!='Symbol' && $name!='ZapfDingbats')
+				$this->_out('/Encoding /WinAnsiEncoding');
+			$this->_out('>>');
+			$this->_out('endobj');
+		}
+		elseif($type=='Type1' || $type=='TrueType')
+		{
+			//Additional Type1 or TrueType font
+			$this->_newobj();
+			$this->_out('<</Type /Font');
+			$this->_out('/BaseFont /'.$name);
+			$this->_out('/Subtype /'.$type);
+			$this->_out('/FirstChar 32 /LastChar 255');
+			$this->_out('/Widths '.($this->n+1).' 0 R');
+			$this->_out('/FontDescriptor '.($this->n+2).' 0 R');
+			if($font['enc'])
+			{
+				if(isset($font['diff']))
+					$this->_out('/Encoding '.($nf+$font['diff']).' 0 R');
+				else
+					$this->_out('/Encoding /WinAnsiEncoding');
+			}
+			$this->_out('>>');
+			$this->_out('endobj');
+			//Widths
+			$this->_newobj();
+			$cw=&$font['cw'];
+			$s='[';
+			for($i=32;$i<=255;$i++)
+				$s.=$cw[chr($i)].' ';
+			$this->_out($s.']');
+			$this->_out('endobj');
+			//Descriptor
+			$this->_newobj();
+			$s='<</Type /FontDescriptor /FontName /'.$name;
+			foreach($font['desc'] as $k=>$v)
+				$s.=' /'.$k.' '.$v;
+			$file=$font['file'];
+			if($file)
+				$s.=' /FontFile'.($type=='Type1' ? '' : '2').' '.$this->FontFiles[$file]['n'].' 0 R';
+			$this->_out($s.'>>');
+			$this->_out('endobj');
+		}
+		else
+		{
+			//Allow for additional types
+			$mtd='_put'.strtolower($type);
+			if(!method_exists($this,$mtd))
+				$this->Error('Unsupported font type: '.$type);
+			$this->$mtd($font);
+		}
+	}
+}
+
+function _putimages()
+{
+	$filter=($this->compress) ? '/Filter /FlateDecode ' : '';
+	reset($this->images);
+	while(list($file,$info)=each($this->images))
+	{
+		$this->_newobj();
+		$this->images[$file]['n']=$this->n;
+		$this->_out('<</Type /XObject');
+		$this->_out('/Subtype /Image');
+		$this->_out('/Width '.$info['w']);
+		$this->_out('/Height '.$info['h']);
+		if($info['cs']=='Indexed')
+			$this->_out('/ColorSpace [/Indexed /DeviceRGB '.(strlen($info['pal'])/3-1).' '.($this->n+1).' 0 R]');
+		else
+		{
+			$this->_out('/ColorSpace /'.$info['cs']);
+			if($info['cs']=='DeviceCMYK')
+				$this->_out('/Decode [1 0 1 0 1 0 1 0]');
+		}
+		$this->_out('/BitsPerComponent '.$info['bpc']);
+		if(isset($info['f']))
+			$this->_out('/Filter /'.$info['f']);
+		if(isset($info['parms']))
+			$this->_out($info['parms']);
+		if(isset($info['trns']) && is_array($info['trns']))
+		{
+			$trns='';
+			for($i=0;$i<count($info['trns']);$i++)
+				$trns.=$info['trns'][$i].' '.$info['trns'][$i].' ';
+			$this->_out('/Mask ['.$trns.']');
+		}
+		$this->_out('/Length '.strlen($info['data']).'>>');
+		$this->_putstream($info['data']);
+		unset($this->images[$file]['data']);
+		$this->_out('endobj');
+		//Palette
+		if($info['cs']=='Indexed')
+		{
+			$this->_newobj();
+			$pal=($this->compress) ? gzcompress($info['pal']) : $info['pal'];
+			$this->_out('<<'.$filter.'/Length '.strlen($pal).'>>');
+			$this->_putstream($pal);
+			$this->_out('endobj');
+		}
+	}
+}
+
+function _putxobjectdict()
+{
+	foreach($this->images as $image)
+		$this->_out('/I'.$image['i'].' '.$image['n'].' 0 R');
+}
+
+function _putresourcedict()
+{
+	$this->_out('/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]');
+	$this->_out('/Font <<');
+	foreach($this->fonts as $font)
+		$this->_out('/F'.$font['i'].' '.$font['n'].' 0 R');
+	$this->_out('>>');
+	$this->_out('/XObject <<');
+	$this->_putxobjectdict();
+	$this->_out('>>');
+}
+
+function _putresources()
+{
+	$this->_putfonts();
+	$this->_putimages();
+	//Resource dictionary
+	$this->offsets[2]=strlen($this->buffer);
+	$this->_out('2 0 obj');
+	$this->_out('<<');
+	$this->_putresourcedict();
+	$this->_out('>>');
+	$this->_out('endobj');
+}
+
+function _putinfo()
+{
+	$this->_out('/Producer '.$this->_textstring('FPDF '.FPDF_VERSION));
+	if(!empty($this->title))
+		$this->_out('/Title '.$this->_textstring($this->title));
+	if(!empty($this->subject))
+		$this->_out('/Subject '.$this->_textstring($this->subject));
+	if(!empty($this->author))
+		$this->_out('/Author '.$this->_textstring($this->author));
+	if(!empty($this->keywords))
+		$this->_out('/Keywords '.$this->_textstring($this->keywords));
+	if(!empty($this->creator))
+		$this->_out('/Creator '.$this->_textstring($this->creator));
+	$this->_out('/CreationDate '.$this->_textstring('D:'.date('YmdHis')));
+}
+
+function _putcatalog()
+{
+	$this->_out('/Type /Catalog');
+	$this->_out('/Pages 1 0 R');
+	if($this->ZoomMode=='fullpage')
+		$this->_out('/OpenAction [3 0 R /Fit]');
+	elseif($this->ZoomMode=='fullwidth')
+		$this->_out('/OpenAction [3 0 R /FitH null]');
+	elseif($this->ZoomMode=='real')
+		$this->_out('/OpenAction [3 0 R /XYZ null null 1]');
+	elseif(!is_string($this->ZoomMode))
+		$this->_out('/OpenAction [3 0 R /XYZ null null '.($this->ZoomMode/100).']');
+	if($this->LayoutMode=='single')
+		$this->_out('/PageLayout /SinglePage');
+	elseif($this->LayoutMode=='continuous')
+		$this->_out('/PageLayout /OneColumn');
+	elseif($this->LayoutMode=='two')
+		$this->_out('/PageLayout /TwoColumnLeft');
+}
+
+function _putheader()
+{
+	$this->_out('%PDF-'.$this->PDFVersion);
+}
+
+function _puttrailer()
+{
+	$this->_out('/Size '.($this->n+1));
+	$this->_out('/Root '.$this->n.' 0 R');
+	$this->_out('/Info '.($this->n-1).' 0 R');
+}
+
+function _enddoc()
+{
+	$this->_putheader();
+	$this->_putpages();
+	$this->_putresources();
+	//Info
+	$this->_newobj();
+	$this->_out('<<');
+	$this->_putinfo();
+	$this->_out('>>');
+	$this->_out('endobj');
+	//Catalog
+	$this->_newobj();
+	$this->_out('<<');
+	$this->_putcatalog();
+	$this->_out('>>');
+	$this->_out('endobj');
+	//Cross-ref
+	$o=strlen($this->buffer);
+	$this->_out('xref');
+	$this->_out('0 '.($this->n+1));
+	$this->_out('0000000000 65535 f ');
+	for($i=1;$i<=$this->n;$i++)
+		$this->_out(sprintf('%010d 00000 n ',$this->offsets[$i]));
+	//Trailer
+	$this->_out('trailer');
+	$this->_out('<<');
+	$this->_puttrailer();
+	$this->_out('>>');
+	$this->_out('startxref');
+	$this->_out($o);
+	$this->_out('%%EOF');
+	$this->state=3;
+}
+
+function _beginpage($orientation)
+{
+	$this->page++;
+	$this->pages[$this->page]='';
+	$this->state=2;
+	$this->x=$this->lMargin;
+	$this->y=$this->tMargin;
+	$this->FontFamily='';
+	//Page orientation
+	if(!$orientation)
+		$orientation=$this->DefOrientation;
+	else
+	{
+		$orientation=strtoupper($orientation{0});
+		if($orientation!=$this->DefOrientation)
+			$this->OrientationChanges[$this->page]=true;
+	}
+	if($orientation!=$this->CurOrientation)
+	{
+		//Change orientation
+		if($orientation=='P')
+		{
+			$this->wPt=$this->fwPt;
+			$this->hPt=$this->fhPt;
+			$this->w=$this->fw;
+			$this->h=$this->fh;
+		}
+		else
+		{
+			$this->wPt=$this->fhPt;
+			$this->hPt=$this->fwPt;
+			$this->w=$this->fh;
+			$this->h=$this->fw;
+		}
+		$this->PageBreakTrigger=$this->h-$this->bMargin;
+		$this->CurOrientation=$orientation;
+	}
+}
+
+function _endpage()
+{
+	//End of page contents
+	$this->state=1;
+}
+
+function _newobj()
+{
+	//Begin a new object
+	$this->n++;
+	$this->offsets[$this->n]=strlen($this->buffer);
+	$this->_out($this->n.' 0 obj');
+}
+
+function _dounderline($x,$y,$txt)
+{
+	//Underline text
+	$up=$this->CurrentFont['up'];
+	$ut=$this->CurrentFont['ut'];
+	$w=$this->GetStringWidth($txt)+$this->ws*substr_count($txt,' ');
+	return sprintf('%.2f %.2f %.2f %.2f re f',$x*$this->k,($this->h-($y-$up/1000*$this->FontSize))*$this->k,$w*$this->k,-$ut/1000*$this->FontSizePt);
+}
+
+function _parsejpg($file)
+{
+	//Extract info from a JPEG file
+	$a=GetImageSize($file);
+	if(!$a)
+		$this->Error('Missing or incorrect image file: '.$file);
+	if($a[2]!=2)
+		$this->Error('Not a JPEG file: '.$file);
+	if(!isset($a['channels']) || $a['channels']==3)
+		$colspace='DeviceRGB';
+	elseif($a['channels']==4)
+		$colspace='DeviceCMYK';
+	else
+		$colspace='DeviceGray';
+	$bpc=isset($a['bits']) ? $a['bits'] : 8;
+	//Read whole file
+	$f=fopen($file,'rb');
+	$data='';
+	while(!feof($f))
+		$data.=fread($f,4096);
+	fclose($f);
+	return array('w'=>$a[0],'h'=>$a[1],'cs'=>$colspace,'bpc'=>$bpc,'f'=>'DCTDecode','data'=>$data);
+}
+
+function _parsepng($file)
+{
+	//Extract info from a PNG file
+	$f=fopen($file,'rb');
+	if(!$f)
+		$this->Error('Can\'t open image file: '.$file);
+	//Check signature
+	if(fread($f,8)!=chr(137).'PNG'.chr(13).chr(10).chr(26).chr(10))
+		$this->Error('Not a PNG file: '.$file);
+	//Read header chunk
+	fread($f,4);
+	if(fread($f,4)!='IHDR')
+		$this->Error('Incorrect PNG file: '.$file);
+	$w=$this->_freadint($f);
+	$h=$this->_freadint($f);
+	$bpc=ord(fread($f,1));
+	if($bpc>8)
+		$this->Error('16-bit depth not supported: '.$file);
+	$ct=ord(fread($f,1));
+	if($ct==0)
+		$colspace='DeviceGray';
+	elseif($ct==2)
+		$colspace='DeviceRGB';
+	elseif($ct==3)
+		$colspace='Indexed';
+	else
+		$this->Error('Alpha channel not supported: '.$file);
+	if(ord(fread($f,1))!=0)
+		$this->Error('Unknown compression method: '.$file);
+	if(ord(fread($f,1))!=0)
+		$this->Error('Unknown filter method: '.$file);
+	if(ord(fread($f,1))!=0)
+		$this->Error('Interlacing not supported: '.$file);
+	fread($f,4);
+	$parms='/DecodeParms <</Predictor 15 /Colors '.($ct==2 ? 3 : 1).' /BitsPerComponent '.$bpc.' /Columns '.$w.'>>';
+	//Scan chunks looking for palette, transparency and image data
+	$pal='';
+	$trns='';
+	$data='';
+	do
+	{
+		$n=$this->_freadint($f);
+		$type=fread($f,4);
+		if($type=='PLTE')
+		{
+			//Read palette
+			$pal=fread($f,$n);
+			fread($f,4);
+		}
+		elseif($type=='tRNS')
+		{
+			//Read transparency info
+			$t=fread($f,$n);
+			if($ct==0)
+				$trns=array(ord(substr($t,1,1)));
+			elseif($ct==2)
+				$trns=array(ord(substr($t,1,1)),ord(substr($t,3,1)),ord(substr($t,5,1)));
+			else
+			{
+				$pos=strpos($t,chr(0));
+				if($pos!==false)
+					$trns=array($pos);
+			}
+			fread($f,4);
+		}
+		elseif($type=='IDAT')
+		{
+			//Read image data block
+			$data.=fread($f,$n);
+			fread($f,4);
+		}
+		elseif($type=='IEND')
+			break;
+		else
+			fread($f,$n+4);
+	}
+	while($n);
+	if($colspace=='Indexed' && empty($pal))
+		$this->Error('Missing palette in '.$file);
+	fclose($f);
+	return array('w'=>$w,'h'=>$h,'cs'=>$colspace,'bpc'=>$bpc,'f'=>'FlateDecode','parms'=>$parms,'pal'=>$pal,'trns'=>$trns,'data'=>$data);
+}
+
+function _freadint($f)
+{
+	//Read a 4-byte integer from file
+	$a=unpack('Ni',fread($f,4));
+	return $a['i'];
+}
+
+function _textstring($s)
+{
+	//Format a text string
+	return '('.$this->_escape($s).')';
+}
+
+function _escape($s)
+{
+	//Add \ before \, ( and )
+	return str_replace(')','\\)',str_replace('(','\\(',str_replace('\\','\\\\',$s)));
+}
+
+function _putstream($s)
+{
+	$this->_out('stream');
+	$this->_out($s);
+	$this->_out('endstream');
+}
+
+function _out($s)
+{
+	//Add a line to the document
+	if($this->state==2)
+		$this->pages[$this->page].=$s."\n";
+	else
+		$this->buffer.=$s."\n";
+}
+//End of class
+}
+
+//Handle special IE contype request
+if(isset($_SERVER['HTTP_USER_AGENT']) && $_SERVER['HTTP_USER_AGENT']=='contype')
+{
+	header('Content-Type: application/pdf');
+	exit;
+}
+
+}
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/fpdf/fpdf.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdfmaker.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdfmaker.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdfmaker.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,106 @@
+<?php
+/**
+ * xoops_opal_PdfMaker main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_PdfMaker
+ * @version		$Id$
+ */
+
+/**
+ * This file cannot be requested directly
+ */
+if ( !defined( 'XOOPS_PATH' ) ) exit();
+
+XOS::import( 'FPDF' );
+XOS::import( 'PDML' );
+
+/**
+ * Opal PDF generation component (based on {@link http://pdml.sourceforge.net/ PDML}+{@link http://www.fpdf.org/ FPDF})
+ *
+ * For the moment the PDF maker just provides a dummy implementation of {@link http://pdml.sourceforge.net/ PDML}/
+ * {@link http://www.fpdf.org/ FPDF}. It is called by the {@link xoops_opal_Theme theme service} when it is
+ * asked to return PDF output (templates are processed normally, and their output sent to this component for
+ * post-processing).
+ * 
+ * Please note that this component is just here for experimentation purposes and that the decision to go for
+ * PDML is not yet definitive. If you don't want to take any risk to have to rewrite some of your code,
+ * you may prefer to make direct use of the FPDF class.
+ * 
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_PdfMaker
+ * @devstatus	unstable
+ */
+class xoops_opal_PdfMaker extends PDML {
+	/**
+	 * Format of the output page
+	 * 
+	 * Configures the page format of the generated document. Valid values are <var>A5</var>,
+	 * <var>A4</var>, <var>A3</var>, <var>letter</var>, <var>legal</var>.
+	 * @var string
+	 */
+	var $pageFormat = 'A4';
+	/**
+	 * Orientation of the output page
+	 * 
+	 * Configures the page orientation of the generated document. Valid values are
+	 * <var>P</var> for Portrait, and <var>L</var> for landscape.
+	 * @var string
+	 */
+	var $pageOrientation = 'P';
+	/**
+	 * Default measure unit
+	 * 
+	 * Configures the default user mesure unit. Possible values are:
+	 * - <b>pt:</b> point (1/72 of inch, or 0.35mm)
+	 * - <b>mm:</b> millimeter
+	 * - <b>cm:</b> centimeter
+	 * - <b>in:</b> inch
+	 * 
+	 * NB: It seems that PDML has problems with anything else than pt, so you may want to stick
+	 * with this unit ;-).
+	 * 
+	 * @var string
+	 */
+	var $unitType = 'pt';
+	/**
+	 * Initializes the PDF maker and the underlying FPDF class.
+	 *
+	 * @param array $options
+	 * @return bool
+	 */	
+	function xoInit( $options = array() ) {
+		$this->FPDF( $this->pageOrientation, $this->unitType, $this->pageFormat );
+		return true;
+	}
+	/**
+	 * Start capturing output for later post-processing
+	 * 
+	 * This method starts output buffering, ensuring content is sent to the
+	 * {@link xoops_opal_PdfMaker::transformPdml()} method.
+	 */
+	function startCapture() {
+		$this->compress = 0;
+		ob_start( array( &$this, 'transformPdml' ) );
+	}
+	/**
+	 * Parses the specified PDML string and returns PDF content
+	 * @param string PDML string to parse
+	 * @return string Content of the generated PDF file
+	 */
+	function transformPdml( $str ) {
+		$this->ParsePDML( $str );
+		return $this->Output( '', 'S' );	
+	}
+
+}
+
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdfmaker.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdml.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdml.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdml.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,1067 @@
+<?php
+
+//define('FPDF_FONTPATH','font/');
+//require "fpdf.php";
+
+class PDML extends FPDF {
+
+    var $parserState=0;
+    var $final;             // final PDF output.
+    var $inPage = false;    // are we in a page yet?
+    var $anchors = array(); // map anchor names to internal ids.
+    var $href = array();    // stack of current URLs to link to. (shift/unshift)
+    var $href_style = array(); // should links be underlined blue? 0/1
+    var $font_color = array("000000");   // current text color
+    var $font_size  = array("10");   // current font size
+    var $font_face  = array("Helvetica");   // current font name
+    var $font_mask  = array(); // keep track of stuff so that </font> works right.
+    var $B = 0;
+    var $I = 0;
+    var $U = 0;
+    var $left_margin = array( 28.35 ); // 1cm
+    var $right_margin = array( 28.35 ); // 1cm
+    var $bottom_margin = array( 28.35 ); // 1cm
+    var $div_x = array();
+    var $div_y = array();
+    var $cell_info; // stuff to keep around until a </cell> shows up
+    var $cell_text; // text to put in a cell.
+    var $script;    // stuff to put in our script.
+    var $header='';
+    var $footer='';
+    var $parserBreak; // when you want to break parsing, put a stop word here.
+    var $multicol = array(); // stack of columns. you never know.
+
+    /* Rotation extension. Should go away with 1.6 */
+    var $angle=0;
+    function Rotate($angle,$x=-1,$y=-1)
+    {
+        if($x==-1)
+            $x=$this->x;
+        if($y==-1)
+            $y=$this->y;
+        if($this->angle!=0)
+            $this->_out('Q');
+        $this->angle=$angle;
+        if($angle!=0)
+        {
+            $angle*=M_PI/180;
+            $c=cos($angle);
+            $s=sin($angle);
+            $cx=$x*$this->k;
+            $cy=($this->h-$y)*$this->k;
+            $this->_out(sprintf('q %.5f %.5f %.5f %.5f %.2f %.2f cm 1 0 0 1 %.2f %.2f cm',$c,   $s,-$s,$c,$cx,$cy,-$cx,-$cy));
+        }
+    }
+    function _endpage()
+    {
+        if($this->angle!=0)
+        {
+            $this->angle=0;
+            $this->_out('Q');
+        }
+        parent::_endpage();
+    }
+    /* End of Rotation Extension */
+
+    /* Ellipse extension. Should go away with 1.6 */
+    function Circle($x,$y,$r,$style='') {
+        $this->Ellipse($x,$y,$r,$r,$style);
+    }
+
+    function Ellipse($x,$y,$rx,$ry,$style='D') {
+        if($style=='F')
+            $op='f';
+        elseif($style=='FD' or $style=='DF')
+            $op='B';
+        else
+            $op='S';
+        $lx=4/3*(M_SQRT2-1)*$rx;
+        $ly=4/3*(M_SQRT2-1)*$ry;
+        $k=$this->k;
+        $h=$this->h;
+        $this->_out(sprintf('%.2f %.2f m %.2f %.2f %.2f %.2f %.2f %.2f c',
+            ($x+$rx)*$k,($h-$y)*$k,
+            ($x+$rx)*$k,($h-($y-$ly))*$k,
+            ($x+$lx)*$k,($h-($y-$ry))*$k,
+            $x*$k,($h-($y-$ry))*$k));
+        $this->_out(sprintf('%.2f %.2f %.2f %.2f %.2f %.2f c',
+            ($x-$lx)*$k,($h-($y-$ry))*$k,
+            ($x-$rx)*$k,($h-($y-$ly))*$k,
+            ($x-$rx)*$k,($h-$y)*$k));
+        $this->_out(sprintf('%.2f %.2f %.2f %.2f %.2f %.2f c',
+            ($x-$rx)*$k,($h-($y+$ly))*$k,
+            ($x-$lx)*$k,($h-($y+$ry))*$k,
+            $x*$k,($h-($y+$ry))*$k));
+        $this->_out(sprintf('%.2f %.2f %.2f %.2f %.2f %.2f c %s',
+            ($x+$lx)*$k,($h-($y+$ry))*$k,
+            ($x+$rx)*$k,($h-($y+$ly))*$k,
+            ($x+$rx)*$k,($h-$y)*$k,
+            $op));
+    }
+    /* End of Ellipse Extension */
+
+    /* Javascript extension. That may stick here a while. */
+    var $javascript;
+    var $n_js;
+    function IncludeJS($script) {
+        $this->javascript.=$script;
+    }
+    function _putjavascript() {
+        $this->_newobj();
+        $this->n_js=$this->n;
+        $this->_out('<<');
+        $this->_out('/Names [(EmbeddedJS) '.($this->n+1).' 0 R ]');
+        $this->_out('>>');
+        $this->_out('endobj');
+        $this->_newobj();
+        $this->_out('<<');
+        $this->_out('/S /JavaScript');
+        $this->_out('/JS '.$this->_textstring($this->javascript));
+        $this->_out('>>');
+        $this->_out('endobj');
+    }
+    function _putresources() {
+        parent::_putresources();
+        if (!empty($this->javascript)) {
+            $this->_putjavascript();
+        }
+        $this->_putbookmarks();
+    }
+    function _putcatalog() {
+        parent::_putcatalog();
+        if (isset($this->javascript)) {
+            $this->_out('/Names <</JavaScript '.($this->n_js).' 0 R>>');
+        }
+        if(count($this->outlines)>0)
+        {
+            $this->_out('/Outlines '.$this->OutlineRoot.' 0 R');
+            $this->_out('/PageMode /UseOutlines');
+        }
+    }
+    /* End of Javascript Extension */
+
+    /* Bookmark Extension. Should go away with 1.6 */
+    var $outlines=array();
+    var $OutlineRoot;
+    function Bookmark($txt,$level=0,$y=0)
+    {
+        if($y==-1)
+            $y=$this->GetY();
+        $this->outlines[]=array('t'=>$txt,'l'=>$level,'y'=>$y,'p'=>$this->PageNo());
+    }
+    function _putbookmarks()
+    {
+        $nb=count($this->outlines);
+        if($nb==0)
+            return;
+        $lru=array();
+        $level=0;
+        foreach($this->outlines as $i=>$o)
+        {
+            if($o['l']>0)
+            {
+                $parent=$lru[$o['l']-1];
+                //Set parent and last pointers
+                $this->outlines[$i]['parent']=$parent;
+                $this->outlines[$parent]['last']=$i;
+                if($o['l']>$level)
+                {
+                    //Level increasing: set first pointer
+                    $this->outlines[$parent]['first']=$i;
+                }
+            }
+            else
+                $this->outlines[$i]['parent']=$nb;
+            if($o['l']<=$level and $i>0)
+            {
+                //Set prev and next pointers
+                $prev=$lru[$o['l']];
+                $this->outlines[$prev]['next']=$i;
+                $this->outlines[$i]['prev']=$prev;
+            }
+            $lru[$o['l']]=$i;
+            $level=$o['l'];
+        }
+        //Outline items
+        $n=$this->n+1;
+        foreach($this->outlines as $i=>$o)
+        {
+            $this->_newobj();
+            $this->_out('<</Title '.$this->_textstring($o['t']));
+            $this->_out('/Parent '.($n+$o['parent']).' 0 R');
+            if(isset($o['prev']))
+                $this->_out('/Prev '.($n+$o['prev']).' 0 R');
+            if(isset($o['next']))
+                $this->_out('/Next '.($n+$o['next']).' 0 R');
+            if(isset($o['first']))
+                $this->_out('/First '.($n+$o['first']).' 0 R');
+            if(isset($o['last']))
+                $this->_out('/Last '.($n+$o['last']).' 0 R');
+            $this->_out(sprintf('/Dest [%d 0 R /XYZ 0 %.2f null]',1+2*$o['p'],($this->h-$o['y'])*$this->k));
+            $this->_out('/Count 0>>');
+            $this->_out('endobj');
+        }
+        //Outline root
+        $this->_newobj();
+        $this->OutlineRoot=$this->n;
+        $this->_out('<</Type /Outlines /First '.$n.' 0 R');
+        $this->_out('/Last '.($n+$lru[0]).' 0 R>>');
+        $this->_out('endobj');
+    }
+    /* End of Bookmark Extension */
+
+    function ParsePDML($pdml) {
+        // default font.
+        $this->SetFont($this->font_face[0],'',$this->font_size[0]);
+        // apply margins
+        $this->SetRightMargin($this->right_margin[0]);
+        $this->SetLeftMargin($this->left_margin[0]);
+        // bottom margin
+        $this->SetAutoPageBreak(true, $this->bottom_margin[0]);
+
+        $this->AliasNbPages('&pagecount;');
+
+        $this->_parsePDML($pdml);
+        //return $this->final;
+    }
+
+    function Header() {
+        $this->_parsePDML($this->header);
+    }
+
+    function Footer() {
+        $this->_parsePDML($this->footer);
+    }
+
+    function AcceptPageBreak() {
+        if (count($this->multicol>0)) {
+            // we need: starting y0, col_width, col_spacing, columns, height, break=page/line
+            list($x0, $y0, $width, $height, $spacing, $break, $cols, $current) = $this->multicol[0];
+            if ($current<$cols-1) {
+                // next column
+                $current++;
+                $this->multicol[0][7] = $current;
+                $x = $x0 + $current * $width;
+                $this->SetLeftMargin($x);
+                $this->SetX($x);
+                $this->SetY($y0);
+                return false;
+            } else {
+                // ok. we need to break.
+                $this->SetLeftMargin($x0);
+                $this->SetX($x0);
+                $this->multicol[0][7] = 0; // $current
+                if ($break=="line") {
+                    $y0 += $spacing + $height; // y0
+                    $this->multicol[0][1] = $y0;
+                    $this->SetAutoPageBreak(true, $this->hPt - ( $y0 + $height));
+                    $this->SetY($y0);
+                    //$this->Write(10,"This sux0rs.");
+                    return false;
+                } else {
+                    // page break.
+                    return true;
+                }
+            }
+        } else {
+            // no multi-column tag. do the normal thing.
+            return true;
+        }
+    }
+
+    function _parsePDML($pdml) {
+        $a = preg_split('/<([^<]*)\/?>/U',$pdml,-1,PREG_SPLIT_DELIM_CAPTURE);
+        foreach ($a as $i=>$e) {
+            if ($this->parserBreak) {
+                if ($i%2==0) {
+                    $this->ProcessText($e);
+                    continue;
+                }
+                if (strcasecmp($e,$this->parserBreak)) {
+                    $this->ProcessText('<'.$e.'>');
+                    continue;
+                }
+            }
+            if ($i%2==0) {
+                // text
+                $this->ProcessText(pdml_entity_decode(preg_replace(
+                    array(
+                        '/\s+/',
+                        '/&pagenumber;/',
+                        '/&title;/',
+                        '/&author;/',
+                        '/&subject;/',
+                        '/&creator;/'
+                        ),
+                    array(
+                        ' ',
+                        $this->PageNo(),
+                        $this->title,
+                        $this->author,
+                        $this->subject,
+                        $this->creator
+                    ) ,$e)));
+            } else {
+                // tag
+                if ($e{0}=='/') {
+                    $this->CloseTag(strtoupper(substr($e,1)));
+                } else {
+                    $a2 = explode(' ',$e,2);
+                    $tag = strtoupper(array_shift($a2));
+                    $e = substr($e, strlen($tag)+1);
+                    // stolen from http://www.cs.sfu.ca/~cameron/REX.html
+                    // bugified into uselessness. It's the intent that counts. right?
+                    $NameStrt = "[A-Za-z_:]|[^\\x00-\\x7F]";
+                    $NameChar = "[A-Za-z0-9_:.-]|[^\\x00-\\x7F]";
+                    $Name = "(?:$NameStrt)(?:$NameChar)*";
+                    $S = "[ \\n\\t\\r]+";
+                    $AttValSE = "\"[^\"]*\"|'[^']*'|[^ \\n\\t\\r]+";
+                    $ElemTagCE = "($Name)(?:$S)?=(?:$S)?($AttValSE)";
+
+                    $attr = array();
+                    preg_match_all("/$ElemTagCE/", $e, $matches, PREG_SET_ORDER);
+                    for ($i=0;$i<count($matches);$i++) {
+                        $val = $matches[$i][2];
+                        if ((($val{0}=='"') and (substr($val,-1)=='"')) or
+                            (($val{0}=="'") and (substr($val,-1)=="'")) ){
+                            $val = substr($val, 1, strlen($val)-2);
+                        }
+                        $attr[strtoupper($matches[$i][1])] = $val;
+                    }
+                    $this->OpenTag($tag,$attr);
+                }
+            }
+        }
+    }
+
+    function ProcessText($text) {
+        switch ($this->parserState) {
+            case 0:
+            case 1:
+            case 2:
+                // ignore text/whitespace in there.
+                break;
+            case 3:
+                $this->SetTitle($text);
+                break;
+            case 4:
+                $this->SetSubject($text);
+                break;
+            case 5:
+                $this->SetAuthor($text);
+                break;
+            case 6:
+                $this->SetKeywords($text);
+                break;
+            case 51:
+                $this->cell_text .= $text;
+                break;
+            case 10:
+                $this->script .= $text;
+                break;
+            case 63:
+                $this->header .= $text;
+                break;
+            case 64:
+                $this->footer .= $text;
+                break;
+            default:
+                // ignore pure whitespace
+                if (preg_match("/^[ \\n\\t\\r]*$/",$text)) break;
+                // auto-create a page if needed.
+                if (!$this->inPage) {
+                    $this->inPage = true;
+                    $this->AddPage();
+                }
+                // write stuff.
+                // do we have a link to use?
+                if (sizeof($this->href)>0) {
+                    if ($this->href_style[0]) {
+                        $this->SetTextColor(0,0,255);
+                        $this->_setStyle('U',true, true);
+                    }
+                    $this->Write($this->font_size[0],$text,$this->href[0]);
+                    if ($this->href_style[0]) {
+                        $this->_setStyle('U', $this->U>0, true);
+                        $this->_setFontColor($this->font_color[0]);
+                    }
+                } else {
+                    $this->Write($this->font_size[0],$text);
+                }
+        }
+    }
+
+    function OpenTag($tag, $attr) {
+        switch ($tag) {
+            case "PDML":
+                $this->_enforceState(0,1);
+                break;
+            case "HEAD":
+                $this->_enforceState(1,2);
+                break;
+            case "TITLE":
+                $this->_enforceState(2,3);
+                break;
+            case "SUBJECT":
+                $this->_enforceState(2,4);
+                break;
+            case "AUTHOR":
+                $this->_enforceState(2,5);
+                break;
+            case "KEYWORDS":
+                $this->_enforceState(2,6);
+                break;
+            case "SCRIPT":
+                $this->_enforceState(2,10);
+                $this->script='';
+                $this->parserBreak="/script";
+                break;
+            case "BODY":
+                $this->_enforceState(1,50);
+                break;
+            case "PAGE":
+                $this->_enforceState(50,50);
+                $o = "P";
+                if (isset($attr["ORIENTATION"])) {
+                    if (strcasecmp($attr["ORIENTATION"],"LANDSCAPE")==0) {
+                        $o = "L";
+                    }
+                }
+                $this->inPage=true;
+                $this->AddPage($o);
+                break;
+            case "BR":
+                // no enforcement.
+                if ($this->parserState==51) {
+                    $this->cell_text.="\n";
+                    break;
+                }
+                if (isset($attr["HEIGHT"])) {
+                    $h=$this->_getUnit($attr["HEIGHT"], $this->font_size[0]);
+                    $this->Ln($h);
+                } else {
+                    $this->Ln($this->font_size[0]);
+                }
+                break;
+            case "A":
+                $this->_enforceState(50,50);
+                // name=
+                if (isset($attr["NAME"])) {
+                    // local anchor
+                    $name = $attr["NAME"];
+                    if (!isset($this->anchors[$name])) {
+                        $this->anchors[$name] = $this->AddLink();
+                    }
+                    $this->SetLink($this->anchors[$name], -1);
+                }
+                // href=
+                if (isset($attr["HREF"])) {
+                    $href = $attr["HREF"];
+                    if ($href[0]=='#') {
+                        // local anchor
+                        $href = substr($href,1);
+                        if (!isset($this->anchors[$href])) {
+                            $this->anchors[$href] = $this->AddLink();
+                        }
+                        array_unshift ($this->href, $this->anchors[$href]);
+                    } else {
+                        array_unshift ($this->href, $href);
+                    }
+                    // we should set style to underlined blue. XXX
+                    array_unshift ($this->href_style, isset($attr["HIDDEN"])?0:1);
+                }
+                break;
+            case "B":
+            case "I":
+            case "U":
+                $this->_enforceState(50,50);
+                $this->_setStyle($tag, true);
+                break;
+            case "FONT":
+                $this->_enforceState(50,50);
+                $mask = 0;
+                if (isset($attr["COLOR"])) {
+                    // hex-encoded color. no space for long color name list.
+                    $color = $attr["COLOR"];
+                    if ($color[0]=="#") { $color = substr($color,1); }
+                    array_unshift($this->font_color, $color);
+                    $this->_setFontColor($color);
+                    $mask |= 1;
+                }
+                if (isset($attr["SIZE"])) {
+                    $size = $this->_getUnit($attr["SIZE"], $this->font_size[0]);
+                    array_unshift($this->font_size, $size);
+                    $this->SetFontSize($size);
+                    $mask |= 2;
+                }
+                if (isset($attr["FACE"])) {
+                    $face = $attr["FACE"];
+                    array_unshift($this->font_face, $face);
+                    $this->_setFontFace($face);
+                    $mask |= 4;
+                }
+                array_unshift($this->font_mask, $mask);
+                break;
+            case "IMG":
+                $this->_enforceState(50,50);
+                if (!isset($attr["SRC"])) break;
+                $src = $attr["SRC"];
+                $x = $this->GetX();
+                if (isset($attr["LEFT"])) {
+                    $x = $this->_getUnit($attr["LEFT"], $this->wPt);
+                }
+                $y = $this->GetY();
+                if (isset($attr["TOP"])) {
+                    $y = $this->_getUnit($attr["TOP"], $this->hPt);
+                }
+                $width = 0;
+                if (isset($attr["WIDTH"])) {
+                    $width = $this->_getUnit($attr["WIDTH"], $this->wPt);
+                }
+                $height = 0;
+                if (isset($attr["HEIGHT"])) {
+                    $height = $this->_getUnit($attr["HEIGHT"], $this->hPt);
+                }
+                // try to resolve src a bit if necessary.
+                if (!file_exists($src)) {
+                    $src1 = getenv("DOCUMENT_ROOT")."/".$src;
+                    $src2 = dirname(getenv("SCRIPT_FILENAME"))."/".$src;
+                    if (file_exists($src1)) {
+                        $src = $src1;
+                    } elseif (file_exists($src2)) {
+                        $src = $src2;
+                    }
+                }
+                if (sizeof($this->href)>0) {
+                    $this->Image($src, $x, $y, $width, $height, '', $this->href[0]);
+                } else {
+                    $this->Image($src, $x, $y, $width, $height);
+                }
+                break;
+            case "LINE":
+                $this->_enforceState(50,50);
+                $x1 = $this->GetX();
+                $y1 = $this->GetY();
+                if (isset($attr["FROM"])) {
+                    list($x1,$y1) = explode(',',$attr["FROM"]);
+                    $x1 = $this->_getUnit($x1, $this->wPt);
+                    $y1 = $this->_getUnit($y1, $this->hPt);
+                }
+                $x2 = $this->wPt;
+                $y2 = $y1;
+                if (isset($attr["TO"])) {
+                    list($x2,$y2) = explode(',',$attr["TO"]);
+                    $x2 = $this->_getUnit($x2, $this->wPt);
+                    $y2 = $this->_getUnit($y2, $this->hPt);
+                }
+                $color = "000000";
+                if (isset($attr["COLOR"])) {
+                    $color = $attr["COLOR"];
+                    if ($color[0]=="#") { $color = substr($color,1); }
+                }
+                $lwidth = $this->_getUnit("0.2mm");
+                if (isset($attr["WIDTH"])) {
+                    $lwidth = $this->_getUnit($attr["WIDTH"], $lwidth);
+                }
+                $this->_setLineColor($color);
+                $this->SetLineWidth($lwidth);
+                $this->Line($x1,$y1,$x2,$y2);
+                break;
+            case "RECT":
+                $this->_enforceState(50,50);
+                $x1 = $this->GetX();
+                $y1 = $this->GetY();
+                if (isset($attr["FROM"])) {
+                    list($x1,$y1) = explode(',',$attr["FROM"]);
+                    $x1 = $this->_getUnit($x1, $this->wPt);
+                    $y1 = $this->_getUnit($y1, $this->hPt);
+                }
+                if (isset($attr["LEFT"])) {
+                    $x1 = $this->_getUnit($attr["LEFT"], $this->wPt);
+                }
+                if (isset($attr["TOP"])) {
+                    $y1 = $this->_getUnit($attr["TOP"], $this->hPt);
+                }
+                $width= 144;
+                $height= 36;
+                if (isset($attr["TO"])) {
+                    list($x2,$y2) = explode(',',$attr["TO"]);
+                    $x2 = $this->_getUnit($x2, $this->wPt);
+                    $y2 = $this->_getUnit($y2, $this->hPt);
+                    $width  = $x2-$x1+1;
+                    $height = $y2-$y1+1;
+                }
+                if (isset($attr["WIDTH"])) {
+                    $width = $this->_getUnit($attr["WIDTH"], $this->wPt);
+                }
+                if (isset($attr["HEIGHT"])) {
+                    $height = $this->_getUnit($attr["HEIGHT"], $this->hPt);
+                }
+                $style="";
+                $color = "000000";
+                if (isset($attr["COLOR"])) {
+                    $color = $attr["COLOR"];
+                    if ($color[0]=="#") { $color = substr($color,1); }
+                    $style.="D";
+                }
+                $fill = "000000";
+                if (isset($attr["FILLCOLOR"])) {
+                    $fill = $attr["FILLCOLOR"];
+                    if ($fill[0]=="#") { $fill = substr($fill,1); }
+                    $style.="F";
+                }
+                $border = $this->_getUnit("0.2mm");
+                if (isset($attr["BORDER"])) {
+                    $border = $this->_getUnit($attr["BORDER"], $border);
+                }
+                $this->_setLineColor($color);
+                $this->SetLineWidth($border);
+                $this->_setRectColor($fill);
+                $this->Rect($x1,$y1,$width,$height,$style);
+                break;
+            case "CIRCLE":
+            case "ELLIPSE":
+                $this->_enforceState(50,50);
+                $x1 = $this->GetX();
+                $y1 = $this->GetY();
+                if (isset($attr["FROM"])) {
+                    list($x1,$y1) = explode(',',$attr["FROM"]);
+                    $x1 = $this->_getUnit($x1, $this->wPt);
+                    $y1 = $this->_getUnit($y1, $this->hPt);
+                }
+                $radius = $this->_getAttrUnit($this->font_size[0], $attr, "RADIUS", $this->font_size[0]);
+                $xradius = $this->_getAttrUnit($radius, $attr, "XRADIUS", $this->font_size[0]);
+                $yradius = $this->_getAttrUnit($radius, $attr, "YRADIUS", $this->font_size[0]);
+                $style="";
+                $color = "000000";
+                if (isset($attr["COLOR"])) {
+                    $color = $attr["COLOR"];
+                    if ($color[0]=="#") { $color = substr($color,1); }
+                    $style.="D";
+                }
+                $fill = "000000";
+                if (isset($attr["FILLCOLOR"])) {
+                    $fill = $attr["FILLCOLOR"];
+                    if ($fill[0]=="#") { $fill = substr($fill,1); }
+                    $style.="F";
+                }
+                $border = $this->_getUnit("0.2mm");
+                if (isset($attr["BORDER"])) {
+                    $border = $this->_getUnit($attr["BORDER"], $border);
+                }
+                $this->_setLineColor($color);
+                $this->SetLineWidth($border);
+                $this->_setRectColor($fill);
+                $this->Ellipse($x1, $y1, $xradius, $yradius, $style);
+                break;
+            case "DIV":
+                $this->_enforceState(50,50);
+                $save_x = $this->GetX();
+                $x = $this->_getAttrUnit($save_x, $attr, "LEFT", $this->wPt);
+                $save_y = $this->GetY();
+                $y = $this->_getAttrUnit($save_y, $attr, "TOP", $this->hPt);
+                $width = $this->_getAttrUnit($this->wPt-$x, $attr, "WIDTH", $this->wPt);
+                $height = $this->_getAttrUnit($this->hPt-$y, $attr, "HEIGHT", $this->hPt);
+                if ($x == $save_x) { $save_x+=$width; }
+                array_unshift($this->left_margin, $x);
+                array_unshift($this->right_margin, $this->wPt-$width-$x);
+                array_unshift($this->div_x, $save_x);
+                array_unshift($this->div_y, $save_y);
+                // draw a rect, just to debug. XXX
+                $style="";
+                $color = "000000";
+                if (isset($attr["COLOR"])) {
+                    $color = $attr["COLOR"];
+                    if ($color[0]=="#") { $color = substr($color,1); }
+                    $style.="D";
+                }
+                $fill = "000000";
+                if (isset($attr["FILLCOLOR"])) {
+                    $fill = $attr["FILLCOLOR"];
+                    if ($fill[0]=="#") { $fill = substr($fill,1); }
+                    $style.="F";
+                }
+                $border = $this->_getUnit("0.2mm");
+                if (isset($attr["BORDER"])) {
+                    $border = $this->_getUnit($attr["BORDER"], $border);
+                }
+                $this->_setLineColor($color);
+                $this->SetLineWidth($border);
+                $this->_setRectColor($fill);
+                if ($style) {
+                    $this->Rect($x,$y,$width,$height,$style);
+                }
+                $this->SetLeftMargin($this->left_margin[0]);
+                $this->SetRightMargin($this->right_margin[0]);
+                $this->SetXY($x,$y);
+                break;
+            case "MULTICELL":
+            case "CELL":
+                $this->_enforceState(50,51);
+                $save_x = $this->GetX();
+                $x = $this->_getAttrUnit($save_x, $attr, "LEFT", $this->wPt);
+                $save_y = $this->GetY();
+                $y = $this->_getAttrUnit($save_y, $attr, "TOP", $this->hPt);
+                $width = $this->_getAttrUnit($this->wPt-$x, $attr, "WIDTH", $this->wPt);
+                // used by multicell only
+                $inter = $this->_getAttrUnit($this->font_size[0], $attr, "INTER", $this->font_size[0]);
+                // used by cell only.
+                $height = $this->_getAttrUnit($this->font_size[0], $attr, "HEIGHT", $this->font_size[0]);
+                $next = 0;
+                if (isset($attr["NEXT"])) {
+                    $n = strtolower($attr["NEXT"]);
+                    switch ($n) {
+                        case "right": $next =0; break;
+                        case "bottom": case "down": $next=2; break;
+                        case "break": $next = 1; break;
+                    }
+                }
+                $style="";
+                $color = "000000";
+                if (isset($attr["COLOR"])) {
+                    $color = $attr["COLOR"];
+                    if ($color[0]=="#") { $color = substr($color,1); }
+                    $style.="D";
+                }
+                $fillflag = 0;
+                $fill = "000000";
+                if (isset($attr["FILLCOLOR"])) {
+                    $fill = $attr["FILLCOLOR"];
+                    if ($fill[0]=="#") { $fill = substr($fill,1); }
+                    $fillflag=1;
+                }
+                $borderflag=0;
+                $border = $this->_getUnit("0.2mm");
+                if (isset($attr["BORDER"])) {
+                    $border = $this->_getUnit($attr["BORDER"], $border);
+                    $borderflag=1;
+                }
+                $align = ($tag=="CELL")?"L":"J";
+                if (isset($attr["ALIGN"])) {
+                    $al = strtolower($attr["ALIGN"]);
+                    switch ($al){
+                        case "left": $align="L"; break;
+                        case "center": $align="C"; break;
+                        case "right": $align="R"; break;
+                        case "justify": $align="J"; break;
+                    }
+                }
+                $this->_setLineColor($color);
+                $this->SetLineWidth($border);
+                $this->_setRectColor($fill);
+                $this->SetXY($x,$y);
+                $this->cell_info = array($width, $inter, $height, $borderflag, $align, $fillflag, $next);
+                $this->cell_text = '';
+                break;
+            case "ROTATE":
+                $angle=45;
+                if (isset($attr["ANGLE"])) {
+                    $angle = $attr["ANGLE"];
+                }
+                $x=-1;
+                $y=-1;
+                if (isset($attr["CENTER"])) {
+                    list($x,$y) = explode(',',$attr["CENTER"]);
+                    $x = $this->_getUnit($x, $this->wPt);
+                    $y = $this->_getUnit($y, $this->hPt);
+                }
+                $this->rotate($angle, $x, $y);
+                break;
+            case "BOOKMARK":
+                if (!isset($attr["TITLE"])) break;
+                $title = $attr["TITLE"];
+                $level = 0;
+                if (isset($attr["LEVEL"])) {
+                    $level = $attr["LEVEL"];
+                }
+                $top = -1;
+                if (isset($attr["TOP"])) {
+                    $top = $this->_getUnit($attr["TOP"], $this->hPt);
+                }
+                $this->Bookmark($title, $level, $top);
+                break;
+            case "HEADER":
+                $this->_enforceState(50,63);
+                $this->header='';
+                $this->parserBreak='/header';
+                break;
+            case "FOOTER":
+                $this->_enforceState(50,64);
+                $this->footer='';
+                $this->parserBreak='/footer';
+                break;
+            case "COLUMN":
+                $this->_enforceState(50,50);
+                $save_x = $this->GetX();
+                $x = $this->_getAttrUnit($save_x, $attr, "LEFT", $this->wPt);
+                $save_y = $this->GetY();
+                $y = $this->_getAttrUnit($save_y, $attr, "TOP", $this->hPt);
+                $count = 2;
+                if (isset($attr["COUNT"])) {
+                    $count = (int)$attr["COUNT"];
+                }
+                $width = $this->_getAttrUnit(($this->wPt-$x)/$count, $attr, "WIDTH", $this->wPt);
+                $height = $this->_getAttrUnit($this->hPt-$y, $attr, "HEIGHT", $this->hPt);
+                $spacing = $this->_getAttrUnit($this->font_size[0], $attr, "SPACING", $this->font_size[0]);
+                $break = "page";
+                if (isset($attr["BREAK"]) and (strtolower($attr["BREAK"])=="line")) {
+                    $break = "line";
+                }
+                // store stuff for acceptPageBreak to make sense of, and stuff we're saving
+                array_unshift($this->multicol, array($x,$y,$width,$height,$spacing, $break, $count, 0, ));
+                array_unshift($this->left_margin, $x);
+                array_unshift($this->bottom_margin, $this->hPt-($y+$height));
+                // set margins to make things work.
+                $this->SetLeftMargin($this->left_margin[0]);
+                $this->SetAutoPageBreak(true, $this->bottom_margin[0]);
+                break;
+        }
+    }
+
+    function CloseTag($tag) {
+        switch ($tag) {
+            case "PDML":
+                $this->_enforceState(1,0);
+                //$this->final = $this->Output("","S");
+                break;
+            case "HEAD":
+                $this->_enforceState(2,1);
+                break;
+            case "TITLE":
+                $this->_enforceState(3,2);
+                break;
+            case "SUBJECT":
+                $this->_enforceState(4,2);
+                break;
+            case "AUTHOR":
+                $this->_enforceState(5,2);
+                break;
+            case "KEYWORDS":
+                $this->_enforceState(6,2);
+                break;
+            case "SCRIPT":
+                $this->_enforceState(10,2);
+                $this->IncludeJS($this->script);
+                $this->parserBreak='';
+                break;
+            case "BODY":
+                $this->Close();
+                $this->_enforceState(50,1);
+                break;
+            case "A":
+                array_shift ($this->href);
+                array_shift ($this->href_style);
+                // we should remove underline + blue.
+                break;
+            case "B":
+            case "I":
+            case "U":
+                $this->_setStyle($tag, false);
+                break;
+            case "FONT":
+                if (sizeof($this->font_mask)>0) {
+                    $mask = array_shift($this->font_mask);
+                }
+                if (($mask&1)==1) {
+                    array_shift($this->font_color);
+                    $this->_setFontColor($this->font_color[0]);
+                }
+                if (($mask&2)==2) {
+                    array_shift($this->font_size);
+                    $this->SetFontSize($this->font_size[0]);
+                }
+                if (($mask&4)==4) {
+                    array_shift($this->font_face);
+                    $this->_setFontFace($this->font_face[0]);
+                }
+                break;
+            case "DIV":
+                if (sizeof($this->div_x)<1) break;
+                array_shift($this->left_margin);
+                array_shift($this->right_margin);
+                $this->SetLeftMargin($this->left_margin[0]);
+                $this->SetRightMargin($this->right_margin[0]);
+                $this->SetXY($this->div_x[0],$this->div_y[0]);
+                array_shift($this->div_x);
+                array_shift($this->div_y);
+                break;
+            case "MULTICELL":
+                $this->_enforceState(51,50);
+                // auto-create a page if needed.
+                if (!$this->inPage) {
+                    $this->inPage = true;
+                    $this->AddPage();
+                }
+                $this->MultiCell(
+                    $this->cell_info[0],
+                    $this->cell_info[1],
+                    $this->cell_text,
+                    $this->cell_info[3],
+                    $this->cell_info[4],
+                    $this->cell_info[5]);
+                break;
+            case "CELL":
+                $this->_enforceState(51,50);
+                // auto-create a page if needed.
+                if (!$this->inPage) {
+                    $this->inPage = true;
+                    $this->AddPage();
+                }
+                // redo the link logic here. blah.
+                if (sizeof($this->href)>0) {
+                    if ($this->href_style[0]) {
+                        $this->SetTextColor(0,0,255);
+                        $this->_setStyle('U',true, true);
+                    }
+                    $this->Cell(
+                        $this->cell_info[0],
+                        $this->cell_info[2],
+                        $this->cell_text,
+                        $this->cell_info[3],
+                        $this->cell_info[6],
+                        $this->cell_info[4],
+                        $this->cell_info[5],
+                        $this->href[0]);
+                    if ($this->href_style[0]) {
+                        $this->_setStyle('U', $this->U>0, true);
+                        $this->_setFontColor($this->font_color[0]);
+                    }
+                } else {
+                    $this->Cell(
+                        $this->cell_info[0],
+                        $this->cell_info[2],
+                        $this->cell_text,
+                        $this->cell_info[3],
+                        $this->cell_info[6],
+                        $this->cell_info[4],
+                        $this->cell_info[5]);
+                }
+                break;
+            case "ROTATE":
+                $this->rotate(0);
+                break;
+            case "HEADER":
+                $this->_enforceState(63,50);
+                $this->parserBreak='';
+                break;
+            case "FOOTER":
+                $this->_enforceState(64,50);
+                $this->parserBreak='';
+                break;
+            case "COLUMN":
+                $this->_enforceState(50,50);
+                array_shift($this->multicol);
+                array_shift($this->left_margin);
+                array_shift($this->bottom_margin);
+                $this->SetLeftMargin($this->left_margin[0]);
+                $this->SetAutoPageBreak(true, $this->bottom_margin[0]);
+                break;
+        }
+    }
+
+    function _enforceState($from, $to) {
+        if ($this->parserState!=$from) {
+            error_log("unexpected tag (from $from to $to, but state=".$this->parserState.")");
+        //$this->Write("[unexpected tag (from $from to $to)]");
+        }
+        $this->parserState=$to;
+    }
+
+    // default is pt. works good for fonts, so yeah.
+    function _getUnit($str, $max=100) {
+        $str=rtrim($str);
+        $v=(float)$str;
+        if (substr($str,-1)=='%') {
+            return $max * $v / 100;
+        }
+        $u=substr($str,-2);
+        switch ($u) {
+            default:
+            case "pt": $m=1; break;
+            case "mm": $m=72/25.4; break;
+            case "cm": $m=72/2.54; break;
+            case "in": $m=72; break;
+        }
+        return $v * $m;
+    }
+
+    function _getAttrUnit($default, $attr, $name, $ref) {
+        if (isset($attr[$name])) {
+            return $this->_getUnit($attr[$name], $ref);
+        } else {
+            return $default;
+        }
+    }
+
+    function _setStyle($tag, $enable, $forget=0) {
+        $this->$tag+=($enable ? 1: -1);
+        $style='';
+        foreach(array('B','I','U') as $s) {
+            if ($this->$s>0) {
+                $style.=$s;
+            }
+        }
+        $this->SetFont('',$style);
+        if ($forget) {
+            $this->$tag-=($enable ? 1: -1);
+        }
+    }
+
+    function _setFontFace($face) {
+        $style='';
+        foreach(array('B','I','U') as $s) {
+            if ($this->$s>0) {
+                $style.=$s;
+            }
+        }
+        $this->SetFont($face,$style);
+    }
+
+    function _setFontColor($hex) {
+        $this->SetTextColor(
+            hexdec(substr($hex,0,2)),
+            hexdec(substr($hex,2,2)),
+            hexdec(substr($hex,4,2)));
+    }
+
+    function _setLineColor($hex) {
+        $this->SetDrawColor(
+            hexdec(substr($hex,0,2)),
+            hexdec(substr($hex,2,2)),
+            hexdec(substr($hex,4,2)));
+    }
+
+    function _setRectColor($hex) {
+        $this->SetFillColor(
+            hexdec(substr($hex,0,2)),
+            hexdec(substr($hex,2,2)),
+            hexdec(substr($hex,4,2)));
+    }
+
+
+}
+
+
+function ob_pdml($buffer) {
+  $pdml = new PDML('P','pt','A4'); // P and A4 should be customizable. XXX
+  $pdml->compress=0;
+  $pdml->ParsePDML($buffer);
+  $s = $pdml->Output("","S");
+  Header('Content-Type: application/pdf');
+  Header('Content-Length: '.strlen($s));
+  Header('Content-disposition: inline; filename=doc.pdf');
+  return $s;
+}
+
+function pdml_entity_decode( $given_html, $quote_style = ENT_QUOTES ) {
+   $trans_table = array_flip(array_merge(
+     get_html_translation_table( HTML_SPECIALCHARS, $quote_style ),
+     get_html_translation_table( HTML_ENTITIES, $quote_style) ));
+   $trans_table['&#39;'] = "'";
+   return ( strtr( $given_html, $trans_table ) );
+}
+
+
+//ob_start("ob_pdml");
+
+?>


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/pdml.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/xo-info.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/xo-info.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -0,0 +1,31 @@
+<?php
+/**
+ * xoops_opal_PdfMaker bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since       2.3.0
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_PdfMaker
+ * @version		$Id$
+ */
+
+return array(
+	'xoBundleDisplayName' => 'Opal PDF rendering component',
+	'xoBundleIdentifier' => 'xoops_opal_PdfMaker',
+	'xoClassPath' => '/pdfmaker.php',
+	'xoServices' => array(
+		'FPDF' => array(
+			'xoClassPath' => '/fpdf/fpdf.php',
+		),
+		'PDML' => array(
+			'xoClassPath' => '/pdml.php',
+		),
+	),
+);
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/PdfMaker.xoobj/xo-info.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/xo-info.php	2006-02-13 15:41:57 UTC (rev 243)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/xo-info.php	2006-02-16 05:05:19 UTC (rev 244)
@@ -23,6 +23,9 @@
 		'xoops_opal_Theme'	=> array (
 			'xoBundleRoot' => '/Theme.xoobj'
 		),
+		'xoops_opal_PdfMaker'	=> array (
+			'xoBundleRoot' => '/PdfMaker.xoobj'
+		),
 		'xoops_opal_Widget' => array(
 			'xoClassPath' => '/widget.php',
 		),



From skalpa at berlios.de  Thu Feb 16 23:02:06 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Thu, 16 Feb 2006 23:02:06 +0100
Subject: [Xoops4-svn] r245 - XoopsCore/branches/2.2.x
Message-ID: <200602162202.k1GM267g005760@sheep.berlios.de>

Author: skalpa
Date: 2006-02-16 23:02:06 +0100 (Thu, 16 Feb 2006)
New Revision: 245

Added:
   XoopsCore/branches/2.2.x/2.2.5/
Log:
Created a work branch for 2.2.5 development

Copied: XoopsCore/branches/2.2.x/2.2.5 (from rev 244, XoopsCore/branches/2.2.x/2.2-main)



From skalpa at berlios.de  Sun Feb 19 11:36:15 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 11:36:15 +0100
Subject: [Xoops4-svn] r246 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices: . PreferencesHandler.xoobj
Message-ID: <200602191036.k1JAaFCE019193@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 11:36:14 +0100 (Sun, 19 Feb 2006)
New Revision: 246

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/xo-info.php
Log:
Added the new preferences handler meant to manage objects default properties (it allows each individual setting to be host-specific, user-specific or language-specific)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php	2006-02-16 22:02:06 UTC (rev 245)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php	2006-02-19 10:36:14 UTC (rev 246)
@@ -0,0 +1,403 @@
+<?php
+/**
+ * xoops_core_PreferencesHandler main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_core
+ * @subpackage	xoops_core_PreferencesHandler
+ * @version		$Id$
+ */
+
+/**
+ * This file cannot be requested directly
+ */
+if ( !defined( 'XOOPS_PATH' ) ) exit();
+
+XOS::import( 'xoops_db_Accessor' );
+
+
+define( 'XO_PREFS_HOST', 1 );
+define( 'XO_PREFS_BUNDLE', 2 );
+define( 'XO_PREFS_USER', 4 );
+
+define( 'XO_PREFS_ANYHOST', '' );
+define( 'XO_PREFS_ANYUSER', 0 );
+define( 'XO_PREFS_CURRENTHOST', 1 );
+define( 'XO_PREFS_CURRENTUSER', 1 );
+
+/**
+ * XOOPS default preferences handler
+ * 
+ * The preferences system allows you to store custom properties values for XOS objects. These settings will
+ * then be automatically applied to new objects when you instanciate them. Preferences are assigned a scope 
+ * using a combination of username, component ID, host name and language. This mechanism allows you to create
+ * preferences which apply to different domains.
+ * 
+ * For example, using preferences you can save a preference value that applies to:
+ * - The current user on the current host
+ * - All users on a specific host
+ * - The current user on any host, when using a specific language
+ * - Any user on any host, when using a specific language
+ * 
+ * The PreferencesHandler has a high-level API which makes it very simple to store and retrieve components
+ * preferences using the default scope (current user, any host) which is appropriate for the majority of 
+ * situations, as well as a low-level API which allows you to specify the exact scope of the preferences you 
+ * want to manipulate when necessary.
+ * 
+ * NB: Preferences are normally managed automatically by the system, so you should not have to deal with this
+ * class by yourself, unless you are making a {@link xoops_panel_ConfigurationPanel Configuration Panel}.
+ *
+ * @package		xoops_core
+ * @subpackage	xoops_core_PreferencesHandler
+ * @devstatus	unfinished
+ */
+class xoops_core_PreferencesHandler extends xoops_db_Accessor {
+
+	var $tables = array( 'sys_preference' );
+	
+	
+	var $user = false;
+	
+	
+	var $hostName = false;
+
+	var $language = false;
+	
+	var $prefsValues = array();
+
+	/**
+	 * Folder to read managed preferences from
+	 *
+	 * @var string
+	 */
+	var $preferencesFolder = '/XOOPS/Preferences/';
+	
+	/**#@+ @tasktype 10 Initialization*/
+	function xoInit( $options = array() ) {
+		if ( !$this->db ) {
+			$this->db =& XOS::create( 'xoops_db_Database' );
+		}
+		$table = $this->db->prefix( 'sys_preference' );
+		$selectPred = "(`bundleId`='' OR `bundleId`=?) AND (`hostName`='' OR `hostName`=?) AND (`language`='' OR `language`=?)";
+		
+		$this->queries = array(
+			'getPrefs' => "SELECT * FROM `$table` WHERE `userId`=? AND $selectPred ORDER BY `weight`,`language`",
+			'delPrefs' => "DELETE FROM `$table` WHERE `bundleId`=:bundle AND `userId`=:user AND `hostName`=:host",
+			'insertScalar' =>
+				"INSERT INTO `$table` (`weight`,`bundleId`,`userId`,`hostName`,`language`,`propertyName`,`scalarValue`,`complexValue`) " .
+				"VALUES ",
+			'insertComplex' =>
+				"INSERT INTO `$table` (`weight`,`bundleId`,`userId`,`hostName`,`language`,`propertyName`,`scalarValue`,`complexValue`) " .
+				"VALUES ",
+		);
+		return true;
+	}
+	/**#@-*/
+
+	/**#@+ @tasktype 20 Getting preferences values*/
+	/**
+	 * Obtains a preference value for the specified key and object
+	 *
+	 * @param string $key The preference key whose value to obtain
+	 * @param string $bundleId The identifier of the object whose preferences to search
+	 * @return mixed The preference data for the specified key and object. If no value was located, returns null
+	 */
+	function getObjectValue( $key, $bundleId ) {
+		return $this->getValue( $key, $bundleId, XO_PREFS_CURRENTUSER, XO_PREFS_ANYHOST );
+	}
+	/**
+	 * Obtains a preference value for the specified domain
+	 *
+	 * @param string $key The preference key whose value to obtain
+	 * @param string $bundleId The identifier of the object whose preferences to search
+	 * @param integer $userID XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
+	 * @param unknown_type $hostName
+	 */
+	function getValue( $key, $bundleId = '', $userId = XO_PREFS_CURRENTUSER, $hostName = XO_PREFS_ANYHOST ) {
+		$vars =& $this->loadValues( $bundleId, $userId, $hostName );
+		return $vars ? @$vars[$key] : null;
+	}
+	/**
+	 * Convenience function that allows you to obtain multiple preference values
+	 *
+	 * @param string $key An array of preference keys the values of which to obtain
+	 * @param string $bundleId The identifier of the object whose preferences to search
+	 * @param integer $userId XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
+	 * @param unknown_type $hostName
+	 */
+	function getMultiple( $keys = array(), $bundleId = '', $userId = 0, $hostName = '' ) {
+		$ptr =& $this->loadValues( $bundleId, $userId, $hostName );
+		if ( empty($keys) ) {
+			return $ptr;
+		} else {
+			$vars = array();
+			foreach ( $keys as $key ) {
+				if ( isset( $ptr[$key] ) ) {
+					$vars[$key] = $ptr[$key];
+				}
+			}
+			return $vars;
+		}
+	}
+	/**#@-*/
+
+	/**#@+ @tasktype 30 Setting preferences values*/
+	/**
+	 * Adds, modifies, or removes a preference
+	 *
+	 * @param string $key The preference key whose value you wish to set
+	 * @param string $value The value to set for the specified key and object. Pass NULL to remove the specified key from the object?s preferences
+	 * @param string $bundleId The identifier of the object whose preferences you wish to create or modify
+	 * @return mixed The preference data for the specified key and object. If no value was located, returns null
+	 */
+	function setObjectValue( $key, $value, $bundleId, $localized = false ) {
+		return $this->setValue( $key, $value, $bundleId, XO_PREFS_CURRENTUSER, XO_PREFS_ANYHOST );
+	}
+	/**
+	 * Adds, modifies, or removes a preference value for the specified domain
+	 *
+	 * @param string $key The preference key whose value you wish to set
+	 * @param string $value The value to set for the specified key and object. Pass NULL to remove the specified key from the specified domain
+	 * @param integer $userId XO_PREFS_CURRENTUSER if to to modify the current user?s preferences, XO_PREFS_ANYUSER for all users
+	 * @param unknown_type $hostName
+	 */
+	function setValue( $key, $value = null, $bundleId = '', $userId = 0, $hostName = 0, $localized = false ) {
+		$vars =& $this->loadValues( $bundleId, $userId, $hostName );
+		if ( isset($value) ) {
+			$vars[$key] = $value;
+			//$localizedKeys[$bundleId][$hostName] = $localized;
+		} else {
+			unset( $vars[$key] );
+		}
+		return $value;
+	}
+	/**
+	 * Obtains a preference value for the specified domain
+	 *
+	 * @param string $key An array of preference keys the values of which to obtain
+	 * @param string $bundleId The identifier of the object whose preferences to search
+	 * @param integer $userId XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
+	 * @param unknown_type $hostName
+	 */
+	function setMultiple( $values = array(), $bundleId = '', $userId = 0, $hostName = '', $localized = array() ) {
+		$vars =& $this->loadValues( $bundleId, $userId, $hostName );
+		if ( $vars ) {
+			foreach ( $values as $key => $value ) {
+				if ( isset($value) ) {
+					$vars[$key] = $value;
+					//$localizedKeys[$bundleId][$hostName] = $localized;
+				} else {
+					unset( $vars[$key] );
+				}
+			}
+			return true;
+		}
+		return false;
+	}
+	/**#@-*/
+
+	/**#@+ @tasktype 40 Saving preferences to persistent storage*/
+	/**
+	 * Writes to permanent storage all pending changes to the preference data for the specified object
+	 *
+	 * @param string $bundleId The ID of the object whose preferences to write to storage
+	 */
+	function synchronizeObject( $bundleId ) {
+		return $this->synchronize( $bundleId, XO_PREFS_CURRENTUSER, XO_PREFS_ANYHOST );
+	}
+	/**
+	 * Writes to permanent storage all pending changes to the preference data for the specified object and domain
+	 *
+	 * @param string $bundleId The ID of the object whose preferences to write to storage
+	 * @param integer $userId XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
+	 * @param unknown_type $hostName
+	 */
+	function synchronize( $bundleId, $userId = 0, $hostName = '' ) {
+		$this->updateDatabaseValues( $bundleId, $userId, $hostName );
+		//return $this->synchronize( $bundleId, XO_PREFS_CURRENTUSER, XO_PREFS_ANYHOST );
+	}
+	/**#@-*/
+	/**#@+ @tasktype 50 Miscellaneous functions*/
+	function objectValueIsForced( $key, $bundleId, $hostName = '' ) {
+		$vars =& $this->loadValues( $bundleId, 0, $hostName );
+		if ( $vars ) {
+			return in_array( $key, $this->managedKeys[$bundleId][$hostName] );
+		}
+		return false;
+	}
+	
+	function &loadValues( $bundleId = '', $userId = 0, $hostName = '' ) {
+		global $xoops;
+
+		$this->calculateDomainWeight( $bundleId, $userId, $hostName );
+		$varsPointer = false;
+
+		if ( !$userId ) {
+			if ( !isset( $this->globalPrefs[$bundleId][$hostName] ) ) {
+				$vars = $this->loadPersistentValues( $bundleId, $hostName );
+				if ( !isset( $this->globalPrefs[$bundleId][''] ) ) {
+					$this->globalPrefs[$bundleId][''] = $vars[0][''];
+					$this->managedKeys[$bundleId][''] = $vars[1][''];
+				}
+				if ( !isset( $this->globalPrefs[$bundleId][$hostName] ) ) {
+					$this->globalPrefs[$bundleId][$hostName] = $vars[0][$hostName];
+					$this->managedKeys[$bundleId][$hostName] = $vars[1][$hostName];
+				}
+				$vars = $this->loadDatabaseValues( $bundleId, 0, $hostName );
+				foreach ( $vars as $key => $value ) {
+					if ( !in_array( $key, $this->managedKeys[$bundleId][$hostName] ) ) {
+						$this->globalPrefs[$bundleId][$hostName][$key] = $value;
+					}
+				}
+			}
+			$varsPointer =& $this->globalPrefs[$bundleId][$hostName];
+		} else {
+			if ( !isset( $this->userPrefs[$bundleId][$hostName] ) ) {
+				$this->userPrefs[$bundleId][$hostName] = array();
+				$vars = $this->loadDatabaseValues( $bundleId, $userId, $hostName );
+				foreach ( $vars as $key => $value ) {
+					$this->userPrefs[$bundleId][$hostName][$key] = $value;
+				}
+			}
+			$varsPointer =& $this->userPrefs[$bundleId][$hostName];
+		}
+		return $varsPointer;
+	}
+
+	/**
+	 * Read all the keys of the specified domain from the database
+	 *
+	 * @param unknown_type $bundleId
+	 * @param unknown_type $userId
+	 * @param unknown_type $host
+	 * @return unknown
+	 * @access protected
+	 */
+	function loadDatabaseValues( $bundleId = '', $userId = 0, $host = '' ) {
+		global $xoops;
+		
+		$this->calculateDomainWeight( $bundleId, $userId, $host );
+		
+		$rows = $this->fetchAll( 'getPrefs', array( $userId, $bundleId, $host, '' ) );
+		$values = array();
+		foreach ( $rows as $row ) {
+			$values[ $row['propertyName'] ] = isset( $row['complexValue'] ) ? unserialize( $row['complexValue'] ) : $row['scalarValue'];
+		}
+		return $values;		
+	}
+	
+	function calculateDomainWeight( &$bundleId, &$userId, &$hostName ) {
+		global $xoops;
+		$weight = 0;
+		if ( !empty( $bundleId ) ) {
+			$weight += XO_PREFS_BUNDLE;
+		} else {
+			$bundleId = '';
+		}
+		if ( $userId == XO_PREFS_CURRENTUSER ) {
+			$userId = $xoops->currentUser->userId;
+			$weight += XO_PREFS_USER;
+		} else {
+			$userId = 0;
+		}
+		if ( !empty( $hostName ) ) { 
+			$hostName = $xoops->hostId;
+			$weight += XO_PREFS_HOST;
+		} else {
+			$hostName = XO_PREFS_ANYHOST;
+		}
+		return $weight;
+	}
+	
+	
+	function updateDatabaseValues( $bundleId = '', $userId = 0, $hostName = '' ) {
+		$weight = $this->calculateDomainWeight( $bundleId, $userId, $hostName );
+		
+		if ( !isset( $this->globalPrefs[$bundleId][$hostName] ) ) {
+			trigger_error( "Cannot update preferences that have not been loaded", E_USER_NOTICE );
+			return false;
+		}
+		// First, delete all the rows corresponding to the specified domain
+		$count = $this->exec( 'delPrefs', array( ':bundle' => $bundleId, ':user' => $userId, ':host' => $hostName ) );
+
+		$vars =& $this->globalPrefs[$bundleId][$hostName];
+		$params = array( ':bundle' => $bundleId, ':user' => $userId, ':host' => $hostName, ':language' => '');
+		$params = array_map( array( &$this->db, 'quote' ), $params );
+		$scalarValues = array();
+		$complexValues = array();
+		$valString = '(' . $weight . ',' . implode( ',', $params );
+		
+		foreach ( $vars as $prop => $val ) {
+			$prop = $this->db->quote( $prop );
+			if ( ( is_string( $val ) && strlen( $val ) > 255 ) || is_array( $val ) ) {
+				$complexValues[] = "$valString,$prop,''," . $this->db->quote( serialize( $val ) ) . ')';
+			} else {
+				$scalarValues[] = "$valString,$prop," . $this->db->quote($val) . ",NULL)";
+			}
+		}
+		if ( !empty( $scalarValues ) ) {
+			$this->db->exec( $this->queries['insertScalar'] . implode( ",", $scalarValues ) );
+		}
+		if ( !empty( $complexValues ) ) {
+			$this->db->exec( $this->queries['insertComplex'] . implode( ",", $complexValues ) );
+		}
+	}
+	/**
+	 * Read persistent preferences definition
+	 *
+	 * @param unknown_type $bundleId
+	 * @param unknown_type $hostName
+	 * @access protected
+	 */	
+	function loadPersistentValues( $bundleId = '', $host = '' ) {
+		global $xoops;
+		if ( $bundleId && !XOS::import( $bundleId ) ) {
+			trigger_error( "Cannot load persistant preferences of unknown type $bundleId", E_USER_WARNING );
+			return false;
+		}
+		$dummy = 0;
+		$this->calculateDomainWeight( $bundleId, $dummy, $host );
+		
+		
+		$managed = $vars = array( '' => array() );
+
+		if ( $bundleId && class_exists( $bundleId ) ) {
+			$vars[''] = array_merge( $vars[''], get_class_vars( $bundleId ) );
+		}
+		if ( !$bundleId ) {
+			$bundleId = 'global';
+		}
+		if ( $fromfile = @include $xoops->path( "/XOOPS/Preferences/$bundleId.php" ) ) {
+			if ( !is_array( $fromfile ) ) {
+				trigger_error( "Managed preferences file for $bundleId is corrupt", E_USER_WARNING );
+			} else {
+				$managed[''] = array_merge( $managed[''], array_keys( $fromfile ) );
+				$vars[''] = array_merge( $vars[''], $fromfile );
+			}
+		}
+		if ( $host ) {
+			$managed[$host] = $managed[''];
+			$vars[$host] = $vars[''];
+			if ( $fromfile = @include $xoops->path( "/XOOPS/Preferences/ByHost/$host-$bundleId.php" ) ) {
+				if ( !is_array( $fromfile ) ) {
+					trigger_error( "Managed preferences file for $bundleId is corrupt", E_USER_WARNING );
+				} else {
+					$managed[$host] = array_merge( $managed[$host], array_keys( $fromfile ) );
+					$vars[$host] = array_merge( $vars[$host], $fromfile );
+				}
+			}
+		}
+		return array( $vars, $managed );
+	}
+	/**#@-*/
+
+}
+
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/xo-info.php	2006-02-16 22:02:06 UTC (rev 245)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/xo-info.php	2006-02-19 10:36:14 UTC (rev 246)
@@ -0,0 +1,23 @@
+<?php
+/**
+* xoops_core_PreferencesHandler bundle information file
+*
+* See the enclosed file LICENSE for licensing information.
+* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+*
+* @copyright	The XOOPS project http://www.xoops.org/
+* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+* @author		Skalpa Keo <skalpa at xoops.org>
+* @since		2.3.0
+* @package		xoops_core
+* @subpackage	xoops_core_PreferencesHandler
+* @version		$Id$
+*/
+
+return array(
+	'xoBundleDisplayName'			=> 'XOOPS foundation preferences handler',
+	'xoBundleIdentifier'			=> 'xoops_core_PreferencesHandler',
+	'xoClassPath' => '/preferences.php',
+);
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/xo-info.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Sun Feb 19 19:49:08 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 19:49:08 +0100
Subject: [Xoops4-svn] r247 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm
Message-ID: <200602191849.k1JIn8ro032511@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 19:48:56 +0100 (Sun, 19 Feb 2006)
New Revision: 247

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php
Log:
Minor fixes to the db classes (added a missing PDO method, fixed a notice...)

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php	2006-02-19 10:36:14 UTC (rev 246)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/database.php	2006-02-19 18:48:56 UTC (rev 247)
@@ -105,7 +105,7 @@
 			$options['dsn'] = 'system';
 		}
 		if ( isset( $this->instances[ $options['dsn'] ] ) ) {
-			return $this->instances[ $options['dsn'] ];
+			//return $this->instances[ $options['dsn'] ];
 		}
 		$inst = false;
 		$parsed = explode( ':', $dsn = $options['dsn'], 2 );
@@ -136,6 +136,7 @@
 			$inst =& XOS::create( "xoops_db_Database_{$options['driverName']}", $options );
 			$this->instances[$dsn] =& $inst;
 		}
+
 		return $inst;
 	}
 }
@@ -203,7 +204,7 @@
 		global $xoops;
 
 		$this->allowWebChanges = ( $_SERVER['REQUEST_METHOD'] != 'GET' );
-		if ( $xoops->services['logger'] ) {
+		if ( @$xoops->services['logger'] ) {
 			$this->logger =& $xoops->services['logger'];
 		}
 		if ( $this->autoConnect ) {

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php	2006-02-19 10:36:14 UTC (rev 246)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/mysql.php	2006-02-19 18:48:56 UTC (rev 247)
@@ -167,6 +167,7 @@
 	 */
 	function exec( $statement ) {
 		if ( $this->allowWebChanges ) {
+			$this->logEvent( "SQL: $statement" );
 			return mysql_query( $statement, $this->conn ) ? mysql_affected_rows( $this->conn ) : false;
 		} else {
 			trigger_error( 'Database updates are not allowed during processing of a GET request', E_USER_WARNING );
@@ -249,6 +250,10 @@
 	var $query = '';
 	var $preparedQuery = '';
 
+	/**
+	 * Database connection used by this statement
+	 * @var xoops_db_Database
+	 */	
 	var $db = false;
 	var $result = false;
 	
@@ -336,7 +341,7 @@
 	 * Closes the cursor, enabling the statement to be executed again
 	 */	
 	function closeCursor() {
-		if ( $this->result ) {
+		if ( $this->result && is_resource( $this->result ) ) {
 			mysql_free_result( $this->result );
 			$this->result = false;
 		}
@@ -431,7 +436,11 @@
 		return $rows;
 	}
 	
+	function rowCount() {
+		return mysql_affected_rows( $this->db->conn );
+	}
 	
+	
 	/**
 	 * Cast a variable according to a PDO_PARAM_* type
 	 *



From skalpa at berlios.de  Sun Feb 19 19:50:39 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 19:50:39 +0100
Subject: [Xoops4-svn] r248 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm
Message-ID: <200602191850.k1JIodb2000098@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 19:50:34 +0100 (Sun, 19 Feb 2006)
New Revision: 248

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/accessor.php
Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php
Log:
Added xoops_db_Accessor (a new helper base class for db access components)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/accessor.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/accessor.php	2006-02-19 18:48:56 UTC (rev 247)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/accessor.php	2006-02-19 18:50:34 UTC (rev 248)
@@ -0,0 +1,209 @@
+<?php
+/**
+ * xoops_db_Accessor main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_db
+ * @subpackage	xoops_db_Accessor
+ * @version		$Id$
+ * @devstatus	unstable
+ */
+
+XOS::import( 'xoops_db_Database' );
+
+/**
+ * Database accessor component
+ * 
+ * This class provides a standard interface for database accessors (objects meant to perform a
+ * defined set of statements).
+ * 
+ * It may be extended as-is (by low-level components like the tree or preferences management
+ * classes), but XOOPS will provide modules developers with higher-level data access mechanisms
+ * for retrieving/storing model entities in the future.
+ */
+class xoops_db_Accessor {
+	/**
+	 * The database connection that will be used to perform statements
+	 * @var xoops_db_Database
+	 */
+	var $db = false;
+	/**
+	 * List of tables this object will access
+	 * 
+	 * This property contains the accessed tables names in a <var>realname</var> => <var>prefixedname</var>
+	 * hash. If it originally contains a regular array upon instanciation, the initialization routine will
+	 * take care of generating the hash automatically.
+	 * <code>
+	 * $db =& XOS::create( 'xoops_db_Database', array( 'prefix' => 'tmp' ) );
+	 * $accessor = XOS::create( 'xoops_db_Accessor', array(
+	 *     'tables' => array( 'stuff', 'thing' ),
+	 * ) );
+	 * var_export( $accessor->tables );
+	 * // Outputs:
+	 * // array(
+	 * //     'stuff' => 'tmp_stuff',
+	 * //     'thing' => 'tmp_thing',
+	 * // )
+	 * </code>
+	 * @var xoops_db_Statement[]
+	 */
+	var $tables = array();
+	/**
+	 * List of statements this object can perform (indexed by name)
+	 * 
+	 * <var>$queries</var> contains this accessor statements. Each entry can be either a string
+	 * containing a valid SQL statement, or a {@link xoops_db_Statement} instance. When
+	 * this accessor will be asked to execute a string statement for the first time, it will
+	 * automatically replace the corresponding entry in this array with a statement object instance.
+	 * @var array
+	 */
+	var $queries = array();
+	
+	/**#@+ @tasktype 10 Initialization*/
+	/**
+	 * Initializes the accessor instance
+	 */
+	function xoInit( $options = array() ) {
+		// If no db specified, automatically connect to the system db
+		if ( !$this->db ) {
+			$this->db =& XOS::create( 'xoops_db_Database' );
+		}
+		if ( isset( $this->tables[0] ) ) {
+			$this->tables = array_combine( $this->tables, array_map( array( &$this->db, 'prefix' ), $this->tables ) );
+		}
+		return true;
+	}
+	/**#@-*/
+	
+
+	/**
+	 * Prepares the specified statement if the $queries entry is not already a statement instance
+	 * @param string $name Name of the statement to prepare
+	 * @return bool
+	 */
+	function prepareStatement( $name, $params = array() ) {
+		static $patterns = null;
+
+		if ( !@$this->queries[$name] ) {
+			trigger_error( "Cannot execute unknown/invalid query $name", E_USER_WARNING );
+			return false;
+		}
+		if ( !is_object( $this->queries[$name] ) ) {
+			if ( !isset( $patterns ) ) {
+				$patterns = array();
+				// Replace the real table names with their prefixed equivalent
+				foreach ( $this->tables as $k => $v ) {
+					$patterns[] = '{' . $k . '}';
+				}
+			}
+			$this->queries[$name] = $this->db->prepare( str_replace( $patterns, $this->tables, $this->queries[$name] ) );
+		}
+		if ( !empty( $params ) ) {
+			if ( isset( $this->parameters[$name] ) ) {
+				foreach ( $params as $k => $v ) {
+					$this->queries[$name]->bindValue( is_int($k)?($k+1):$k, $v, $this->parameters[$name][$k] );
+				}
+			} else {
+				foreach ( $params as $k => $v ) {
+					$this->queries[$name]->bindValue( is_int($k)?($k+1):$k, $v );
+				}
+			}
+		}
+		return true;
+	}
+
+	/**
+	 * Executes the specified statement and returns the number of affected rows
+	 * 
+	 * exec() returns the number of rows that were modified or deleted by the 
+	 * statement you issued. If no rows were affected, it returns 0.
+	 * 
+	 * @param string $name The name of the SQL statement to prepare and execute
+	 * @param array $params Values to bind to the statement parameters before execution
+	 * @see http://fr3.php.net/manual/en/function.PDO-exec.php PDO::exec()
+	 */
+	function exec( $name, $params = array() ) {
+		if ( $this->prepareStatement( $name, $params ) ) {
+			if ( $this->queries[$name]->execute() ) {
+				$this->queries[$name]->closeCursor();
+				return $this->queries[$name]->rowCount();
+			}
+		}
+		return false;
+	}
+	/**
+	 * Executes the specified statement and returns all the rows of the result set
+	 * 
+	 * fetchAll() is a convenience function that encapsulates the statement preparation,
+	 * parameters binding, execution and result retrieval.
+	 * 
+	 * @param string $name The name of the SQL statement to prepare and execute
+	 * @param array $params Values to bind to the statement parameters before execution
+	 * @param int $fetchMode Controls the contents of the returned array. Defaults to PDO::FETCH_BOTH. 
+	 * @see http://www.php.net/manual/en/function.pdostatement-fetch.php PDOStatement::fetch()
+	 */
+	function fetchAll( $name, $params = array(), $fetchMode = PDO_FETCH_ASSOC ) {
+		if ( $this->prepareStatement( $name, $params ) ) {
+			if ( $this->queries[$name]->execute() ) {
+				$res = $this->queries[$name]->fetchAll( $fetchMode );
+				$this->queries[$name]->closeCursor();
+				return $res;
+			}
+		}
+		return false;
+	}
+	
+	
+	function execQuery( $name, $params = array(), $fetchMode = PDO_FETCH_ASSOC ) {
+		if ( !$this->createStatement( $name ) ) {
+			return false;
+		}
+		$this->bindValues( $name, $params );
+		
+		$this->queries[$name]->execute();
+		if ( $rows = $this->queries[$name]->fetchAll( $fetchMode ) ) {
+			$this->queries[$name]->closeCursor();
+		}
+		return $rows;
+	}
+
+	
+	
+	
+	
+	
+}
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/accessor.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php	2006-02-19 18:48:56 UTC (rev 247)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Database.xofrm/xo-info.php	2006-02-19 18:50:34 UTC (rev 248)
@@ -38,6 +38,10 @@
 			'xoBundleDisplayName' => 'XOOPS Legacy (XOOPS 2.0) database driver',
 			'xoClassPath' => '/legacy.php',
 		),
+		'xoops_db_Accessor' => array(
+			'xoBundleDisplayName' => 'XOOPS database accessor',
+			'xoClassPath' => '/accessor.php',
+		),
 	),
 );
 



From skalpa at berlios.de  Sun Feb 19 19:51:25 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 19:51:25 +0100
Subject: [Xoops4-svn] r249 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj
Message-ID: <200602191851.k1JIpPZk000382@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 19:51:22 +0100 (Sun, 19 Feb 2006)
New Revision: 249

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php
Log:
Documentation enhancements

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php	2006-02-19 18:50:34 UTC (rev 248)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/Http.xofrm/http.xoobj/http.php	2006-02-19 18:51:22 UTC (rev 249)
@@ -32,15 +32,17 @@
 class xoops_http_HttpHandler {
 	/**
 	 * Whether HTTP redirections are enabled or not
-	 * @var bool
+	 * @var boolean
 	 */
 	var $enableRedirections	= true;
 	/**
 	 * Whether to use output compression or not, if the client supports it
+	 * @var boolean
 	 */
 	var $enableCompression = true;
 	/**
 	 * Whether to use output compression or not, if the client supports it
+	 * @var integer
 	 */
 	var $compressionLevel = 6;
 	/**
@@ -55,6 +57,7 @@
 	var $cacheLifetime = 3600;
 	/**
 	 * Entity mimetype
+	 * @var string
 	 */
 	var $contentType = 'text/html';
 	/**



From skalpa at berlios.de  Sun Feb 19 19:52:15 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 19:52:15 +0100
Subject: [Xoops4-svn] r250 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj
Message-ID: <200602191852.k1JIqFvD000598@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 19:52:11 +0100 (Sun, 19 Feb 2006)
New Revision: 250

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php
Log:
Documentation enhancements

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php	2006-02-19 18:51:22 UTC (rev 249)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/CoreServices/PreferencesHandler.xoobj/preferences.php	2006-02-19 18:52:11 UTC (rev 250)
@@ -58,26 +58,24 @@
  * @devstatus	unfinished
  */
 class xoops_core_PreferencesHandler extends xoops_db_Accessor {
-
+	/**
+	 * Name of the table storing preferences
+	 * @var array
+	 */	
 	var $tables = array( 'sys_preference' );
-	
-	
-	var $user = false;
-	
-	
-	var $hostName = false;
-
-	var $language = false;
-	
-	var $prefsValues = array();
-
 	/**
-	 * Folder to read managed preferences from
-	 *
+	 * Path to the folder that stores managed preferences
 	 * @var string
 	 */
 	var $preferencesFolder = '/XOOPS/Preferences/';
 	
+	/**
+	 * Local cache for preferences values
+	 * @var array
+	 * @access protected
+	 */
+	var $prefsValues = array();
+	
 	/**#@+ @tasktype 10 Initialization*/
 	function xoInit( $options = array() ) {
 		if ( !$this->db ) {
@@ -116,8 +114,8 @@
 	 *
 	 * @param string $key The preference key whose value to obtain
 	 * @param string $bundleId The identifier of the object whose preferences to search
-	 * @param integer $userID XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
-	 * @param unknown_type $hostName
+	 * @param integer $userId XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
+	 * @param string $hostName XO_PREFS_CURRENTHOST if to search the current-host domain, otherwise XO_PREFS_ANYHOST
 	 */
 	function getValue( $key, $bundleId = '', $userId = XO_PREFS_CURRENTUSER, $hostName = XO_PREFS_ANYHOST ) {
 		$vars =& $this->loadValues( $bundleId, $userId, $hostName );
@@ -129,7 +127,7 @@
 	 * @param string $key An array of preference keys the values of which to obtain
 	 * @param string $bundleId The identifier of the object whose preferences to search
 	 * @param integer $userId XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
-	 * @param unknown_type $hostName
+	 * @param string $hostName XO_PREFS_CURRENTHOST if to search the current-host domain, otherwise XO_PREFS_ANYHOST
 	 */
 	function getMultiple( $keys = array(), $bundleId = '', $userId = 0, $hostName = '' ) {
 		$ptr =& $this->loadValues( $bundleId, $userId, $hostName );
@@ -165,7 +163,8 @@
 	 * @param string $key The preference key whose value you wish to set
 	 * @param string $value The value to set for the specified key and object. Pass NULL to remove the specified key from the specified domain
 	 * @param integer $userId XO_PREFS_CURRENTUSER if to to modify the current user?s preferences, XO_PREFS_ANYUSER for all users
-	 * @param unknown_type $hostName
+	 * @param string $hostName XO_PREFS_CURRENTHOST if to to modify the current host preferences, XO_PREFS_ANYHOST for all hosts
+	 * @param boolean $localized If the preference to modify is language-dependent
 	 */
 	function setValue( $key, $value = null, $bundleId = '', $userId = 0, $hostName = 0, $localized = false ) {
 		$vars =& $this->loadValues( $bundleId, $userId, $hostName );
@@ -183,7 +182,8 @@
 	 * @param string $key An array of preference keys the values of which to obtain
 	 * @param string $bundleId The identifier of the object whose preferences to search
 	 * @param integer $userId XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
-	 * @param unknown_type $hostName
+	 * @param string $hostName XO_PREFS_CURRENTHOST if to to modify the current host preferences, XO_PREFS_ANYHOST for all hosts
+	 * @param array $localized Array containing the names of the language-dependent keys
 	 */
 	function setMultiple( $values = array(), $bundleId = '', $userId = 0, $hostName = '', $localized = array() ) {
 		$vars =& $this->loadValues( $bundleId, $userId, $hostName );
@@ -215,8 +215,8 @@
 	 * Writes to permanent storage all pending changes to the preference data for the specified object and domain
 	 *
 	 * @param string $bundleId The ID of the object whose preferences to write to storage
-	 * @param integer $userId XO_PREFS_CURRENTUSER if to search the current-user domain, otherwise XO_PREFS_ANYUSER
-	 * @param unknown_type $hostName
+	 * @param integer $userId XO_PREFS_CURRENTUSER if to save the current-user preferences, otherwise XO_PREFS_ANYUSER
+	 * @param string $hostName XO_PREFS_CURRENTHOST if to to save the current host preferences, XO_PREFS_ANYHOST for all hosts
 	 */
 	function synchronize( $bundleId, $userId = 0, $hostName = '' ) {
 		$this->updateDatabaseValues( $bundleId, $userId, $hostName );
@@ -224,6 +224,14 @@
 	}
 	/**#@-*/
 	/**#@+ @tasktype 50 Miscellaneous functions*/
+	/**
+	 * Indicated if a preference value is managed or not
+	 *
+	 * @param string $key Name of the value to check
+	 * @param string $bundleId The ID of the object whose preferences to write to storage
+	 * @param string $hostName XO_PREFS_CURRENTHOST if to to save the current host preferences, XO_PREFS_ANYHOST for all hosts
+	 * @return boolean True if this key is managed (read-only) false otherwise
+	 */
 	function objectValueIsForced( $key, $bundleId, $hostName = '' ) {
 		$vars =& $this->loadValues( $bundleId, 0, $hostName );
 		if ( $vars ) {
@@ -231,7 +239,10 @@
 		}
 		return false;
 	}
-	
+	/**
+	 * Retrieve the preferences for the specified domain
+	 * @access protected
+	 */
 	function &loadValues( $bundleId = '', $userId = 0, $hostName = '' ) {
 		global $xoops;
 
@@ -269,29 +280,11 @@
 		}
 		return $varsPointer;
 	}
-
 	/**
-	 * Read all the keys of the specified domain from the database
-	 *
-	 * @param unknown_type $bundleId
-	 * @param unknown_type $userId
-	 * @param unknown_type $host
-	 * @return unknown
+	 * Calculates a domain weight, and normalize its userId and hostName components
+	 * @return integer
 	 * @access protected
-	 */
-	function loadDatabaseValues( $bundleId = '', $userId = 0, $host = '' ) {
-		global $xoops;
-		
-		$this->calculateDomainWeight( $bundleId, $userId, $host );
-		
-		$rows = $this->fetchAll( 'getPrefs', array( $userId, $bundleId, $host, '' ) );
-		$values = array();
-		foreach ( $rows as $row ) {
-			$values[ $row['propertyName'] ] = isset( $row['complexValue'] ) ? unserialize( $row['complexValue'] ) : $row['scalarValue'];
-		}
-		return $values;		
-	}
-	
+	 */	
 	function calculateDomainWeight( &$bundleId, &$userId, &$hostName ) {
 		global $xoops;
 		$weight = 0;
@@ -314,8 +307,26 @@
 		}
 		return $weight;
 	}
-	
-	
+	/**
+	 * Retrieve the preferences for the specified domain from the database
+	 * @access protected
+	 */
+	function loadDatabaseValues( $bundleId = '', $userId = 0, $host = '' ) {
+		global $xoops;
+		
+		$this->calculateDomainWeight( $bundleId, $userId, $host );
+		
+		$rows = $this->fetchAll( 'getPrefs', array( $userId, $bundleId, $host, '' ) );
+		$values = array();
+		foreach ( $rows as $row ) {
+			$values[ $row['propertyName'] ] = isset( $row['complexValue'] ) ? unserialize( $row['complexValue'] ) : $row['scalarValue'];
+		}
+		return $values;		
+	}
+	/**
+	 * Store the preferences for the specified domain to the database
+	 * @access protected
+	 */
 	function updateDatabaseValues( $bundleId = '', $userId = 0, $hostName = '' ) {
 		$weight = $this->calculateDomainWeight( $bundleId, $userId, $hostName );
 		
@@ -349,12 +360,9 @@
 		}
 	}
 	/**
-	 * Read persistent preferences definition
-	 *
-	 * @param unknown_type $bundleId
-	 * @param unknown_type $hostName
+	 * Retrieve the managed preferences for the specified domain from the filesystem
 	 * @access protected
-	 */	
+	 */
 	function loadPersistentValues( $bundleId = '', $host = '' ) {
 		global $xoops;
 		if ( $bundleId && !XOS::import( $bundleId ) ) {



From skalpa at berlios.de  Sun Feb 19 19:53:28 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 19:53:28 +0100
Subject: [Xoops4-svn] r251 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore: . AppServices AppServices/PageController.xoobj
Message-ID: <200602191853.k1JIrSHb000930@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 19:53:19 +0100 (Sun, 19 Feb 2006)
New Revision: 251

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/controller.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/xo-info.php
Log:
Added xoops_app_PageController (the base class for page controllers)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/controller.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/controller.php	2006-02-19 18:52:11 UTC (rev 250)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/controller.php	2006-02-19 18:53:19 UTC (rev 251)
@@ -0,0 +1,166 @@
+<?php
+/**
+ * xoops_app_PageController main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_app
+ * @subpackage	xoops_app_PageController
+ * @version		$Id$
+ */
+
+/**
+ * Base class for page controllers
+ * 
+ * The page controller receives a page request, extracts any relevant data,
+ * invokes any updates to the model, and if necessary forwards the request to the view.
+ * @package		xoops_app
+ * @subpackage	xoops_app_PageController
+ */
+class xoops_app_PageController {
+	/**
+	 * Associative array containing the request parameters. If uninitialized, $_REQUEST will be used
+	 * @var array
+	 */
+	var $request = false;
+	/**
+	 * If the specified $request array is concerned by get_magic_quotes_gpc()
+	 * @var boolean
+	 */
+	var $requestIsGpc = false;
+	/**
+	 * Current request method (defaults to $_SERVER['REQUEST_METHOD'] )
+	 *
+	 * @var string
+	 */
+	var $requestMethod = '';
+	/**
+	 * Current request URI (defaults to $_SERVER['REQUEST_URI'] )
+	 *
+	 * @var string
+	 */
+	var $requestUri = '';
+	/**
+	 * Parameters definition
+	 *
+	 * @var array
+	 */
+	var $parametersDef = array();
+
+	
+	/**
+	* This controller views as 'template/path' or '[virtual/path]'
+	*/
+	var $views = array();
+	/**
+	* Current view
+	*/
+	var $currentView = '';
+	var $viewVars = array();
+	/**
+	 * Next page to show if this controller processing has been successful
+	 * @var string
+	 */
+	var $successLocation = '';
+	/**
+	 * Page to display by default when an error is encountered
+	 * @var string
+	 */
+	var $errorLocation = '';
+	/**
+	 * Response code to send upon request processing (status, msg, location)
+	 * @var array
+	 */
+	var $responseCode = array( 200, '', false );
+
+ 	function xoInit( $options = array() ) {
+		global $xoops;
+
+		if ( !is_array($this->request) ) {
+		 	$this->request = $_REQUEST;
+		 	$this->requestIsGpc = true;
+		}
+		if ( empty( $this->requestMethod ) ) {
+			$this->requestMethod = $_SERVER['REQUEST_METHOD'];
+		}
+		if ( empty( $this->requestUri ) ) {
+			$this->requestUri = $_SERVER['REQUEST_URI'];
+		}
+ 		return true;
+	}
+
+	/**
+	 * Reads request parameters, sanitizing and checking values
+	 * @return boolean Whether or not the request parameters seem OK
+	 */
+	function readRequest() {
+		$this->cleanRequest();
+		return $this->checkRequest();
+	}
+	
+	/**
+	 * Clean-up the request parameters
+	 */
+	function cleanRequest() {
+		if ( $this->requestIsGpc && get_magic_quotes_gpc() ) {
+			$this->request = array_map( 'stripslashes', $this->request );
+		}
+		if ( !empty($this->parametersDef) ) {
+			$this->request = xoops_kernel_Module::requestValues( $this->parametersDef, $this->request );
+		}
+	}
+	/**
+	 * Check request parameters
+	 * @return boolean
+	 */
+	function checkRequest() {
+		return true;
+	}
+	/**
+	 * Perform actions according to the request
+	 */
+	function process() {
+		return true;
+	}
+
+	function sendResponse() {
+		global $xoops;
+
+		$xoops->services['http']->sendResponse( $this->responseCode );		
+		if ( !empty( $this->currentView ) ) {
+			$this->viewVars['xoController'] =& $this;
+			$theme =& $xoops->loadService( 'theme' );
+			$theme->render( null, null, $this->views[ $this->currentView ], $this->viewVars );
+		}
+		return $this->responseCode;
+	}
+
+	function mergeUrl( $url, $vars = array(), $asArray = false ) {
+		if ( !is_array( $url ) ) {
+			$url = parse_url( $url );
+		}
+		if ( isset($url['query']) ) {
+			$args=array();
+			parse_str( $url['query'], $args );
+			if ( !empty($args) ) {
+				$vars = array_merge( $args, $vars );
+			}
+		}
+		if ( !$asArray ) {
+			foreach ($vars as $k=>$v) {
+				$vars[$k] = rawurlencode($k) . '=' . rawurlencode($v);
+			}
+			$vars = implode( '&', $vars );
+			$vars = $url['path'] . (empty($vars)?'':('?'.$vars));
+		}
+		return $vars;
+	}
+
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/controller.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/xo-info.php	2006-02-19 18:52:11 UTC (rev 250)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/xo-info.php	2006-02-19 18:53:19 UTC (rev 251)
@@ -0,0 +1,23 @@
+<?php
+/**
+ * xoops_app_PageController bundle information file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright	The XOOPS project http://www.xoops.org/
+ * @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @since		2.3.0
+ * @package		xoops_app
+ * @subpackage	xoops_app_PageController
+ * @version		$Id$
+ */
+
+return array(
+	'xoBundleDisplayName'			=> 'XOOPS page controller',
+	'xoBundleIdentifier'			=> 'xoops_app_PageController',
+	'xoClassPath' => '/controller.php',
+);
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/AppServices/PageController.xoobj/xo-info.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Sun Feb 19 19:56:49 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 19:56:49 +0100
Subject: [Xoops4-svn] r252 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins
Message-ID: <200602191856.k1JIuna7001918@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 19:56:43 +0100 (Sun, 19 Feb 2006)
New Revision: 252

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.foreachq.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.includeq.php
Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoImgUrl.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
Log:
Enhanced the XOOPS smarty plug-ins documentation, and added 2 new compiler plug-ins: foreachq and includeq (they do the same as the Smarty foreach and include functions, but generate more optimized code)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.foreachq.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.foreachq.php	2006-02-19 18:53:19 UTC (rev 251)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.foreachq.php	2006-02-19 18:56:43 UTC (rev 252)
@@ -0,0 +1,104 @@
+<?php
+/**
+ * foreachq Smarty compiler plug-in
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
+ * @since       2.3.0
+ * @version		$Id$
+ */
+
+/**
+ * Quick foreach template plug-in
+ *
+ * This plug-in works as a direct replacement for the original Smarty
+ * {@link http://smarty.php.net/manual/en/language.function.foreach.php foreach} function.
+ * 
+ * The difference with <var>foreach</var> is minimal in terms of functionality, but can boost your templates
+ * a lot: foreach duplicates the content of the variable that is iterated, to ensure non-array
+ * variables can be specified freely. This implementation does not do that, but as a consequence
+ * requires that the variable you specify in the <var>from</var> parameter is an array or
+ * (when using PHP5) an object. Check the difference between the code generated by foreach
+ * and foreachq to understand completely.
+ * 
+ * <b>Note:</b> to use foreachq, only the opening tag has to be replaced. The closing tab still
+ * remains {/foreach}
+ * 
+ * <code>
+ * // Iterate, slow version
+ * {foreach from=$array item=elt}
+ *   {$elt}
+ * {/foreach}
+ * // Iterate, fast version
+ * {foreachq from=$array item=elt}
+ *   {$elt}
+ * {/foreach}
+ * </code>
+ */
+function smarty_compiler_foreachq( $argStr, &$comp ) {
+
+	$comp->_push_tag('foreach');
+
+	$attrs = $comp->_parse_attrs( $argStr, false );
+
+    $arg_list = array();
+
+    if (empty($attrs['from'])) {
+        return $comp->_syntax_error("foreachq: missing 'from' attribute", E_USER_ERROR, __FILE__, __LINE__);
+    }
+    $from = $attrs['from'];
+
+    if (empty($attrs['item'])) {
+        return $comp->_syntax_error("foreachq: missing 'item' attribute", E_USER_ERROR, __FILE__, __LINE__);
+    }
+    $item = $comp->_dequote($attrs['item']);
+    if (!preg_match('~^\w+$~', $item)) {
+        return $comp->_syntax_error("'foreachq: item' must be a variable name (literal string)", E_USER_ERROR, __FILE__, __LINE__);
+    }
+
+    if (isset($attrs['key'])) {
+        $key  = $comp->_dequote($attrs['key']);
+        if (!preg_match('~^\w+$~', $key)) {
+            return $comp->_syntax_error("foreachq: 'key' must to be a variable name (literal string)", E_USER_ERROR, __FILE__, __LINE__);
+        }
+        $key_part = "\$this->_tpl_vars['$key'] => ";
+    } else {
+        $key = null;
+        $key_part = '';
+    }
+
+    if (isset($attrs['name'])) {
+        $name = $attrs['name'];
+    } else {
+        $name = null;
+    }
+
+    $output = '';
+    //$output .= "\$_from = $from; if (!is_array(\$_from) && !is_object(\$_from)) { settype(\$_from, 'array'); }";
+    if (isset($name)) {
+        $foreach_props = "\$this->_foreach[$name]";
+        $output .= "{$foreach_props} = array('total' => count($from), 'iteration' => 0);\n";
+        //$output .= "{$foreach_props} = array('total' => count(\$_from), 'iteration' => 0);\n";
+        $output .= "if ({$foreach_props}['total'] > 0):\n";
+        $output .= "    foreach ($from as $key_part\$this->_tpl_vars['$item']):\n";
+        //$output .= "    foreach (\$_from as $key_part\$this->_tpl_vars['$item']):\n";
+        $output .= "        {$foreach_props}['iteration']++;\n";
+    } else {
+        $output .= "if (count($from)):\n";
+        $output .= "    foreach ($from as $key_part\$this->_tpl_vars['$item']):\n";
+        //$output .= "if (count(\$_from)):\n";
+        //$output .= "    foreach (\$_from as $key_part\$this->_tpl_vars['$item']):\n";
+    }
+    //$output .= '';
+
+    return $output;
+
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.foreachq.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.includeq.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.includeq.php	2006-02-19 18:53:19 UTC (rev 251)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.includeq.php	2006-02-19 18:56:43 UTC (rev 252)
@@ -0,0 +1,86 @@
+<?php
+/**
+ * includeq Smarty compiler plug-in
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
+ * @since       2.3.0
+ * @version		$Id$
+ */
+
+/**
+ * Quick include template plug-in
+ *
+ * Like {@link smarty_compiler_foreachq() foreachq}, this plug-in has been written to provide
+ * a faster version of an already existing Smarty function. <var>includeq</var> can be used
+ * as a replacement for the Smarty 
+ * {@link http://smarty.php.net/manual/en/language.function.include.php include} function as long
+ * as you are aware of the differences between them.
+ * 
+ * Normally, when you include a template, Smarty does the following:
+ * - Backup all your template variables in an array
+ * - Include the template you specified
+ * - Restore the template variables from the previously created backup array
+ * 
+ * The advantage of this method is that it makes the main template variables <i>safe</i>: if your
+ * main template uses a variable called <var>$stuff</var> and the included template modifies it
+ * value, the main template will recover the original value automatically.
+ * 
+ * While this can be useful in some cases (for example, when you include templates you have absolutely
+ * no control over), some may consider this a limitation and it has the disadvantage of slowing down
+ * the inclusion mechanism a lot.
+ * 
+ * <var>includeq</var> fixes that: the code it generates doesn't contain the variables backup/recovery
+ * mechanism and thus makes templates inclusion faster. Note that however, this new behavior may
+ * create problems in some cases (but you can prevent them most of the times, for example by always
+ * using a <var>tmp_</var> prefix for the variables you create in included templates looping sections).
+ */
+function smarty_compiler_includeq( $tag_args, &$comp ) {
+
+	$attrs = $comp->_parse_attrs($tag_args);
+    $arg_list = array();
+
+    if (empty($attrs['file'])) {
+        $comp->_syntax_error("missing 'file' attribute in includeq tag", E_USER_ERROR, __FILE__, __LINE__);
+    }
+
+    foreach ($attrs as $arg_name => $arg_value) {
+        if ($arg_name == 'file') {
+            $include_file = $arg_value;
+            continue;
+        } else if ($arg_name == 'assign') {
+            $assign_var = $arg_value;
+            continue;
+        }
+        if (is_bool($arg_value))
+            $arg_value = $arg_value ? 'true' : 'false';
+        $arg_list[] = "'$arg_name' => $arg_value";
+    }
+
+    $output = '';
+
+    if (isset($assign_var)) {
+        $output .= "ob_start();\n";
+    }
+
+    //$output .= "\$_smarty_tpl_vars = \$this->_tpl_vars;\n";
+    $_params = "array('smarty_include_tpl_file' => " . $include_file . ", 'smarty_include_vars' => array(".implode(',', (array)$arg_list)."))";
+    $output .= "\$this->_smarty_include($_params);\n";
+    //"\$this->_tpl_vars = \$_smarty_tpl_vars;\n" .
+    //"unset(\$_smarty_tpl_vars);\n";
+
+    if (isset($assign_var)) {
+        $output .= "\$this->assign(" . $assign_var . ", ob_get_contents()); ob_end_clean();\n";
+    }
+    //$output .= '';
+    return $output;
+}
+
+    
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.includeq.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-02-19 18:53:19 UTC (rev 251)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoAppUrl.php	2006-02-19 18:56:43 UTC (rev 252)
@@ -1,39 +1,61 @@
 <?php
 /**
-* xoAppUrl Smarty compiler plug-in
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @package		xoops_template
-* @subpackage	xoops_template_Smarty
-* @since        2.3.0
-* @version		$Id$
-*/
+ * xoAppUrl Smarty compiler plug-in
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
+ * @since       2.3.0
+ * @version		$Id$
+ */
 
-function smarty_compiler_xoAppUrl( $argStr, &$smarty ) {
+/**
+ * Inserts the URL of an application page
+ * 
+ * This plug-in allows you to generate a module location URL. It uses any URL rewriting
+ * mechanism and rules you'll have configured for the system.
+ * 
+ * To ensure this can be as optimized as possible, it accepts 2 modes of operation:
+ * 
+ * <b>Static address generation</b>:<br>
+ * This is the default mode and fastest mode. When used, the URL is generated during
+ * the template compilation, and statically written in the compiled template file.
+ * To use it, you just need to provide a location in a format XOOPS understands.
+ * 
+ * <code>
+ * // Generate an URL using a physical path (not recommended)
+ * ([xoAppUrl /modules/something/yourpage.php])
+ * // Generate an URL using a module+location identifier
+ * ([xoAppUrl mod_xoops_Identification#logout])
+ * </code>
+ * 
+ * <b>Dynamic address generation</b>:<br>
+ * The is the slowest mode, and its use should be prevented unless necessary. Here,
+ * the URL is generated dynamically each time the template is displayed, thus allowing
+ * you to use the value of a template variable in the location string. To use it, you
+ * must surround your location with double-quotes ("), and use the
+ * {@link http://smarty.php.net/manual/en/language.syntax.quotes.php Smarty quoted strings}
+ * syntax to insert variables values.
+ * 
+ * <code>
+ * // Use the value of the $sortby template variable in the URL
+ * ([xoAppUrl "/modules/something/yourpage.php?order=`$sortby`"])
+ * </code>
+ */
+function smarty_compiler_xoAppUrl( $argStr, &$compiler ) {
 	global $xoops;
 	
 	$argStr = trim( $argStr );
-/*
-	@list( $modId, $location ) = explode( '#', $argStr, 2 );
-	if ( isset( $location ) ) {
-		if ( $module = $xoops->loadModule( $modId ) ) {
-			$uri = $module->xoBundleRoot;
-			if ( isset( $location ) && isset( $module->moduleLocations[$location] ) ) {
-				$uri .= $module->moduleLocations[$location]['scriptFile'];
-			}
-		}
-	} else {
-		$uri = $argStr;
+	if ( substr( $argStr, 0, 1 ) == '"' ) {
+		$argStr = $compiler->_expand_quoted_text( $argStr );
+		return "echo \$GLOBALS['xoops']->path( $argStr, true );";
 	}
-*/
-	$uri = $argStr;
-	return "\necho '" . addslashes( $xoops->path( $uri, true ) ) . "';";
-
+	return "echo '" . addslashes( $xoops->path( $argStr, true ) ) . "';";
 }
 
 ?>
\ No newline at end of file

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoImgUrl.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoImgUrl.php	2006-02-19 18:53:19 UTC (rev 251)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoImgUrl.php	2006-02-19 18:56:43 UTC (rev 252)
@@ -1,19 +1,35 @@
 <?php
 /**
-* xoImgUrl Smarty compiler plug-in
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @package		xoops_template
-* @subpackage	xoops_template_Smarty
-* @since        2.3.0
-* @version		$Id$
-*/
+ * xoImgUrl Smarty compiler plug-in
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
+ * @since       2.3.0
+ * @version		$Id$
+ */
 
+/**
+ * Inserts the URL of a file resource customizable by themes
+ *
+ * This plug-in works like the {@link smarty_compiler_xoAppUrl() xoAppUrl} plug-in,
+ * except that it is intended to generate the URL of resource files customizable by
+ * themes.
+ * 
+ * Here the current theme is asked to check if a custom version of the requested file exists, and
+ * if one is found its URL is returned. Otherwise, the request will be passed to the
+ * theme parents one by one. Ultimately, if no custom version has been found, the resource
+ * default URL location will be returned.
+ * 
+ * <b>Note:</b> the themes inheritance system can generate many filesystem accesses depending
+ * on your themes configuration. Because of this, the use of the dynamic syntax with this plug-in
+ * is really not recommended.
+ */
 function smarty_compiler_xoImgUrl( $argStr, &$smarty ) {
 	global $xoops;
 	

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-02-19 18:53:19 UTC (rev 251)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/plugins/compiler.xoWidget.php	2006-02-19 18:56:43 UTC (rev 252)
@@ -1,23 +1,37 @@
 <?php
 /**
-* xoWidget Smarty compiler plug-in
-*
-* See the enclosed file LICENSE for licensing information.
-* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
-*
-* @copyright    The XOOPS project http://www.xoops.org/
-* @license      http://www.fsf.org/copyleft/gpl.html GNU public license
-* @author		Skalpa Keo <skalpa at xoops.org>
-* @package		xoops_template
-* @subpackage	xoops_template_Smarty
-* @since        2.3.0
-* @version		$Id$
-*/
+ * xoWidget Smarty compiler plug-in
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
+ * @since       2.3.0
+ * @version		$Id$
+ */
 
+/**
+ * Inserts/renders a widget
+ *
+ * The xoWidget plug-in generates the code to instanciate and/or render a widget. Depending on
+ * the parameters you specify, it can do three different things:
+ * - Instanciate a widget, and render it in-place
+ * - Instanciate a widget, and assign the created object to a template variable
+ * - Render an already created widget instance
+ * 
+ * In-place instanciation/rendering:
+ * 
+ * 
+ * 
+ */
 function smarty_compiler_xoWidget( $argStr, &$compiler ) {
 	global $xoops;
 	
-	$args = $compiler->_parse_attrs( trim( $argStr ) );
+	$args = $compiler->_parse_attrs( trim( $argStr ), false );
 	array_map( array( &$compiler, '_expand_quoted_text' ), $args );
 	
 	if ( isset( $args['tplVar'] ) ) {



From skalpa at berlios.de  Sun Feb 19 20:03:46 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:03:46 +0100
Subject: [Xoops4-svn] r253 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj
Message-ID: <200602191903.k1JJ3k7e004087@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:03:35 +0100 (Sun, 19 Feb 2006)
New Revision: 253

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/compiler.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/smarty.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/xo-info.php
Log:
Fixed several Smarty bugs (the fixes are implemented in the XOOPS children classes, but I'm sending them to the Smarty author tomorrow)
Also enabled htmlspecialchars as a default modifier for .xotpl templates (which means that data sent to .xotpl templates doesn't have to be "sanitized" in scripts anymore)

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/compiler.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/compiler.php	2006-02-19 18:56:43 UTC (rev 252)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/compiler.php	2006-02-19 19:03:35 UTC (rev 253)
@@ -27,6 +27,8 @@
  * This compiler is used by the xoops_opal framework smarty implementation instead of the default one.
  * If the template is recognized as an XML XoopsTemplate file, it will be parsed before compilation,
  * the template data extracted from the correct TemplateData tag.
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
  */
 class xoops_opal_SmartyCompiler extends Smarty_Compiler {
 	/**
@@ -48,9 +50,9 @@
 
     function _compile_file($resource_name, $source_content, &$compiled_content) {
 		$this->resourceName = $resource_name;
-    	if ( substr( $resource_name, 0, 6 ) == 'xotpl:' ) {
+    	if ( substr( $resource_name, -6 ) == '.xotpl' ) {
+			$this->tplLangFiles = $this->tplWidgets = array();
 			if ( strpos( substr( $source_content, 0, 256 ), '<XoopsTemplate' ) !== false ) {
-				$this->tplLangFiles = $this->tplWidgets = array();
 				
 				$parser = xml_parser_create();
 				xml_parser_set_option($parser, XML_OPTION_CASE_FOLDING, 0);
@@ -65,29 +67,31 @@
 						$this->parseObject( $values[ $objects[$n] ], array_slice( $values, $start, $objects[$n+1] - $start ) );
 					}
 				}
-				$tplData = null;
 				foreach ( $tags['TemplateData'] as $tag ) {
 					$tagInfo =& $values[ $tag ];
 					if ( $tagInfo['attributes']['contentType'] == $this->template_engine->currentTheme->contentType ) {
-						$tplData = $tagInfo['value'];
+						$source_content = $tagInfo['value'];
 						break;
 					} elseif ( isset( $tagInfo['attributes']['default'] ) ) {
-						$tplData = $tagInfo['value'];
+						$source_content = $tagInfo['value'];
 					}
 				}
-				
-				parent::_compile_file( $resource_name, $tplData, $compiled_content );
-				$prelude = '';
-				if ( !empty($this->tplWidgets) ) {
-					$prelude = "<?php\n";
-					foreach ( $this->tplWidgets as $widgetDef ) {
-						$prelude .= $this->insertWidget( $widgetDef );
-					}
-					$prelude .= "\n?>";
+			}
+			$mods = $this->default_modifiers;
+			$this->default_modifiers = array( '@htmlspecialchars:' . ENT_QUOTES );
+			parent::_compile_file( $resource_name, $source_content, $compiled_content );
+			$this->default_modifiers = $mods;
+
+			$prelude = '';
+			if ( !empty($this->tplWidgets) ) {
+				$prelude = "<?php\n";
+				foreach ( $this->tplWidgets as $widgetDef ) {
+					$prelude .= $this->insertWidget( $widgetDef );
 				}
-				$compiled_content = $prelude . $compiled_content;
-				return true;
+				$prelude .= "\n?>";
 			}
+			$compiled_content = $prelude . $compiled_content;
+			return true;
 		}
     	return parent::_compile_file( $resource_name, $source_content, $compiled_content );
     }
@@ -130,9 +134,9 @@
     	$n = 0;
     	foreach ( $tags as $k => $tag ) {
     		if ( isset( $tag['attributes']['key'] ) ) {
-    			$items[] = "'$k' => " . $this->parsePropertyValue( $tag['value'] );
+    			$items[] = "'{$tag['attributes']['key']}' => " . $this->parsePropertyValue( $tag['value'] );
     		} else {
-    			$items[] = "$n => " . $this->parsePropertyValue(  $tag['value'] );
+    			$items[] = "$k => " . $this->parsePropertyValue(  $tag['value'] );
     		}
     	}
     	return 'array( ' . implode( ',', $items ) . ')';
@@ -207,8 +211,44 @@
 		return $code;
     }
     
-    
-    
+    // Fixes for some an original smarty misbehavior, that applies the default modifiers
+    // on the foreach and if variables (making arrays content escaped twice)
+	function _compile_foreach_start( $tag_args ) {
+   		$mods = $this->default_modifiers;
+   		$this->default_modifiers = array();
+   		$out = parent::_compile_foreach_start( $tag_args );
+       	$this->default_modifiers = $mods;
+		return $out;
+	}
+    function _compile_if_tag($tag_args, $elseif = false) {
+   		$mods = $this->default_modifiers;
+   		$this->default_modifiers = array();
+   		$out = parent::_compile_if_tag( $tag_args, $elseif );
+       	$this->default_modifiers = $mods;
+		return $out;
+	}
+
+	function _parse_attrs( $tag_args, $use_mods = true ) {
+		if ( $use_mods ) {
+			return parent::_parse_attrs( $tag_args );
+		}
+   		$mods = $this->default_modifiers;
+   		$this->default_modifiers = array();
+   		$out = parent::_parse_attrs( $tag_args );
+       	$this->default_modifiers = $mods;
+		return $out;
+	}
+    function _parse_parenth_args( $parenth_args ) {
+   		$mods = $this->default_modifiers;
+   		$this->default_modifiers = array();
+   		$out = parent::_parse_parenth_args( $parenth_args );
+       	$this->default_modifiers = $mods;
+		return $out;
+    }
+	
+	
+	
+	
 }
 
 ?>
\ No newline at end of file

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/smarty.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/smarty.php	2006-02-19 18:56:43 UTC (rev 252)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/smarty.php	2006-02-19 19:03:35 UTC (rev 253)
@@ -14,13 +14,18 @@
  * @author		Skalpa Keo <skalpa at xoops.org>
  */
 
+/**
+ * This file cannot be requested directly
+ */
+if ( !defined( 'XOOPS_PATH' ) ) exit();
+
 XOS::import( 'Smarty' );
 
 /**
- * XOOPS core default Smarty implementation
- * @since        2.3.0
- * @package		xoops_template
- * @subpackage	xoops_template_Smarty
+ * Opal framework Smarty implementation
+ * @since       2.3.0
+ * @package		xoops_opal
+ * @subpackage	xoops_opal_Smarty
  */
 class xoops_opal_Smarty extends Smarty {
 	
@@ -87,7 +92,7 @@
     }
 
 	/**
-	 * Render output from template data
+	 * Renders output from template data
 	 * 
 	 * @param   string  $data		The template to render
 	 * @param	bool	$display	If rendered text should be output or returned
@@ -111,6 +116,39 @@
     	return $data;
     }
 
+	/**
+	 * Temporary fix for a Smarty bug (Smarty doesn't work with recursive arrays)
+	 */    
+    function _run_mod_handler()
+    {
+        $_args = func_get_args();
+        list($_modifier_name, $_map_array) = array_splice($_args, 0, 2);
+        list($_func_name, $_tpl_file, $_tpl_line) =
+            $this->_plugins['modifier'][$_modifier_name];
+
+        $_var = $_args[0];
+        foreach ($_var as $_key => $_val) {
+            $_args[0] = $_val;
+			// skalpa: fix to handle recursive arrays
+			//$_var[$_key] = call_user_func_array($_func_name, $_args);
+            if ( is_array( $_val ) ) {
+            	$_cargs = func_get_args();
+            	$_cargs[2] = $_val;
+            	$_var[$_key] = call_user_func_array( array( &$this, '_run_mod_handler' ), $_cargs );
+            } else {
+ 	           $_var[$_key] = call_user_func_array($_func_name, $_args);
+            }
+        }
+        return $_var;
+    }
+    
+    
+    
+    
+    
+    
+    
+    
 }
 
 ?>
\ No newline at end of file

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/xo-info.php	2006-02-19 18:56:43 UTC (rev 252)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Smarty.xoobj/xo-info.php	2006-02-19 19:03:35 UTC (rev 253)
@@ -1,6 +1,6 @@
 <?php
 /**
- * xoops_template_Smarty bundle information file
+ * xoops_opal_Smarty bundle information file
  *
  * See the enclosed file LICENSE for licensing information.
  * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html



From skalpa at berlios.de  Sun Feb 19 20:05:38 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:05:38 +0100
Subject: [Xoops4-svn] r254 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/templates
Message-ID: <200602191905.k1JJ5cwB004570@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:05:15 +0100 (Sun, 19 Feb 2006)
New Revision: 254

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/templates/metas.xotpl
Log:
Changed the meta.xotpl template to deal with the fact variables are automatically escaped, and changed the "foreach" loops to "foreachq"

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/templates/metas.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/templates/metas.xotpl	2006-02-19 19:03:35 UTC (rev 253)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/templates/metas.xotpl	2006-02-19 19:05:15 UTC (rev 254)
@@ -1,21 +1,21 @@
 
 
-([foreach from=$xoTheme->metas.meta key=name item=content])
+([foreachq from=$xoTheme->metas.meta key=name item=content])
 	<meta name="([$name])" content="([$content])" />
 ([/foreach])
 
-([foreach from=$xoTheme->metas.script item=attributes])
-	<script([$xoTheme->renderAttributes($attributes)])>([if !empty( $attributes._ ) ])
+([foreachq from=$xoTheme->metas.script item=attributes])
+	<script([$xoTheme->renderAttributes($attributes)|smarty:nodefaults])>([if $attributes._])
 	//<![CDATA[
 	([$attributes._])
 	//]]>([/if])</script>
 ([/foreach])
 
-([foreach from=$xoTheme->metas.stylesheet item=attributes])
-([if empty( $attributes._ )])
-	<link rel="stylesheet"([$xoTheme->renderAttributes($attributes)]) />
+([foreachq from=$xoTheme->metas.stylesheet item=attributes])
+([if !$attributes._ ])
+	<link rel="stylesheet"([$xoTheme->renderAttributes($attributes)|smarty:nodefaults]) />
 ([else])
-	<style([$xoTheme->renderAttributes($attributes)])>
+	<style([$xoTheme->renderAttributes($attributes)|smarty:nodefaults])>
 	/* <![CDATA[ */
 	([$attributes._])
 	/* //]]> */
@@ -23,6 +23,6 @@
 ([/if])
 ([/foreach])
 	
-([foreach from=$xoTheme->metas.link key=rel item=attributes])
-	<link rel="([$rel])"([$xoTheme->renderAttributes($attributes)]) />
+([foreachq from=$xoTheme->metas.link key=rel item=attributes])
+	<link rel="([$rel])"([$xoTheme->renderAttributes($attributes)|smarty:nodefaults]) />
 ([/foreach])



From skalpa at berlios.de  Sun Feb 19 20:07:59 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:07:59 +0100
Subject: [Xoops4-svn] r255 - XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj
Message-ID: <200602191907.k1JJ7xQd005235@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:07:56 +0100 (Sun, 19 Feb 2006)
New Revision: 255

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/theme.php
Log:
Several enhancements in the theme component, to bring multiple mime-types support to themes (the same theme can now render content as text/html, application/xhtml+xml and pdf as long as appropriate templates are provided)

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/theme.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/theme.php	2006-02-19 19:05:15 UTC (rev 254)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/OutputRendering/Opal.xofrm/Theme.xoobj/theme.php	2006-02-19 19:07:56 UTC (rev 255)
@@ -22,32 +22,66 @@
 class xoops_opal_ThemeFactory {
 	/**
 	 * Currently enabled themes (if empty, all the themes in themes/ are allowed)
-	 * 
 	 * @var array
 	 */
 	var $allowedThemes = array();
 	/**
 	 * Default theme to instanciate if none specified
-	 * 
 	 * @var string
 	 */
 	var $defaultTheme = 'default';
+	/**
+	 * If users are allowed to choose a custom theme
+	 * @var bool
+	 */
+	var $allowUserSelection = true;
 
 	/**
 	 * Instanciate the specified theme
 	 */
 	function &createInstance( $options = array(), $initArgs = array() ) {
-		if ( @empty( $options['folderName'] ) ) {
-			//$options['folderName'] = $this->defaultTheme;
-			$options['folderName'] = $GLOBALS['xoopsConfig']['theme_set'];
-		} elseif ( !empty( $this->allowedThemes ) && !in_array( $options['folderName'], $this->allowedThemes ) ) {
+		// Grab the theme folder from request vars if present
+		if ( @empty( $options['folderName'] ) && ( $req = @$_REQUEST['_xo_theme_name'] ) ) {
+			if ( $this->isThemeAllowed( $req ) ) {
+				$options['folderName'] = $req;
+				if ( isset( $_SESSION ) && $this->allowUserSelection ) {
+					$_SESSION[ $this->xoBundleIdentifier ]['defaultTheme'] = $req;
+	    		}
+	    	}
+		} elseif ( isset( $_SESSION[ $this->xoBundleIdentifier ]['defaultTheme'] ) ) {
+			$options['folderName'] = $_SESSION[ $this->xoBundleIdentifier ]['defaultTheme'];
+		} elseif ( @empty( $options['folderName'] ) || !$this->isThemeAllowed( $options['folderName'] ) ) {
 			$options['folderName'] = $this->defaultTheme;
 		}
-		$inst =& XOS::createInstanceOf( "xoops_opal_Theme", $options, $initArgs );
+		// Retrieve the desired content-type from the request
+		if ( @empty( $options['contentType'] ) && !empty($_REQUEST['_xo_mime_type']) ) {
+   			$options['contentType'] = $_REQUEST['_xo_mime_type'];
+		}
+
+		// Read the theme bundle info file
+		global $xoops;
+		$options['path'] = $xoops->path( '/themes/' . $options['folderName'] );
+		if ( $info = @include( $options['path'] . "/xo-info.php" ) ) {
+			$options = array_merge( $info, $options );
+		} else {
+			$options['themeAPI'] = '2.0';
+			$options['parentTheme'] = ( $options['folderName'] == 'xoops20' ? '' : 'xoops20' );
+		}
+		$inst =& XOS::createInstanceOf( 'xoops_opal_Theme', $options );
+		
 		return $inst;
 	}
 
 	/**
+	 * Checks if the specified theme is enabled or not
+	 * @param string $name
+	 * @return bool
+	 */
+	function isThemeAllowed( $name ) {
+		return ( empty( $this->allowedThemes ) || in_array( $name, $this->allowedThemes ) );
+	}
+	
+	/**
 	 * List the available themes
 	 *
 	 * @param	boolean $allowed Whether to return the allowed themes, or all of them
@@ -89,7 +123,7 @@
 	* Default content-type of pages generated by this theme
 	* @var string
 	*/
-	var $contentType = 'text/html';
+	var $contentType = '';
 	/**
 	* Output format doctype
 	* @var string
@@ -149,6 +183,14 @@
 	*/
 	var $plugins = array( 'xoops_logos_PageBuilder' );
 	
+	/**
+	 * List of mime-types supported by this theme
+	 * @var array
+	 * @access public
+	 */
+	var $supportedMimeTypes = '';
+	var $allowXHTML = true;
+	
 	var $renderCount = 0;
 	/**
 	 * Pointer to the theme template engine
@@ -156,31 +198,48 @@
 	 * @var object
 	 */
 	var $template = false;
+	
+	var $metas = array( 'meta' => array(), 'link' => array() );
+	
    /**#@-*/
 
-	function xoInit( $options = array() ) {
+	/**#@+ @tasktype 10 Initialization*/
+	/**
+	 * Initializes this theme
+	 *
+	 * Upon initialization, the theme creates its template engine and instanciates the
+	 * plug-ins from the specified {@link $plugins} list. If the theme is a 2.0 theme, that does not
+	 * display redirection messages, the HTTP redirections system is disabled to ensure users will
+	 * see the redirection screen.
+	 * 
+	 * @param array $options
+	 * @return bool
+	 */
+   function xoInit( $options = array() ) {
 		global $xoops;
 
-		$this->path	= $xoops->path( '/themes/' . $this->folderName );
-		if ( $info = @include "$this->path/xo-info.php" ) {
-			XOS::apply( $this, $info );
-			if ( isset( $_SESSION ) ) {
-				unset( $_SESSION[$xoops->services['http']->xoBundleIdentifier]['tmpDisallowRedirections'] );
-			}
-		} else {
-			$this->themeAPI = '2.0';
-			$this->parentTheme = ( $this->folderName == 'xoops20' ? '' : 'xoops20' );
-			$_SESSION[$xoops->services['http']->xoBundleIdentifier]['tmpDisallowRedirections'] = true;
+		if ( isset( $_SESSION ) ) {
+			$_SESSION[$xoops->services['http']->xoBundleIdentifier]['tmpDisallowRedirections'] = ( $this->themeAPI == '2.0' );
 		}
-
-		
 		if ( $this->namespaces && !is_array( $this->namespaces ) ) {
 			$this->namespaces = array( '' => $this->namespaces );
 		}
+		if ( $this->supportedMimeTypes && !is_array( $this->supportedMimeTypes ) ) {
+			$this->supportedMimeTypes = explode( ",", $this->supportedMimeTypes );
+		}
 
+		if ( !$this->contentType || !in_array( $this->contentType, $this->supportedMimeTypes ) ) {
+			$this->contentType = $this->supportedMimeTypes[0];
+		}
+		if ( $this->contentType == 'application/xhtml+xml' ) {
+			if ( !$this->allowXHTML || false === strpos( $_SERVER['HTTP_ACCEPT'], 'application/xhtml+xml' ) ) {
+				$this->contentType = 'text/html';
+			}
+		}
+
 		$this->template =& XOS::create( 'xoops_opal_Smarty' );
 		$this->template->currentTheme =& $this;
-		$this->template->compile_id = $this->folderName;
+		$this->template->compile_id = '';
 		
 		if ( $this->bufferOutput ) {
 			ob_start();
@@ -191,8 +250,107 @@
 		}
 		return true;
 	}
+	/**#@-*/
+	
+	/**#@+ @tasktype 20 Manipulating page meta-iformation*/
+    /**
+    * Adds script code to the document head
+    *
+    * This methods allows the insertion of an external script file (if $src is provided), or
+    * of a script snippet. The file URI is parsed to take benefit of the theme resource
+    * overloading system.
+    * 
+    * The $attributes parameter allows you to specify the attributes that will be added to the 
+    * inserted <script> tag. If unspecified, the <var>type</var> attribute value will default to
+    * 'text/javascript'.
+    * 
+    * <code>
+    * // Add an external script using a physical path (not recommended)
+    * $theme->addScript( '/www/script.js', null, '' );
+    * // Add an external script that belongs to a component
+    * $theme->addScript( 'xoops_pyro_TreeWidget#www/script.js', null, '' );
+    * $theme->addScript( 'mod_xoops_SiteManager#common.js', null, '' );
+    * // Specify attributes for the <script> tag
+    * $theme->addScript( 'mod_xoops_SiteManager#common.js', array( 'type' => 'application/x-javascript' ), '' );
+    * // Insert a code snippet
+    * $theme->addScript( null, array( 'type' => 'application/x-javascript' ), 'window.open("Hello world");' );
+    * </code>
+    * 
+    * @param string $src path to an external script file
+    * @param array $attributes hash of attributes to add to the <script> tag
+    * @param string $content Code snippet to output within the <script> tag
+    *
+    * @return void
+    **/
+    function addScript( $src = '', $attributes = array(), $content = '' ) {
+    	global $xoops;
+		if ( !empty( $src ) ) {
+			$attributes['src'] = $xoops->url( $this->resourcePath( $src ) );
+		}
+		if ( !empty( $content ) ) {
+			$attributes['_'] = $content;
+		}
+		if ( !isset( $attributes['type'] ) ) {
+			$attributes['type'] = 'text/javascript';
+		}
+		$this->setMeta( 'script', $src, $attributes );
+    }
 
+    /**
+    * Add StyleSheet or CSS code to the document head
+    *
+    * @param string $src path to .css file
+    * @param array $attributes name => value paired array of attributes such as title
+    * @param string $content CSS code to output between the <style> tags (in case $src is empty)
+    *
+    * @return void
+    **/
+    function addStylesheet( $src = '', $attributes = array(), $content = '' ) {
+    	global $xoops;
+		if ( !empty( $src ) ) {
+			$attributes['href'] = $xoops->url( $this->resourcePath( $src ) );
+		}
+		if ( !isset($attributes['type']) ) {
+			$attributes['type'] = 'text/css';
+		}
+		if ( !empty( $content ) ) {
+			$attributes['_'] = $content;
+		}
+    	$this->setMeta( 'stylesheet', $src, $attributes );
+    }
 	/**
+	 * Add a <link> to the header
+	 * 
+	 * @param string	$rel		Relationship from the current doc to the anchored one
+	 * @param string	$href		URI of the anchored document
+	 * @param array		$attributes	Additional attributes to add to the <link> element
+	 */
+	function addLink( $rel, $href = '', $attributes = array() ) {
+		global $xoops;
+		if ( !empty( $href ) ) {
+			$attributes['href'] = $href;
+		}
+		$this->setMeta( 'link', $rel, $attributes );
+	}
+    
+	/**
+	 * Change output page meta-information
+	 */
+    function setMeta( $type = 'meta', $name = '', $value = '' ) {
+		if ( !isset( $this->metas[$type] ) ) {
+			$this->metas[$type] = array();
+		}
+    	if ( isset($name) ) {
+			$this->metas[$type][$name] = $value;
+		} else {
+			$this->metas[$type][] = 	$value;
+		}
+		return $value;
+    }
+	
+
+
+	/**
 	 * Returns the document namespaces as an xmlns string that can be inserted in the main tag
 	 */	
 	function namespacesString() {
@@ -205,6 +363,7 @@
 		}
 		return implode( ' ', $str );
 	}
+	/**#@-*/
 	
 	/**
 	 * Render the page
@@ -235,13 +394,25 @@
 	function render( $canvasTpl = null, $pageTpl = null, $contentTpl = null, $vars = array() ) {
 		global $xoops;
 
+		$this->template->compile_id = $this->folderName . '-' . substr( $this->contentType, strrpos( $this->contentType, '/' ) + 1 );
+
 		if ( !$this->renderCount && $this->bufferOutput ) {
 			$this->content .= ob_get_contents();
 			ob_end_clean();
 		}
+
+		if ( $this->contentType == 'application/pdf' ) {
+			$pdfmaker =& XOS::create( 'xoops_opal_PdfMaker' );
+			$pdfmaker->startCapture();
+			$xoops->services['logger']->activated = false;
+			
+		}
+
+
 		if ( $this->themeAPI != '2.3' ) {
 			include $xoops->path( $this->xoBundleRoot . '/render-' . $this->themeAPI . '.php' );
 		}
+		
 		if ( !empty($canvasTpl) ) {
 			$this->canvasTemplate = $canvasTpl;
 		}
@@ -371,84 +542,8 @@
 		return $fromDocRoot ? "www/$path" : "themes/$this->folderName/$path";
 	}
 	
-    /**
-    * Add Javascript file or JS code to the document head
-    *
-    * @param string $src path to .js file
-    * @param array $attributes name => value paired array of attributes such as title
-    * @param string $content JavaScript code to output between the tags
-    *
-    * @return void
-    **/
-    function addScript( $src = '', $attributes = array(), $content = '' ) {
-    	global $xoops;
-		if ( !empty( $src ) ) {
-			$attributes['src'] = $xoops->url( $this->resourcePath( $src ) );
-		}
-		if ( !empty( $content ) ) {
-			$attributes['_'] = $content;
-		}
-		if ( !isset( $attributes['type'] ) ) {
-			$attributes['type'] = 'text/javascript';
-		}
-		$this->setMeta( 'script', $src, $attributes );
-    }
-
-    /**
-    * Add StyleSheet or CSS code to the document head
-    *
-    * @param string $src path to .css file
-    * @param array $attributes name => value paired array of attributes such as title
-    * @param string $content CSS code to output between the <style> tags (in case $src is empty)
-    *
-    * @return void
-    **/
-    function addStylesheet( $src = '', $attributes = array(), $content = '' ) {
-    	global $xoops;
-		if ( !empty( $src ) ) {
-			$attributes['href'] = $xoops->url( $this->resourcePath( $src ) );
-		}
-		if ( !isset($attributes['type']) ) {
-			$attributes['type'] = 'text/css';
-		}
-		if ( !empty( $content ) ) {
-			$attributes['_'] = $content;
-		}
-    	$this->setMeta( 'stylesheet', $src, $attributes );
-    }
-	/**
-	 * Add a <link> to the header
-	 * 
-	 * @param string	$rel		Relationship from the current doc to the anchored one
-	 * @param string	$href		URI of the anchored document
-	 * @param array		$attributes	Additional attributes to add to the <link> element
-	 */
-	function addLink( $rel, $href = '', $attributes = array() ) {
-		global $xoops;
-		if ( !empty( $href ) ) {
-			$attributes['href'] = $href;
-		}
-		$this->setMeta( 'link', $rel, $attributes );
-	}
-    
-	/**
-	 * Change output page meta-information
-	 */
-    function setMeta( $type = 'meta', $name = '', $value = '' ) {
-		if ( !isset( $this->metas[$type] ) ) {
-			$this->metas[$type] = array();
-		}
-    	if ( isset($name) ) {
-			$this->metas[$type][$name] = $value;
-		} else {
-			$this->metas[$type][] = 	$value;
-		}
-		return $value;
-    }
 	
-
 	
-	
 
 }
 



From skalpa at berlios.de  Sun Feb 19 20:08:53 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:08:53 +0100
Subject: [Xoops4-svn] r256 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience: . ConfigurationPanel.xoobj
Message-ID: <200602191908.k1JJ8r39005495@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:08:52 +0100 (Sun, 19 Feb 2006)
New Revision: 256

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/panel.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/xo-info.php
Log:
Added the base class for configuration panels

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/panel.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/panel.php	2006-02-19 19:07:56 UTC (rev 255)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/panel.php	2006-02-19 19:08:52 UTC (rev 256)
@@ -0,0 +1,31 @@
+<?php
+/**
+ * xoops_panel_ConfigurationPanel component main class file
+ *
+ * @copyright	The Xoops project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @author      Skalpa Keo <skalpa at xoops.org>
+ * @since       2.3.0
+ * @version		$$
+ * @package     xoops_panel
+ * @subpackage  xoops_panel_ConfigurationPanel
+ */
+
+XOS::import( 'xoops_app_PageController' );
+
+/**
+ * Base class for configuration panels
+ * 
+ * The page controller receives a page request, extracts any relevant data,
+ * invokes any updates to the model, and if necessary forwards the request to the view.
+ */
+class xoops_panel_ConfigurationPanel extends xoops_app_PageController {
+	/**
+	 * Configuration handler instanciated by the container application
+	 * @var object
+	 */
+	var $configHandler = false;
+
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/panel.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/xo-info.php	2006-02-19 19:07:56 UTC (rev 255)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/xo-info.php	2006-02-19 19:08:52 UTC (rev 256)
@@ -0,0 +1,23 @@
+<?php
+/**
+* xoops_app_PageController bundle information file
+*
+* See the enclosed file LICENSE for licensing information.
+* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+*
+* @copyright	The XOOPS project http://www.xoops.org/
+* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+* @author		Skalpa Keo <skalpa at xoops.org>
+* @since		2.3.0
+* @package		xoops_panel
+* @subpackage	xoops_panel_ConfigurationPanel
+* @version		$Id$
+*/
+
+return array(
+	'xoBundleDisplayName'			=> 'XOOPS configuration panel',
+	'xoBundleIdentifier'			=> 'xoops_panel_ConfigurationPanel',
+	'xoClassPath' => '/panel.php',
+);
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/ConfigurationPanel.xoobj/xo-info.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Sun Feb 19 20:12:11 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:12:11 +0100
Subject: [Xoops4-svn] r257 - in XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm: . Forms
Message-ID: <200602191912.k1JJCBnp006288@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:11:59 +0100 (Sun, 19 Feb 2006)
New Revision: 257

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/element.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/form.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/range.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/select.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/text.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/textarea.php
Log:
Added the 1st draft of the new forms framework (modelled against XForms, but able to render elements as html too)... it's not finished but basically working. Also: data validation is not implemented yet, but the point is that validation will be handled by other classes: form elements are UI elements (view), data validation is about "data" (model)

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/element.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/element.php	2006-02-19 19:08:52 UTC (rev 256)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/element.php	2006-02-19 19:11:59 UTC (rev 257)
@@ -0,0 +1,109 @@
+<?php
+/**
+ * xoops_pyro_FormElement main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+
+
+XOS::import( 'xoops_opal_Widget' );
+
+/**
+ * Base class for form elements
+ * 
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_FormElement extends xoops_opal_Widget {
+	/**
+	 * This element label
+	 * @var string
+	 */
+	var $label = '';
+	/**
+	 * Name of this element when rendered as within an HTML form
+	 * @var string
+	 */
+	var $name = '';
+	/**
+	 * Pointer to the data this element references (if any)
+	 * @var mixed
+	 */
+	var $value = null;
+	/**
+	 * Path to the data this element references
+	 * @var string
+	 */
+	var $refPath = '';
+	/**
+	 * Pointer to the form that owns this element
+	 * @var mixed
+	 */
+	var $form = null;
+	/**
+	 * If this element should be rendered as an HTML form element or as an XForms element
+	 * @var boolean
+	 */
+	var $renderAsHtml = true;
+	
+	function xoInit( $options = array(), $attributes = array() ) {
+		if ( $this->refPath && !$this->name ) {
+			$this->name = $this->refPath;
+		}
+		return parent::xoInit( $options, $attributes );
+	}
+	
+	/**
+	 * Convenience method to attach a data variable to this element
+	 * @param mixed $var Pointer to the variable this element should be referencing
+	 * @param string $path Path to the attached variable
+	 * @param string $name Name to use when rendering this element as HTML (if empty, will be created from $path)
+	 */
+	function attachVar( &$var, $path, $name = '' ) {
+		$this->value =& $var;
+		$this->ref = $path;
+		$this->name = empty($name) ? $path : $name;
+		return $var;
+	}
+	
+	/**
+	 * Render this element label
+	 * @return string
+	 */
+	function renderLabel() {
+		if ( $this->label ) {
+			if ( $this->elementId ) {
+				return "<label for=\"$this->elementId\">$this->label</label>";
+			}
+			return "<label>$this->label</label>";
+		}
+		return '';
+	}
+
+	function renderControl() {
+		return '';
+	}
+
+	function renderStringProperty( $matches ) {
+		if ( $matches[1] == 'label' ) {
+			return $this->renderLabel();
+		} elseif ( $matches[1] == 'control' ) {
+			return $this->renderControl();
+		}
+		return parent::renderStringProperty( $matches );
+	}
+
+	
+	
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/element.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/form.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/form.php	2006-02-19 19:08:52 UTC (rev 256)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/form.php	2006-02-19 19:11:59 UTC (rev 257)
@@ -0,0 +1,90 @@
+<?php
+/**
+ * xoops_pyro_Form component main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+
+XOS::import( 'xoops_opal_Widget' );
+
+/**
+ * Pyro form widget
+ * 
+ * The form widgets have been modelled after the XForms specification.
+ * When rendered as HTML form elements, some of the features (like support for multiple submission locations)
+ * are emulated using javascript, so you should restrict yourself to the features set supported
+ * by HTML forms if you don't want your forms to rely on client scripting.
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_Form extends xoops_opal_Widget {
+	
+	/**
+	 * The different locations where this form can be submitted
+	 * @var array
+	 */
+	var $submissions = array();
+	/**
+	 * Default submission id (used when rendering as HTML)
+	 * @var string
+	 */
+	var $defaultSubmission = '';
+	
+	var $tagName = 'form';
+	var $renderAsHtml = true;
+	
+	function xoInit( $options = array(), $attributes = array() ) {
+	  	$attributes = array_merge( array( 'method' => 'post', 'action' => $_SERVER['REQUEST_URI'] ), $attributes );
+		parent::xoInit( $options, $attributes );
+
+		//$this->xoElements =& $GLOBALS['xoops2']->create( 'xoops.form.group' );
+		//$this->elements =& $this->xoElements->elements;
+		return true;
+	}
+	
+	/**
+	 * Add a submission URI to this form
+	 * 
+	 * As XForms, pyro forms let you specify several submission locations. When a form accepting more than
+	 * one submission location is rendered as HTML, this functionality will be emulated by adding javascript
+	 * event handlers to the submit buttons. Thus, you should not add more than one submission location if 
+	 * you want your form to work with Javascript disabled.
+	 * 
+	 * The submission method should be specified using valid XForms submission methods:
+	 * - get (transformed to get in HTML)
+	 * - urlencoded-post (post + application/x-www-form-urlencoded in HTML)
+	 * - form-post-data (post + multipart/form-data in HTML)
+	 *
+	 * @param string $id ID of this submission
+	 * @param string $action Location to submit this form data to
+	 * @param string $method Method used
+	 */
+	function addSubmission( $id, $action = '', $method = 'get' ) {
+		if ( empty( $this->submissions ) ) {
+			$this->defaultSubmission = $id;
+		}
+		$this->submissions[$id] = array( empty($action) ? $_SERVER['REQUEST_URI'] : $action, $method );
+	}
+	
+	
+	function addElement( &$elt ) {
+		$elt->ownerForm =& $this;
+		$this->elements[] =& $elt;
+	}
+
+	function renderdTag() {
+		
+	}
+	
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/form.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/range.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/range.php	2006-02-19 19:08:52 UTC (rev 256)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/range.php	2006-02-19 19:11:59 UTC (rev 257)
@@ -0,0 +1,80 @@
+<?php
+/**
+ * xoops_pyro_FormRange main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+
+
+XOS::import( 'xoops_pyro_FormElement' );
+
+/**
+ * Form element widget for the XForms 'range' element
+ * 
+ * When rendered as an XForms element, this widget will display a range control and
+ * degrade gracefully to a select element when using HTML.
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_FormRange extends xoops_pyro_FormElement {
+
+	var $tagName = 'range';
+	
+	/**
+	 * Minimal value that can be chosen with this control
+	 * @var integer
+	 */
+	var $start = 0;
+	/**
+	 * Maximal value that can be chosen with this control
+	 * @var integer
+	 */
+	var $end = 100;
+	/**
+	 * Increment between two choices
+	 * @var integer
+	 */
+	var $step = 10;
+	
+	var $attributes = array();
+
+	function renderControl() {
+		$attributes = $this->attributes;
+		if ( $this->renderAsHtml ) {
+			if ( $this->name ) {
+				$attributes['name'] = $this->name;
+			}
+			$attributes['size'] = 1;
+			$str = $this->renderTag( 'select', $attributes );
+			$val = $this->start;
+			if ( !$this->step ) {
+				$this->step = 1;
+			}
+			while ( $val <= $this->end ) {
+				$str.= '<option value="' . $val . '"';
+				if ( isset($this->value) && $this->value == $val ) {
+					$str .= ' selected="selected"';
+				}
+				$str .= ">$val</option>";
+				$val += $this->step;
+			}
+			return $str . '</select>';
+		} else {
+			if ( $this->refPath ) {
+				$attributes['ref'] = $this->refPath;
+			}
+			return $this->renderTag( $this->tagName, $attributes ) . $this->renderLabel() . "</$this->tagName>";
+		}
+	}
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/range.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/select.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/select.php	2006-02-19 19:08:52 UTC (rev 256)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/select.php	2006-02-19 19:11:59 UTC (rev 257)
@@ -0,0 +1,89 @@
+<?php
+/**
+ * xoops_pyro_FormSelect main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+
+
+XOS::import( 'xoops_pyro_FormElement' );
+
+/**
+ * Form widget for the XForms 'select' element
+ * 
+ * When rendered as an XForms element, this widget will display a range control and
+ * degrade gracefully to a select element when using HTML.
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_FormSelect extends xoops_pyro_FormElement {
+
+	var $tagName = 'select';
+	
+	var $appearance = 'minimal';
+	
+
+	function renderControl() {
+		if ( $this->renderAsHtml ) {
+			if ( $this->appearance != 'full' ) {
+				if ( $this->name ) {
+					$attributes['name'] = $this->name;
+				}
+				$attributes['size'] = ( $this->appearance == 'minimal' ) ? 1 : max( 1, count( $this->options ) );
+				$str = $this->renderTag( 'select', $attributes );
+				foreach ( $this->options as $val => $label ) {
+					$str .= '<option value="' . htmlspecialchars( $val, ENT_QUOTES ) . '"';
+					if ( isset( $this->value ) && $this->value == $val ) {
+						$str .= ' selected="selected"';
+					}
+					$str .= '>' . htmlspecialchars( $label ) . '</option>';
+				}
+				return $str . '</select>';
+			} else {
+				$str = '';
+				$optionType = is_a( $this, 'xoops_pyro_FormSelect1' ) ? 'radio' : 'checkbox';
+				$name = $this->name ? ( ' name="' . htmlspecialchars( $this->name, ENT_QUOTES ) . '"' ) : '';
+				foreach ( $this->options as $val => $label ) {
+					$str .= '<div class="xoops_pyro_FormSelect-option">';
+					$str .= "<input type=\"$optionType\"$name value=\"" . htmlspecialchars( $val, ENT_QUOTES ) . '"';
+					if ( isset( $this->value ) && $this->value == $val ) {
+						$str .= ' checked="checked"';
+					}
+					$str .= ' />' . $label . '</div>';
+				}
+				return $str;
+			}
+		}
+		return $this->renderTag() . $this->renderLabel() . "</$this->tagName>";
+	}
+
+}
+
+/**
+ * Form widget for the XForms 'select1' element
+ * 
+ * When rendered as an XForms element, this widget will display a range control and
+ * degrade gracefully to a select element when using HTML.
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_FormSelect1 extends xoops_pyro_FormSelect {
+
+	var $tagName = 'select1';
+	
+	var $appearance = 'minimal';
+
+}
+
+
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/select.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/text.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/text.php	2006-02-19 19:08:52 UTC (rev 256)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/text.php	2006-02-19 19:11:59 UTC (rev 257)
@@ -0,0 +1,64 @@
+<?php
+/**
+ * xoops_pyro_FormText main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+
+
+XOS::import( 'xoops_pyro_FormElement' );
+
+/**
+ * Form widget for the XForms 'input' element
+ * 
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_FormText extends xoops_pyro_FormElement {
+
+	var $tagName = 'input';
+
+	var $attributes = array();
+
+	function renderControl() {
+		$attrs = $this->attributes;
+		if ( $this->renderAsHtml ) {
+			$attrs['type'] = 'text';
+			$attrs['value'] = $this->value;
+			if ( $this->name ) {
+				$attrs['name'] = $this->name;
+			}
+			return $this->renderTag( 'input', $attrs, true );
+		} else {
+			if ( $this->refPath ) {
+				$attrs['ref'] = $this->refPath;
+			}
+			return $this->renderTag( $this->tagName, $attrs ) . $this->renderLabel() . "</$this->tagName>";
+		}
+	}
+
+}
+/**
+ * Form widget for the XForms 'secret' element
+ * 
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_FormSecret extends xoops_pyro_FormText {
+
+	var $attributes = array( 'type' => 'password' );
+
+}
+
+
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/text.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/textarea.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/textarea.php	2006-02-19 19:08:52 UTC (rev 256)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/textarea.php	2006-02-19 19:11:59 UTC (rev 257)
@@ -0,0 +1,46 @@
+<?php
+/**
+ * xoops_pyro_FormText main class file
+ *
+ * See the enclosed file LICENSE for licensing information.
+ * If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+ *
+ * @copyright   The XOOPS project http://www.xoops.org/
+ * @license     http://www.fsf.org/copyleft/gpl.html GNU public license
+ * @since       2.3.0
+ * @version		$Id$
+ * @author		Skalpa Keo <skalpa at xoops.org>
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+
+XOS::import( 'xoops_pyro_FormElement' );
+
+/**
+ * Form widget for the XForms 'textarea' element
+ * 
+ * @package		xoops_pyro
+ * @subpackage 	xoops_pyro_Forms
+ */
+class xoops_pyro_FormTextarea extends xoops_pyro_FormElement {
+
+	var $tagName = 'textarea';
+
+	function renderControl() {
+		$attrs = $this->attributes;
+		if ( $this->renderAsHtml ) {
+			if ( $this->name ) {
+				$attrs['name'] = $this->name;
+			}
+			return $this->renderTag( 'textarea', $attrs ) . htmlspecialchars( $this->value ) . '</textarea>';
+		} else {
+			if ( $this->refPath ) {
+				$attrs['ref'] = $this->refPath;
+			}
+			return $this->renderTag( $this->tagName, $attrs ) . $this->renderLabel() . "</$this->tagName>";
+		}
+	}
+
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Frameworks/XoopsCore/UserExperience/Pyro.xofrm/Forms/textarea.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Sun Feb 19 20:16:53 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:16:53 +0100
Subject: [Xoops4-svn] r258 - in XoopsCore/branches/tasks/123542-admin/XOOPS: . Preferences Preferences/ByHost
Message-ID: <200602191916.k1JJGrVm007660@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:16:38 +0100 (Sun, 19 Feb 2006)
New Revision: 258

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/ByHost/
   XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/ByHost/default.site-xoops_http_HttpHandler.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/xoops_http_HttpHandler.php
Log:
Added the new folder for managed preferences, with a few examples.
(Managed preferences allow admins to lock some settings, ensuring they can't be modified using the configuration module)
NB: this feature is still buggy, but will be fixed in alpha 3

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/ByHost/default.site-xoops_http_HttpHandler.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/ByHost/default.site-xoops_http_HttpHandler.php	2006-02-19 19:11:59 UTC (rev 257)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/ByHost/default.site-xoops_http_HttpHandler.php	2006-02-19 19:16:38 UTC (rev 258)
@@ -0,0 +1,21 @@
+<?php
+/**
+ * Example of host-specific managed preferences file...
+ * 
+ * Enter preference values administratively managed in files like this one,
+ * named after the bundleId of the object you want to configure.
+ * 
+ * Host-specific preferences files must be named like hostname-bundleid.php.
+ * As they are read after managed preferences applying to all hosts, you are not
+ * allowed to specify an host-specific setting if it has already been set in the
+ * 'all hosts' domain (inside the main Preferences folder)
+ */
+
+/*
+return array(
+	'fakeRedirectDelay' => 5,
+);
+*/
+return array();
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/ByHost/default.site-xoops_http_HttpHandler.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/xoops_http_HttpHandler.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/xoops_http_HttpHandler.php	2006-02-19 19:11:59 UTC (rev 257)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/xoops_http_HttpHandler.php	2006-02-19 19:16:38 UTC (rev 258)
@@ -0,0 +1,19 @@
+<?php
+/**
+ * Example of managed preferences file...
+ * 
+ * Enter preference values administratively managed in files like this one,
+ * named after the bundleId of the object you want to configure.
+ * 
+ * Managed preferences are not overridable through user interface tools, thus
+ * you can use this system to protect some important settings from modification.
+ */
+
+/*
+return array(
+	'cacheLimiter' => 'public',
+);
+*/
+return array();
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/Preferences/xoops_http_HttpHandler.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Sun Feb 19 20:19:57 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:19:57 +0100
Subject: [Xoops4-svn] r259 - XoopsCore/branches/tasks/123542-admin/XOOPS/Boot
Message-ID: <200602191919.k1JJJvnS009812@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:19:46 +0100 (Sun, 19 Feb 2006)
New Revision: 259

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/hosts.php
Log:
Fixed the host file to ensure components files can be accessed through the new /library.php front controller

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/hosts.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/hosts.php	2006-02-19 19:16:38 UTC (rev 258)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/hosts.php	2006-02-19 19:19:46 UTC (rev 259)
@@ -38,7 +38,7 @@
 		// URIs without a leading slash are considered relative to the current XOOPS host location
 		// URIs with a leading slash are considered semi-relative (you must setup approp rewriting rules in your server conf)
 		'paths'			=> array(
-			'XOOPS'			=> array( XOOPS_PATH,						'library' ),
+			'XOOPS'			=> array( XOOPS_PATH,						'library.php' ),
 			'modules'		=> array( XOOPS_ROOT_PATH . '/modules',		'modules' ),
 			'themes'		=> array( XOOPS_ROOT_PATH . '/themes',		'themes' ),
 			'var'			=> array( XOOPS_VAR_PATH,					null ),



From skalpa at berlios.de  Sun Feb 19 20:22:24 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:22:24 +0100
Subject: [Xoops4-svn] r260 - XoopsCore/branches/tasks/123542-admin/XOOPS/Boot
Message-ID: <200602191922.k1JJMOLC010750@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:22:22 +0100 (Sun, 19 Feb 2006)
New Revision: 260

Modified:
   XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php
Log:
Made a lame hack to the kernel service loading routine to ensure preferences are retrieved correctly (will be fixed in alpha 3)
Also added str_split() and array_combine() to fix php4 compat

NB: Not sure about str_split(), but array_combine() will stay here

Modified: XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php	2006-02-19 19:19:46 UTC (rev 259)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/Boot/kernel.php	2006-02-19 19:22:22 UTC (rev 260)
@@ -326,6 +326,15 @@
 			} elseif ( empty( $bundleId ) ) {
 				$bundleId = $name;
 			}
+			// Preferences retrieval will be integrated in the instanciation layer during alpha3 dev
+			// so, this ugly hack is just here temporarily to ensure the 2 actual config panels work
+			// correctly, and will be removed soon :-)
+			if ( $name == 'http' || $name == 'session' ) {
+				$prefs =& XOS::create( 'xoops_core_PreferencesHandler' );
+				$values = $prefs->getMultiple( null, $bundleId, XO_PREFS_ANYUSER, XO_PREFS_CURRENTHOST );
+				$options = array_merge( $values, $options );
+			}
+			// -----
 			$this->services[$name] =& XOS::create( $bundleId, $options );
 		}
 		return $this->services[$name];
@@ -509,5 +518,32 @@
 }
 
 
+if ( !function_exists( 'str_split' ) ) {
+	function str_split( $string, $chunkSize = 1 ) {
+		list( $pos, $len, $out ) = array( 0, strlen($string), array() );
+		while ( $pos <= $len ) {
+			$out[] = substr( $string, $pos, $chunkSize );
+			$pos += $chunkSize;
+		}
+		return $out;
+	}
+	function array_combine( $keys, $values ) {
+		$size = count($keys);
+		if ( !$size || $size != count($values) )	return false;
+		$out = array();
+		for ( $i=0; $i!=$size; $i++ ) {
+			$out[ $keys[$i] ] = $values[$i];
+		}
+		return $out;
+	}
+}
 
+
+
+
+
+
+
+
+
 ?>
\ No newline at end of file



From skalpa at berlios.de  Sun Feb 19 20:23:40 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:23:40 +0100
Subject: [Xoops4-svn] r261 - in XoopsCore/branches/tasks/123542-admin/XOOPS: . ConfigPanels ConfigPanels/Http.xopanel ConfigPanels/Http.xopanel/templates ConfigPanels/Http.xopanel/www
Message-ID: <200602191923.k1JJNeNE011277@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:23:37 +0100 (Sun, 19 Feb 2006)
New Revision: 261

Added:
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/http-panel.php
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/templates/
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/templates/http-main-view.xotpl
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/www/
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/www/config-system-http.png
   XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/xo-info.php
Log:
Added the HTTP handler configuration panel

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/http-panel.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/http-panel.php	2006-02-19 19:22:22 UTC (rev 260)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/http-panel.php	2006-02-19 19:23:37 UTC (rev 261)
@@ -0,0 +1,93 @@
+<?php
+/**
+ * HTTP service configuration panel class definition
+ */
+
+XOS::import( 'xoops_panel_ConfigurationPanel' );
+
+/**
+ * HTTP service configuration panel
+ * 
+ * @package xoops_http
+ * @subpackage xoops_http_HttpConfigPanel
+ */
+class xoops_http_HttpConfigPanel extends xoops_panel_ConfigurationPanel {
+	
+	var	$views = array(
+		'default' => 'xoops_http_HttpConfigPanel#templates/http-main-view.xotpl',
+	);
+	var $currentView = 'default';
+
+	
+	var $useHostConfiguration = true;
+
+	var $preferencesBag = array();
+	
+	/**
+	 * Host domain the edited preferences apply to (XO_PREFS_ANYHOST or XO_PREFS_CURRENTHOST)
+	 * @var string
+	 */
+	var $domainHost = '';
+	/**
+	 * User domain the edited preferences apply to (XO_PREFS_ANYUSER or XO_PREFS_CURRENTUSER)
+	 * @var string
+	 */
+	var $domainUser = 0;
+	
+	/**
+	 * The PreferencesHandler to use to store/retrieve settings
+	 * @var xoops_core_PreferencesHandler
+	 */
+	var $preferencesHandler = false;
+
+
+	var $parametersDef = array(
+		'enableCompression' => array( null, XO_TYPE_BOOL ),
+		'compressionLevel' => array( null, XO_TYPE_INT ),
+
+		'enableRedirections' => array( null, XO_TYPE_BOOL ),
+		'fakeRedirectDelay' => array( null, XO_TYPE_INT ),
+		'fakeRedirectTemplate' => array( null, XO_TYPE_MARKUP ),
+		'cacheLimiter' => array( null, XO_TYPE_STRING ),
+		'cacheLifetime' => array( null, XO_TYPE_INT ),
+	);
+	
+
+
+	function xoInit( $options = array() ) {
+		$this->preferencesBag = $this->preferencesHandler->getMultiple( null, 'xoops_http_HttpHandler', $this->domainUser, $this->domainHost );
+		return parent::xoInit( $options );
+	}
+	
+	function performAction() {
+		if ( $_SERVER['REQUEST_METHOD'] == 'POST' ) {
+			foreach ( $this->request as $k => $v ) {
+				if ( isset($v) ) {
+					$this->preferencesHandler->setValue( $k, $v, 'xoops_http_HttpHandler', $this->domainUser, $this->domainHost, false );
+				}
+			}
+			$this->preferencesHandler->synchronize( 'xoops_http_HttpHandler', $this->domainUser, $this->domainHost );
+			$this->currentView = '';
+			$this->responseCode = array( 303, XO_("Preferences successfully updated"), $_SERVER['REQUEST_URI'] );
+		}
+	}
+	
+	
+	function sendResponse() {
+		
+		if ( $this->currentView ) {
+			$form = XOS::create( 'xoops_pyro_Form', array(
+				'instances' => array( 'preferences' => &$this->preferencesBag ),
+				'submissions' => array( 'save-prefs' => array( $_SERVER['REQUEST_URI'], 'urlencoded-post' ) ),
+				'renderAsHtml' => true,
+			) );
+
+			$this->viewVars['form'] = $form;
+			$this->viewVars['prefs'] = $this->preferencesBag;
+		}
+		return parent::sendResponse();
+	}
+	
+}
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/http-panel.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/templates/http-main-view.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/templates/http-main-view.xotpl	2006-02-19 19:22:22 UTC (rev 260)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/templates/http-main-view.xotpl	2006-02-19 19:23:37 UTC (rev 261)
@@ -0,0 +1,133 @@
+<?xml version='1.0' encoding='iso-8859-1'?>
+<XoopsTemplate>
+	<LanguageFiles />
+	<TemplateObjects>
+		<Object bundleId="xoops_pyro_FormSelect1" tplVar="enableCompression">
+			<Property name="ownerForm">$form</Property>
+			<Property name="refPath">enableCompression</Property>
+			<Property name="value">$prefs.enableCompression</Property>
+			<Property name="label" localized="true">Enable compression</Property>
+			<Property name="appearance">full</Property>
+			<Property name="options" type="array">
+				<Item key="0" localized="true">No</Item>
+				<Item key="1" localized="true">Yes</Item>
+			</Property>
+		</Object>
+		<Object bundleId="xoops_pyro_FormRange" tplVar="compressionLevel">
+			<Property name="ownerForm">$form</Property>
+			<Property name="refPath">compressionLevel</Property>
+			<Property name="value">$prefs.compressionLevel</Property>
+			<Property name="label" localized="true">Compression level</Property>
+			<Property name="start">1</Property>
+			<Property name="end">9</Property>
+			<Property name="step">1</Property>
+		</Object>
+		<Object bundleId="xoops_pyro_FormSelect1" tplVar="enableRedirections">
+			<Property name="ownerForm">$form</Property>
+			<Property name="refPath">enableRedirections</Property>
+			<Property name="value">$prefs.enableRedirections</Property>
+			<Property name="label" localized="true">Redirection mode</Property>
+			<Property name="appearance">full</Property>
+			<Property name="options" type="array">
+				<Item key="0" localized="true">Display redirection screen</Item>
+				<Item key="1" localized="true">Use HTTP redirections</Item>
+			</Property>
+		</Object>
+		<Object bundleId="xoops_pyro_FormText" tplVar="fakeRedirectDelay">
+			<Property name="ownerForm">$form</Property>
+			<Property name="refPath">fakeRedirectDelay</Property>
+			<Property name="value">$prefs.fakeRedirectDelay</Property>
+			<Property name="label" localized="true">Screen display duration</Property>
+		</Object>
+		<Object bundleId="xoops_pyro_FormTextarea" tplVar="fakeRedirectTemplate">
+			<Property name="ownerForm">$form</Property>
+			<Property name="refPath">fakeRedirectTemplate</Property>
+			<Property name="value">$prefs.fakeRedirectTemplate</Property>
+			<Property name="label" localized="true">Screen template</Property>
+		</Object>
+		<Object bundleId="xoops_pyro_FormSelect1" tplVar="cacheLimiter">
+			<Property name="ownerForm">$form</Property>
+			<Property name="refPath">cacheLimiter</Property>
+			<Property name="value">$prefs.cacheLimiter</Property>
+			<Property name="label" localized="true">Client caching policy</Property>
+			<Property name="appearance">minimal</Property>
+			<Property name="options" type="array">
+				<Item key="public" localized="true">Allow content caching</Item>
+				<Item key="private" localized="true">Disallow caching by public caches</Item>
+				<Item key="nocache" localized="true">Disallow caching entirely</Item>
+			</Property>
+		</Object>
+		<Object bundleId="xoops_pyro_FormText" tplVar="cacheLifetime">
+			<Property name="ownerForm">$form</Property>
+			<Property name="refPath">cacheLifetime</Property>
+			<Property name="value">$prefs.cacheLifetime</Property>
+			<Property name="label" localized="true">Caching duration</Property>
+		</Object>
+	</TemplateObjects>
+	<TemplateData contentType="text/html" default="true"><![CDATA[
+	([assign var=fieldTplString value='<tr class="pref-setting"><td>{label}:</td><td class="pref-control">{control}</td></tr>'])
+
+	<h2>HTTP handler configuration</h2>
+
+	([$form->renderTag()|smarty:nodefaults])
+	<table>
+		<caption>Output compression</caption>
+		([xoWidget tplVar=$enableCompression templateString=$fieldTplString])
+		([xoWidget tplVar=$compressionLevel templateString=$fieldTplString])
+	</table>
+	<table>
+		<caption>Redirections</caption>
+		([xoWidget tplVar=$enableRedirections templateString=$fieldTplString])
+		([xoWidget tplVar=$fakeRedirectDelay templateString=$fieldTplString])
+		([xoWidget tplVar=$fakeRedirectTemplate templateString=$fieldTplString])
+	</table>
+	<table>
+		<caption>Default headers</caption>
+		([xoWidget tplVar=$cacheLimiter templateString=$fieldTplString])
+		([xoWidget tplVar=$cacheLifetime templateString=$fieldTplString])
+	</table>
+
+	<div class="form-submits">
+		<button type="submit">Apply changes</button>
+	</div>
+	</form>
+
+]]></TemplateData>
+	<TemplateData contentType="application/xhtml+xml"><![CDATA[
+
+	<h2>HTTP handler configuration xhtml</h2>
+
+	([assign var=fieldTplString value='<div class="pref-setting">{label}<div class="pref-control">{control}</div></div>'])
+
+	([$form->renderTag()|smarty:nodefaults])
+
+	<fieldset>
+		<legend>Output compression</legend>
+		([xoWidget tplVar=$enableCompression templateString=$fieldTplString])
+
+		([xoWidget tplVar=$compressionLevel templateString=$fieldTplString])
+	</fieldset>
+
+	<fieldset>
+		<legend>Redirections</legend>
+		([xoWidget tplVar=$enableRedirections templateString=$fieldTplString])
+
+		([xoWidget tplVar=$fakeRedirectDelay templateString=$fieldTplString])
+
+		([xoWidget tplVar=$fakeRedirectTemplate templateString=$fieldTplString])
+	</fieldset>
+
+	<fieldset>
+		<legend>Default headers</legend>
+		([xoWidget tplVar=$cacheLimiter templateString=$fieldTplString])
+
+		([xoWidget tplVar=$cacheLifetime templateString=$fieldTplString])
+	</fieldset>
+	
+	<div class="form-submits">
+		<button type="submit">Apply changes</button>
+	</div>
+	</form>
+
+]]></TemplateData>
+</XoopsTemplate>
\ No newline at end of file

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/www/config-system-http.png
===================================================================
(Binary files differ)


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/www/config-system-http.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/xo-info.php	2006-02-19 19:22:22 UTC (rev 260)
+++ XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/xo-info.php	2006-02-19 19:23:37 UTC (rev 261)
@@ -0,0 +1,29 @@
+<?php
+/**
+* xoops_http_HttpPanel bundle information file
+*
+* See the enclosed file LICENSE for licensing information.
+* If you did not receive this file, get it at http://www.fsf.org/copyleft/gpl.html
+*
+* @copyright	The XOOPS project http://www.xoops.org/
+* @license		http://www.fsf.org/copyleft/gpl.html GNU public license
+* @author		Skalpa Keo <skalpa at xoops.org>
+* @since		2.3.0
+* @package		xoops_http
+* @package		xoops_http_HttpPanel
+* @version		$Id$
+*/
+
+return array(
+	'xoBundleDisplayName' => 'HTTP services configuration panel',
+	'xoBundleIdentifier' => 'xoops_http_HttpConfigPanel',
+	'xoClassPath' => '/http-panel.php',
+
+	'configPanelRoot' => 'system/server',
+	'configPanelNode' => 'http',
+	'configPanelIcon' => 'www/config-system-http.png',
+	'configPanelLabel' => 'HTTP',
+	'configPanelDesc' => 'Configure redirections, HTTP compression and default (anonymous) caching headers',
+);
+
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/XOOPS/ConfigPanels/Http.xopanel/xo-info.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Sun Feb 19 20:25:07 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:25:07 +0100
Subject: [Xoops4-svn] r262 - XoopsCore/branches/tasks/123542-admin/htdocs
Message-ID: <200602191925.k1JJP7vH012018@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:25:02 +0100 (Sun, 19 Feb 2006)
New Revision: 262

Modified:
   XoopsCore/branches/tasks/123542-admin/htdocs/header.php
Log:
Fixed header.php to ensure the theme service is correctly instanciated (needed coz of the class renaming)

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/header.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/header.php	2006-02-19 19:23:37 UTC (rev 261)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/header.php	2006-02-19 19:25:02 UTC (rev 262)
@@ -29,7 +29,7 @@
 }
 
 	global $xoops;
-	$xoops->loadService( 'theme', 'xoops_pyro_Theme', array( 'folderName' => $xoopsConfig['theme_set'] ) );
+	$xoops->loadService( 'theme', 'xoops_opal_Theme', array( 'folderName' => $xoopsConfig['theme_set'] ) );
 	
 	//var_export( $xoops->services['theme'] );
 



From skalpa at berlios.de  Sun Feb 19 20:26:15 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:26:15 +0100
Subject: [Xoops4-svn] r263 - XoopsCore/branches/tasks/123542-admin/htdocs/class
Message-ID: <200602191926.k1JJQF3K012312@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:26:14 +0100 (Sun, 19 Feb 2006)
New Revision: 263

Modified:
   XoopsCore/branches/tasks/123542-admin/htdocs/class/template.php
Log:
Fixed the legacy tpl class to deal with the renaming of the new one

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/class/template.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/class/template.php	2006-02-19 19:25:02 UTC (rev 262)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/class/template.php	2006-02-19 19:26:14 UTC (rev 263)
@@ -15,7 +15,7 @@
 if ( !defined( 'XOOPS_PATH' ) )	die();
 
 
-XOS::import( 'xoops_template_Smarty' );
+XOS::import( 'xoops_opal_Smarty' );
 
 /**
  * Template engine
@@ -26,12 +26,12 @@
  * @copyright	(c) 2000-2003 The Xoops Project - www.xoops.org
  * @deprecated
  */
-class XoopsTpl extends xoops_template_Smarty {
+class XoopsTpl extends xoops_opal_Smarty {
 
 	function XoopsTpl() {
 		global $xoopsConfig, $xoopsUser;
 
-		$this->xoops_template_Smarty();
+		$this->xoops_opal_Smarty();
 		$this->assign( array(
 			'xoops_url' => XOOPS_URL,
 			'xoops_rootpath'	=> XOOPS_ROOT_PATH,



From skalpa at berlios.de  Sun Feb 19 20:31:17 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:31:17 +0100
Subject: [Xoops4-svn] r264 - XoopsCore/branches/tasks/123542-admin/htdocs
Message-ID: <200602191931.k1JJVHan014616@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:31:15 +0100 (Sun, 19 Feb 2006)
New Revision: 264

Added:
   XoopsCore/branches/tasks/123542-admin/htdocs/library.php
Log:
Added a front controller to allow access to XOOPS/something files...

Will be enhanced later (right now it requires PATH_INFO support, and does not exploit browser caches)

Added: XoopsCore/branches/tasks/123542-admin/htdocs/library.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/library.php	2006-02-19 19:26:14 UTC (rev 263)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/library.php	2006-02-19 19:31:15 UTC (rev 264)
@@ -0,0 +1,44 @@
+<?php
+
+	$path = @$_SERVER['PATH_INFO'];
+	if ( strpos( $path, '/www/' ) === false ) {
+		return;
+	}
+	if ( strpos( $path, '.php' ) !== false ) {
+		return;
+	}
+
+	$GLOBALS['xoPreventDevMode'] = true;
+	
+	require_once 'mainfile.php';
+
+	global $xoops;
+	
+	$ext = substr( $path, strrpos( $path, '.' ) + 1 );
+	switch ( $ext ) {
+	case 'css':
+		header( 'Content-type: text/css' );
+		break;
+	case 'js':
+		header( 'Content-type: text/javascript' );
+		break;
+	case 'png':
+		header( 'Content-type: image/png' );
+		break;
+	case 'jpg':
+	case 'jpeg':
+		header( 'Content-type: image/jpeg' );
+		break;
+	case 'gif':
+		header( 'Content-type: image/gif' );
+		break;
+	default:
+		header( 'Content-type: text/html' );
+		break;
+	}
+	echo @file_get_contents( $xoops->path( 'XOOPS' . $path ) );
+
+	if ( $xoops->services['logger'] ) {
+		$xoops->services['logger']->activated = false;
+	}
+?>
\ No newline at end of file


Property changes on: XoopsCore/branches/tasks/123542-admin/htdocs/library.php
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:keywords
   + "Author Date Id Rev URL"



From skalpa at berlios.de  Sun Feb 19 20:41:37 2006
From: skalpa at berlios.de (skalpa at BerliOS)
Date: Sun, 19 Feb 2006 20:41:37 +0100
Subject: [Xoops4-svn] r265 - in XoopsCore/branches/tasks/123542-admin/htdocs/themes/default: . img
Message-ID: <200602191941.k1JJfbC5018730@sheep.berlios.de>

Author: skalpa
Date: 2006-02-19 20:41:32 +0100 (Sun, 19 Feb 2006)
New Revision: 265

Added:
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blockszone.xotpl
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/header.xotpl
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/html-head.xotpl
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/button-hover_bg.png
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/input_bg.png
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/toolbar_bg.png
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/theme-canvas-default.xotpl
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/theme-page-default.xotpl
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xoops.js
Removed:
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/canvas-default.xotpl
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/page-default.xotpl
Modified:
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/block.xotpl
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blocks.css
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/elements.css
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/button_bg.png
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/msie.css
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/style-default.css
   XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xo-info.php
Log:
Several changes to the default theme, to ensure it deals with new features... it now supports html, xhtml, and shows how to make pdf (for fun...)

This branch should theorically be usable again !
(well, I'm sure I crapped old modules support/themes compatibility at some point, and should disable XHTML support by default, so modules sending not well-formed output don't break everything, but that won't be long)

Will take care of this tomorrow, and give some news on the devlog too

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/block.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/block.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/block.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -1,4 +1,4 @@
 <div class="xo-block ([$block.module])-([$block.name])">
 	<div class="xo-blocktitle">([$block.title])</div>
-	<div class="xo-blockcontent">([$block.content])</div>
+	<div class="xo-blockcontent">([$block.content|smarty:nodefaults])</div>
 </div>

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blocks.css
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blocks.css	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blocks.css	2006-02-19 19:41:32 UTC (rev 265)
@@ -1,40 +1,30 @@
 
-/* --------- Rules for canvas blocks --------- */
-.xo-canvas-column ul {
-	margin:				0px;
-	padding:			0px;
-	list-style-type:	none;
+/* --------- Left column blocks --------- */
+#xo-canvas-leftcolumn .xo-block {
+	border:			1px solid #666666;
 }
-
-.xo-canvas-column a {
-	display:			block;
-	padding:			1px .3em;
-	text-decoration:	none;
-	font-size:			90%;
-	color:				#CCCCCC;
-}
-.xo-canvas-column a:hover {
-	color:				#FFFFFF;
-}
-.xo-canvas-column .menuSub a {
-	padding-left:		1em;
-}
-
-
-
 #xo-canvas-leftcolumn .xo-blocktitle {
-	background:		url(img/canvas-blocktitle_bg_grey.png) repeat-x left top;
+	background:		#9D9D9D url(img/canvas-blocktitle_bg_grey.png) repeat-x left top;
 	color:			#ffffff;
 	border-bottom:	1px solid #666666;
 	padding:		.2em .5em;
 	font-weight:	bold;
 	text-shadow:	1px 1px #000000;
 }
-
 #xo-canvas-leftcolumn .xo-blockcontent {
 	background:		#999999 url(img/canvas-blockcontent_bg_grey.png) repeat-x left top;
 }
 
+#xo-canvas-leftcolumn a {
+	color:				#CCCCCC;
+	text-decoration:	none;
+	font-size:			90%;
+}
+#xo-canvas-leftcolumn a:hover {
+	color:				#EEEEEE;
+}
+
+/* --------- Right column blocks --------- */
 #xo-canvas-rightcolumn .xo-block {
 	padding:		8px 0px;
 	background:		url(img/separator.png) no-repeat center bottom;
@@ -42,7 +32,6 @@
 #xo-canvas-rightcolumn :last-child {
 	background:		transparent none;
 }
-
 #xo-canvas-rightcolumn .xo-blocktitle {
 	font-weight:	bold;
 }
@@ -50,19 +39,53 @@
 	font-size:		90%;
 }
 
-#xo-canvas-leftcolumn a:hover {
-	color:				#EEEEEE;
-	background:			#555555;
-}
-
 #xo-canvas-rightcolumn a {
 	color:				#666666;
+	text-decoration:	none;
 }
 #xo-canvas-rightcolumn a:hover {
 	color:				#333333;
 	text-decoration:	underline;
 }
 
+
+
+.xo-canvas-column ul {
+	margin:				0px;
+	padding:			.2em;
+}
+.xo-canvas-column li {
+	list-style:		none;
+	margin:			0px;
+	padding:		0px;
+}
+
+
+
+/*
+
+
+
+
+.xo-canvas-column a {
+	display:			inline-block;
+	width:				100%;
+	margin:				0px;
+	padding:			1px .3em;
+	text-decoration:	none;
+	font-size:			90%;
+	color:				#CCCCCC;
+}
+.xo-canvas-column a:hover {
+}
+.xo-canvas-column .menuSub a {
+	padding-left:		1em;
+}
+
+*/
+
+
+
 /* --------- Rules for page blocks --------- */
 
 #xo-content .xo-block {
@@ -103,7 +126,7 @@
 
 
 #xo-canvas-leftcolumn .system-main_menu .xo-blocktitle {
-	background:		url(img/canvas-blocktitle_bg_blue.png) repeat-x left top;
+	background:		#647FD7 url(img/canvas-blocktitle_bg_blue.png) repeat-x left top;
 }
 
 #xo-canvas-leftcolumn .system-main_menu .xo-blockcontent {

Added: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blockszone.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blockszone.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/blockszone.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -0,0 +1,9 @@
+
+([if $xoBlocks[$zone] ])
+	([if not $zoneTag])([assign var=zoneTag value='div'])([/if])
+	<([$zoneTag]) class="xo-blockszone([if $zoneClass]) ([$zoneClass])([/if])"([if $zoneId]) id="([$zoneId])"([/if])>
+	([foreach from=$xoBlocks[$zone] key=n item=block])
+		([include file="xotpl:block.xotpl"])
+	([/foreach])
+	</([$zoneTag])>
+([/if])

Deleted: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/canvas-default.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/canvas-default.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/canvas-default.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -1,110 +0,0 @@
-<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
-<html
-	xmlns="http://www.w3.org/1999/xhtml"
-	xml:lang="([$xoops_langcode])" lang="([$xoops_langcode])"
->
-<head>
-	<meta http-equiv="content-type" content="text/html; charset=([$xoops_charset])" />
-	<meta http-equiv="content-language" content="([$xoops_langcode])" />
-
-	([include file='xotpl:xoops_pyro_Theme#templates/metas.xotpl'])
-
-	<link rel="SHORTCUT ICON" href="([xoImgUrl favicon.ico])" />
-
-	<link rel="stylesheet" type="text/css" media="screen" href="([xoImgUrl style-default.css])" />
-
-<!--[if lte IE 6]>
-	<link rel="stylesheet" type="text/css" media="screen" href="([xoImgUrl msie.css])" />
-<![endif]-->
-
-	<title>([$xoops_sitename]) - ([$xoops_pagetitle])</title>
-
-	([$xoops_module_header])
-
-	
-<script type="text/javascript">//<![CDATA[
-	function xoHideRedirectMessage() {
-		var msg = document.getElementById( "xo-redirect-message" );
-		var dec = .05;
-		if (!msg) return;
-		if ( msg.style.opacity === '' ) {
-			if (document.defaultView) {
-				msg.style.opacity = document.defaultView.getComputedStyle(msg, "").getPropertyValue("opacity") - dec;
-			} else msg.style.opacity = 1-dec;
-		} else msg.style.opacity -= dec;
-		if ( msg.style.opacity ) {
-			window.setTimeout( "xoHideRedirectMessage()", 75 );
-		}
-	}
-//]]>
-</script>
-	
-</head>
-<body class="([$xoops->currentModule->xoBundleIdentifier])">
-
-([if $xoBlocks.canvas_left and $xoBlocks.canvas_right])
-	([assign var=canvas_class value="xo-with_both"])
-([elseif $xoBlocks.canvas_left])
-	([assign var=canvas_class value="xo-with_left"])
-([elseif $xoBlocks.canvas_right])
-	([assign var=canvas_class value="xo-with_right"])
-([/if])
-
-<div id="xo-canvas"([if $canvas_class]) class="([$canvas_class])"([/if])>
-	<div id="xo-canvas-header">
-		<div id="xo-banner">
-			<div id="xo-banner-logo">
-				<a href="([xoAppUrl /www/])"><img src="([xoImgUrl img/xoops-logo.png])" alt="XOOPS" /></a>
-			</div>
-			([if $xoops_banner != '&nbsp;'])
-			<div id="xo-banner-ad">([$xoops_banner])</div>
-			([/if])
-		</div>
-		<div id="xo-header-userinfo">
-		([if not $xoops->currentUser->userId])
-			<a href="([xoAppUrl mod_xoops_Identification#login])">Log in</a>
-			<a href="([xoAppUrl /www/register.php])">Register</a>
-		([else])
-			<div class="user-name">
-				([if $xoops->currentUser->fullName])([$xoops->currentUser->fullName])([else])([$xoops->currentUser->login])([/if])
-			</div>
-			<a href="([xoAppUrl mod_xoops_Identification#logout])">Log out</a>
-		([/if])
-		</div>
-	</div>
-([if $xoops->services.http->redirectMessage])
-	<div id="xo-redirect-message">
-		([$xoops->services.http->redirectMessage])
-	</div>
-	<script type="text/javascript">if (xoHideRedirectMessage) window.setTimeout( 'xoHideRedirectMessage()', 4200 );</script>
-([/if])
-	<div id="xo-canvas-main">
-		([if !empty($xoBlocks.canvas_left)])
-		<div class="xo-canvas-column xo-blockszone" id="xo-canvas-leftcolumn">
-		([foreach from=$xoBlocks.canvas_left key=n item=block])
-			([include file="xotpl:block.xotpl"])
-		([/foreach])
-		</div>
-		([/if])
-	
-		([if !empty($xoBlocks.canvas_right)])
-		<div class="xo-canvas-column xo-blockszone" id="xo-canvas-rightcolumn">
-		([foreach from=$xoBlocks.canvas_right key=n item=block])
-			([include file="xotpl:block.xotpl"])
-		([/foreach])
-		</div>
-		([/if])
-		([$xoTheme->renderZone('page')])
-		<br clear="all" />
-	</div>
-	<div id="xo-canvas-footer">
-		<a href="http://www.xoops.org/" target="_blank">
-			Powered by ([$xoops->xoShortVersionString])
-		</a>
-	</div>
-</div>
-  
-<!--{xo-logger-output}-->
-
-</body>
-</html>

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/elements.css
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/elements.css	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/elements.css	2006-02-19 19:41:32 UTC (rev 265)
@@ -11,6 +11,9 @@
 a:hover {
 	text-decoration:	underline;
 }
+form {
+	margin:				0px;
+}
 
 
 /* Web resources lists */

Added: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/header.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/header.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/header.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -0,0 +1,21 @@
+	<div id="xo-canvas-header">
+		<div id="xo-banner">
+			<div id="xo-banner-logo">
+				<a href="([xoAppUrl /www/])"><img src="([xoImgUrl img/xoops-logo.png])" alt="XOOPS" /></a>
+			</div>
+			([if $xoops_banner != '&nbsp;'])
+			<div id="xo-banner-ad">([$xoops_banner])</div>
+			([/if])
+		</div>
+		<div id="xo-header-userinfo">
+		([if not $xoops->currentUser->userId])
+			<a href="([xoAppUrl mod_xoops_Identification#login])">Log in</a>
+			<a href="([xoAppUrl /www/register.php])">Register</a>
+		([else])
+			<div class="user-name">
+				([if $xoops->currentUser->fullName])([$xoops->currentUser->fullName])([else])([$xoops->currentUser->login])([/if])
+			</div>
+			<a href="([xoAppUrl mod_xoops_Identification#logout])">Log out</a>
+		([/if])
+		</div>
+	</div>

Added: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/html-head.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/html-head.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/html-head.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -0,0 +1,17 @@
+
+	<link rel="stylesheet" type="text/css" media="screen" href="([xoImgUrl style-default.css])" />
+<!--[if lte IE 6]>
+	<link rel="stylesheet" type="text/css" media="screen" href="([xoImgUrl msie.css])" />
+<![endif]-->
+	([include file='xotpl:xoops_opal_Theme#templates/metas.xotpl'])
+
+	<link rel="SHORTCUT ICON" href="([xoImgUrl favicon.ico])" />
+
+	<script type="text/javascript" src="([xoImgUrl xoops.js])"></script>
+	<script type="text/javascript">
+		xoops.url = "([xoAppUrl /www])";
+	</script>
+
+	<title>([$xoops_sitename]) - ([$xoops_pagetitle])</title>
+
+	([$xoops_module_header])

Added: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/button-hover_bg.png
===================================================================
(Binary files differ)


Property changes on: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/button-hover_bg.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/button_bg.png
===================================================================
(Binary files differ)

Added: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/input_bg.png
===================================================================
(Binary files differ)


Property changes on: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/input_bg.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/toolbar_bg.png
===================================================================
(Binary files differ)


Property changes on: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/img/toolbar_bg.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/msie.css
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/msie.css	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/msie.css	2006-02-19 19:41:32 UTC (rev 265)
@@ -1,5 +1,4 @@
 
-
 #xo-header-userinfo {
 	right:			25px;
 }
@@ -8,17 +7,6 @@
 	padding:		0px;
 }
 
-
-#xo-page {
-	/* Fix to allow 100% large elements inside the content zone (this browser is so lame... it's unbelievable) */
-	height:			1%;
-}
-
-#xo-canvas-left {
-	display:	inline;
-}
-
-
 .mod_xoops_Identification #xo-page.login {
 	text-align:		center;
 }

Deleted: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/page-default.xotpl
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/page-default.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/page-default.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -1,28 +0,0 @@
-
-	<div id="xo-page"([if $xoops->currentModule->currentLocation]) class="([$xoops->currentModule->currentLocation])"([/if])>
-		([if !empty($xoops_ccblocks)])
-		<div class="xo-blockszone" id="xo-page-topblocks">
-		([foreach item=block from=$xoops_ccblocks])
-			([include file="xotpl:block.xotpl"])
-		([/foreach])
-		</div>
-		([/if])
-		([if !empty($xoops_clblocks)])
-		<div class="xo-blockszone" id="xo-page-topleftblocks">
-		([foreach item=block from=$xoops_clblocks])
-			([include file="xotpl:block.xotpl"])
-		([/foreach])
-		</div>
-		([/if])
-		([if !empty($xoops_crblocks)])
-		<div class="xo-blockszone" id="xo-page-toprightblocks">
-		([foreach item=block from=$xoops_crblocks])
-			([include file="xotpl:block.xotpl"])
-		([/foreach])
-		</div>
-		([/if])
-		
-		<div id="xo-content">
-			([$xoTheme->renderZone('content')])
-		</div>
-	</div>

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/style-default.css
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/style-default.css	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/style-default.css	2006-02-19 19:41:32 UTC (rev 265)
@@ -11,13 +11,12 @@
 	font:					10pt sans-serif;
 }
 
-
 #xo-canvas {
-	margin:			15px;
+	margin:			.4em;
 	background:		#EEEEEE;
 }
 
-/* ------------------- Canvas banner ------------------- */
+/* ------------------- Canvas header ------------------- */
 #xo-canvas-header {
 	position:		relative;
 	border-bottom:	1px solid #CCCCCC;
@@ -27,7 +26,7 @@
 
 #xo-banner {
 	position:		relative;
-	height:			60px;
+	height:			4.5em;
 	border:			1px solid #000000;
 	padding:		2px;
 	background:		#2A75C5 url(img/canvas-banner_bg.png) repeat-x left top;
@@ -82,44 +81,38 @@
 /* ------------------- Main canvas zone (columns and page) ------------------- */
 #xo-canvas-main {
 	border-top:		1px solid #FFFFFF;
-	padding:		6px;
+	margin:			0px;
 }
-
+#xo-canvas-content {
+	display:		table;
+	width:			100%;
+	border-spacing:	6px;
+}
 .xo-canvas-column {
-	width:			160px;
+	width:			11em;
 }
+.xo-canvas-column, #xo-page {
+	display:		table-cell;
+	vertical-align:	top;
+}
 
-#xo-canvas-leftcolumn {
-	float:			left;
-	border:			1px solid #666666;
-}
 #xo-canvas-column .xo-block {
 	display:		block;
 }
-#xo-canvas-rightcolumn {
-	float:			right;
-}
+
 #xo-page {
+	min-height:		300px;
+	border:			1px solid #999999;
 	background:		#ffffff;
-	padding:		0px;
-	border:			1px solid #CCCCCC;
-	min-height:		300px;
 }
 
-#xo-canvas.xo-with_left #xo-page, #xo-canvas.xo-with_both #xo-page {
-	margin-left:	170px;
-}
-#xo-canvas.xo-with_right #xo-page, #xo-canvas.xo-with_both #xo-page {
-	margin-right:	170px;
-}
-
 #xo-content {
 	position:		relative;
 }
 
 
 #xo-canvas-footer {
-	padding:		1px;
+	padding:		.1em;
 	background:		#DDDDDD;
 	text-align:		center;
 	font-size:		90%;
@@ -129,3 +122,20 @@
 	color:				#666666;
 	text-decoration:	none;
 }
+
+
+input[type=text], input[type=password] {
+	border:			1px solid #B3B9C3;
+	background:		#ffffff url(img/input_bg.png) no-repeat left top;
+	color:			#000000;
+	padding:		1px 2px;
+}
+
+button {
+	background:		#D3D2D6 url(img/button_bg.png) repeat-x left bottom;
+}
+
+button:hover {
+	background:		#E6EBFF url(img/button-hover_bg.png) repeat-x left bottom;
+}
+

Copied: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/theme-canvas-default.xotpl (from rev 264, XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/canvas-default.xotpl)
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/canvas-default.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/theme-canvas-default.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -0,0 +1,118 @@
+<?xml version='1.0' encoding='utf-8'?>
+<XoopsTemplate>
+	<TemplateData contentType="text/html" default="true"><![CDATA[
+<!DOCTYPE ([$xoTheme->doctype|smarty:nodefaults])>
+<html
+	([$xoTheme->namespacesString()|smarty:nodefaults])
+	xml:lang="en" lang="en"
+>
+<head>
+	([includeq file='xotpl:html-head.xotpl'])
+</head>
+<body>
+<div id="xo-canvas" class="([$xoops->currentModule->xoBundleIdentifier])">
+	([include file='xotpl:header.xotpl'])
+	([if $xoops->services.http->redirectMessage])
+	<div id="xo-redirect-message">
+		([$xoops->services.http->redirectMessage])
+	</div>
+	<script type="text/javascript">if (xoHideRedirectMessage) window.setTimeout( 'xoHideRedirectMessage()', 4200 );</script>
+	([/if])
+	<div id="xo-canvas-main">
+		<div id="xo-canvas-globalnav" style="display:none">Global navigation bar</div>
+		<table id="xo-canvas-content" cellspacing="6">
+		<tr>
+			([include file='xotpl:blockszone.xotpl' zone='canvas_left'
+				zoneClass='xo-canvas-column' zoneId='xo-canvas-leftcolumn' zoneTag='td'
+			])
+			<td id="xo-page"([if $xoops->currentModule->currentLocation]) class="([$xoops->currentModule->currentLocation])"([/if])>
+			([$xoTheme->renderZone('page')])
+			</td>
+			([include file='xotpl:blockszone.xotpl' zone='canvas_right'
+				zoneClass='xo-canvas-column' zoneId='xo-canvas-rightcolumn' zoneTag='td'
+			])
+		</tr>
+		</table>
+	</div>
+	<div id="xo-canvas-footer">
+		<a href="http://www.xoops.org/" target="_blank">
+			Powered by ([$xoops->xoShortVersionString])
+		</a>
+	</div>
+</div>
+<!--{xo-logger-output}-->
+</body>
+</html>]]>
+	</TemplateData>
+	<TemplateData contentType="application/xhtml+xml">
+	<![CDATA[<?xml version='1.0'?>
+<!DOCTYPE ([$xoTheme->doctype|smarty:nodefaults])>
+<html
+	([$xoTheme->namespacesString()|smarty:nodefaults])
+	xml:lang="en" lang="en"
+>
+<head>
+	([includeq file='xotpl:html-head.xotpl'])
+</head>
+<body>
+<div id="xo-canvas" class="([$xoops->currentModule->xoBundleIdentifier])">
+	([include file='xotpl:header.xotpl'])
+	([if $xoops->services.http->redirectMessage])
+	<div id="xo-redirect-message">
+		([$xoops->services.http->redirectMessage])
+	</div>
+	<script type="text/javascript">if (xoHideRedirectMessage) window.setTimeout( 'xoHideRedirectMessage()', 4200 );</script>
+	([/if])
+	<div id="xo-canvas-main">
+		<div id="xo-canvas-globalnav" style="display:none">Global navigation bar</div>
+		<div id="xo-canvas-content">
+			([include file='xotpl:blockszone.xotpl' zone='canvas_left'
+				zoneClass='xo-canvas-column' zoneId='xo-canvas-leftcolumn'
+			])
+			<div id="xo-page"([if $xoops->currentModule->currentLocation]) class="([$xoops->currentModule->currentLocation])"([/if])>
+			([$xoTheme->renderZone('page')])
+			</div>
+			([include file='xotpl:blockszone.xotpl' zone='canvas_right'
+				zoneClass='xo-canvas-column' zoneId='xo-canvas-rightcolumn'
+			])
+		</div>
+	</div>
+	<div id="xo-canvas-footer">
+		<a href="http://www.xoops.org/" target="_blank">
+			Powered by ([$xoops->xoShortVersionString])
+		</a>
+	</div>
+</div>
+<!--{xo-logger-output}-->
+</body>
+</html>]]>
+	</TemplateData>
+	<TemplateData contentType="application/pdf">
+	<![CDATA[
+<pdml>
+<head>
+	<title>Document title goes here</title>
+	<subject>Document subject goes here</subject>
+	<keywords>example,php,document,and,stuff</keywords>
+</head>
+<body>
+<header>
+	<font size=10pt>
+		<div top=0.2cm left=0cm>Insert site name here</div>
+		<i><div top=0.2cm left=50%><a href="http://([$xoops->hostLocation])/">http://([$xoops->hostLocation])/</a></div></i>
+	</font>
+</header>
+.
+<font size=1cm>
+	<multicell top=40% align=center>
+		This is the front page sent before each document
+	</multicell>
+</font>
+<page>
+	This is the content now (well, this will be where the content goes)...
+
+</body>
+</pdml>
+]]>	
+	</TemplateData>
+</XoopsTemplate>
\ No newline at end of file

Copied: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/theme-page-default.xotpl (from rev 264, XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/page-default.xotpl)
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/page-default.xotpl	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/theme-page-default.xotpl	2006-02-19 19:41:32 UTC (rev 265)
@@ -0,0 +1,26 @@
+
+		([if !empty($xoops_ccblocks)])
+		<div class="xo-blockszone" id="xo-page-topblocks">
+		([foreach item=block from=$xoops_ccblocks])
+			([include file="xotpl:block.xotpl"])
+		([/foreach])
+		</div>
+		([/if])
+		([if !empty($xoops_clblocks)])
+		<div class="xo-blockszone" id="xo-page-topleftblocks">
+		([foreach item=block from=$xoops_clblocks])
+			([include file="xotpl:block.xotpl"])
+		([/foreach])
+		</div>
+		([/if])
+		([if !empty($xoops_crblocks)])
+		<div class="xo-blockszone" id="xo-page-toprightblocks">
+		([foreach item=block from=$xoops_crblocks])
+			([include file="xotpl:block.xotpl"])
+		([/foreach])
+		</div>
+		([/if])
+		
+		<div id="xo-content">
+			([$xoTheme->renderZone('content')])
+		</div>

Modified: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xo-info.php
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xo-info.php	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xo-info.php	2006-02-19 19:41:32 UTC (rev 265)
@@ -4,12 +4,17 @@
 
 
 return array(
-	'xoBundleIdentifier'	=> 'theme_default__web',
+	'xoBundleIdentifier'	=> 'theme_default',
 	'xoBundleDisplayName'	=> 'XOOPS default theme (standards compliant)',
 	// This theme default templates
 	// templates paths must start with a "." to be considered relative to the theme folder
-	'canvasTemplate' => './canvas-default.xotpl',
-	'pageTemplate' => './page-default.xotpl',
+	'canvasTemplate' => './theme-canvas-default.xotpl',
+	'pageTemplate' => './theme-page-default.xotpl',
+	// Properties that indicate the type of content this theme generates
+	'supportedMimeTypes' => "application/xhtml+xml,text/html,application/pdf",
+	
+	'namespaces' => 'http://www.w3.org/1999/xhtml',
+	'doctype' => 'html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"',
 );
 
 

Added: XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xoops.js
===================================================================
--- XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xoops.js	2006-02-19 19:31:15 UTC (rev 264)
+++ XoopsCore/branches/tasks/123542-admin/htdocs/themes/default/xoops.js	2006-02-19 19:41:32 UTC (rev 265)
@@ -0,0 +1,40 @@
+
+function XoopsUtility() {
+	this.url = '';
+	
+	
+	this.addElementClass = function (  elt, cls ) {
+		var current = " " + elt.className + " ";
+		if ( current.indexOf( " " + cls + " " ) == -1 ) {
+			elt.className += elt.className ? ( " " + cls ) : cls;
+		}
+	}
+	this.removeElementClass = function ( elt, cls ) {
+		var current = " " + elt.className + " ";
+		var nClass = current.replace( new RegExp( " " + cls + " " ), " " );
+		elt.className = nClass.substr( 1, nClass.length - 2 );
+	}
+	this.replaceElementClass = function( elt, cls1, cls2 ) {
+		var current = " " + elt.className + " ";
+		var nClass = current.replace( new RegExp( " " + cls1 + " " ), " " + cls2 + " " );
+		elt.className = nClass.substr( 1, nClass.length - 2 );
+	}
+
+}
+
+var xoops = new XoopsUtility();
+
+
+	function xoHideRedirectMessage() {
+		var msg = document.getElementById( "xo-redirect-message" );
+		var dec = .05;
+		if (!msg) return;
+		if ( msg.style.opacity === '' ) {
+			if (document.defaultView) {
+				msg.style.opacity = document.defaultView.getComputedStyle(msg, "").getPropertyValue("opacity") - dec;
+			} else msg.style.opacity = 1-dec;
+		} else msg.style.opacity -= dec;
+		if ( msg.style.opacity ) {
+			window.setTimeout( "xoHideRedirectMessage()", 75 );
+		}
+	}



